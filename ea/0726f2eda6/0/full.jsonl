{"type":"file-history-snapshot","messageId":"4bd22c35-2aa7-4e76-8c8d-6ecb80f63b59","snapshot":{"messageId":"4bd22c35-2aa7-4e76-8c8d-6ecb80f63b59","trackedFileBackups":{},"timestamp":"2026-02-17T21:53:57.211Z"},"isSnapshotUpdate":false}
{"parentUuid":null,"isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","type":"progress","data":{"type":"hook_progress","hookEvent":"SessionStart","hookName":"SessionStart:startup","command":"entire hooks claude-code session-start"},"parentToolUseID":"7b8fe43c-dfe0-4f83-a2d7-e8930dde2d40","toolUseID":"7b8fe43c-dfe0-4f83-a2d7-e8930dde2d40","timestamp":"2026-02-17T21:25:12.278Z","uuid":"f13c079a-9600-4bdd-8481-67118d1eb595"}
{"parentUuid":"f13c079a-9600-4bdd-8481-67118d1eb595","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","type":"user","message":{"role":"user","content":"Please create Expo framework expert similar to @.claude/agents/react/react-expert.md and @.claude/agents/react-native/react-native-expert.md but focused on Expo-specific things such as multiplatform problems, built-in components and packages, build tools etc. Extract all Expo-specific bits from the React Native expert and delegate to the new Expo expert for relevant tasks. Search the web for relevant materials. You can find a list of many expo-related skills and instructions here: https://skills.sh/?q=expo"},"uuid":"4bd22c35-2aa7-4e76-8c8d-6ecb80f63b59","timestamp":"2026-02-17T21:53:52.676Z","thinkingMetadata":{"maxThinkingTokens":31999},"todos":[],"permissionMode":"default"}
{"parentUuid":"4bd22c35-2aa7-4e76-8c8d-6ecb80f63b59","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","message":{"model":"claude-opus-4-6","id":"msg_01Dd5hqRCprjHW3i89HDbF97","type":"message","role":"assistant","content":[{"type":"text","text":"\n\n"}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":3,"cache_creation_input_tokens":42240,"cache_read_input_tokens":0,"cache_creation":{"ephemeral_5m_input_tokens":42240,"ephemeral_1h_input_tokens":0},"output_tokens":14,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CYEPGdULBLFVS7YvovGfr","type":"assistant","uuid":"f50a0c61-f326-4271-b7ba-1c4ed973eb19","timestamp":"2026-02-17T21:53:59.775Z"}
{"parentUuid":"f50a0c61-f326-4271-b7ba-1c4ed973eb19","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","message":{"model":"claude-opus-4-6","id":"msg_01Dd5hqRCprjHW3i89HDbF97","type":"message","role":"assistant","content":[{"type":"thinking","thinking":"The user wants me to:\n1. Create an Expo framework expert agent file similar to the existing React and React Native expert agents\n2. Extract Expo-specific bits from the React Native expert\n3. Search the web for relevant materials, including the skills.sh link\n4. Update the React Native expert to delegate to the new Expo expert for Expo-specific tasks\n\nLet me start by researching Expo-specific topics and then create the agent file.","signature":"EtcECkYICxgCKkBlVK4GHc/7nfDFIJ5xuasYbffbBWOEs6KDDHQF9zjoquQvZafZSXoTeYUVAAOJ5LEo9oAenRBeEUZQ3YQ46BaQEgymfSvBcqO39WY5umQaDKDE1jkcineLurI/UiIwC4F6zZzlMOcaMMXUM6ViNqlskh5gg2fNP3UrxE8eilFggj0rM4KV4x75ngwhhWCZKr4DD/eEh9cBWwmXih90HKpdtNtStcDbEt4ejLOeDpOB3bUJamwJlnZeh5zewG3FErmWbk4bfqemMva2xQHFnYGyiLiMMVysThmDeGUrhrGv4XyNszC7WMMggKTDtAcCBE/UXpVU9QU5THedZw6Dd41Pn+HVYKSLAkIezhGWq2sl3WBI3jmG0HmiUfe9Fa4/NsGo7eJQd8bMjtEqLuPhL0esuEi/D+c1uo+1GQTethekOxVyPEHJBOWQ78wrfBnQTPb7Yyyzel20wS0rKLv68M4bmdsgNjL9YY5GCTZ6/GT8iVaxxXqPZoCBoO0Rf3oHP1QiifvHCHQosGA61ed20Ml2HC7/axd9MT+QwjP9GpvFjpqi/bwyEv6mRgGRYmRciX7YqeZU179Wm44iEF7kLpfk44N7lBMR7Zns4JBHZbZzJXCT0Sw5VICblKQvzIchT4WL5x03YjTgdALgYyxb8NeQhi3NclDi6IkkiyhQQnG3w4n8ggPg4/R0hdHIi4R5fqCvPNqJ7Ac3qbd/QfbmYqwPDu7XYRPhrVLZfMZ+E+WvGsNREDVOd3dQFZqwSBV8+J+ZKt/lfkhO1cemDXtSNrgYAQ=="}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":3,"cache_creation_input_tokens":42240,"cache_read_input_tokens":0,"cache_creation":{"ephemeral_5m_input_tokens":42240,"ephemeral_1h_input_tokens":0},"output_tokens":14,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CYEPGdULBLFVS7YvovGfr","type":"assistant","uuid":"31bd2f78-9ff7-4075-89f5-5d013d9b9f94","timestamp":"2026-02-17T21:54:01.536Z"}
{"parentUuid":"31bd2f78-9ff7-4075-89f5-5d013d9b9f94","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","message":{"model":"claude-opus-4-6","id":"msg_01Dd5hqRCprjHW3i89HDbF97","type":"message","role":"assistant","content":[{"type":"text","text":"I'll research Expo-specific materials and examine the existing agents to create a comprehensive Expo expert. Let me start by gathering information in parallel."}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":3,"cache_creation_input_tokens":42240,"cache_read_input_tokens":0,"cache_creation":{"ephemeral_5m_input_tokens":42240,"ephemeral_1h_input_tokens":0},"output_tokens":14,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CYEPGdULBLFVS7YvovGfr","type":"assistant","uuid":"1c2c25bf-6a5c-40d3-8578-d5ce3b60031f","timestamp":"2026-02-17T21:54:02.406Z"}
{"parentUuid":"1c2c25bf-6a5c-40d3-8578-d5ce3b60031f","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","message":{"model":"claude-opus-4-6","id":"msg_01Dd5hqRCprjHW3i89HDbF97","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01LESq6bLW2Bkf9rkdrCvB43","name":"WebFetch","input":{"url":"https://skills.sh/?q=expo","prompt":"Extract all Expo-related skills, instructions, and expert knowledge. List every topic, tool, API, pattern, and best practice mentioned. Focus on: Expo SDK, EAS Build, EAS Update, expo-router, config plugins, prebuild, Expo modules API, dev client, and any other Expo-specific topics."},"caller":{"type":"direct"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":3,"cache_creation_input_tokens":42240,"cache_read_input_tokens":0,"cache_creation":{"ephemeral_5m_input_tokens":42240,"ephemeral_1h_input_tokens":0},"output_tokens":14,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CYEPGdULBLFVS7YvovGfr","type":"assistant","uuid":"780a739a-a78e-432d-9ec9-af468404366b","timestamp":"2026-02-17T21:54:04.806Z"}
{"parentUuid":"780a739a-a78e-432d-9ec9-af468404366b","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","message":{"model":"claude-opus-4-6","id":"msg_01Dd5hqRCprjHW3i89HDbF97","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_014Fgvut9FF6c9Bq1zVv7BhG","name":"WebSearch","input":{"query":"Expo SDK 52 53 2025 2026 new features best practices"},"caller":{"type":"direct"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":3,"cache_creation_input_tokens":42240,"cache_read_input_tokens":0,"cache_creation":{"ephemeral_5m_input_tokens":42240,"ephemeral_1h_input_tokens":0},"output_tokens":14,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CYEPGdULBLFVS7YvovGfr","type":"assistant","uuid":"9a66be8b-5258-4c5d-8417-d07182663114","timestamp":"2026-02-17T21:54:05.675Z"}
{"parentUuid":"9a66be8b-5258-4c5d-8417-d07182663114","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","message":{"model":"claude-opus-4-6","id":"msg_01Dd5hqRCprjHW3i89HDbF97","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01J26HY5VyFd4mz7uKmJfwAA","name":"WebSearch","input":{"query":"Expo framework expert guide config plugins EAS build update prebuild expo-router best practices"},"caller":{"type":"direct"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":3,"cache_creation_input_tokens":42240,"cache_read_input_tokens":0,"cache_creation":{"ephemeral_5m_input_tokens":42240,"ephemeral_1h_input_tokens":0},"output_tokens":14,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CYEPGdULBLFVS7YvovGfr","type":"assistant","uuid":"8cadafc7-a314-482e-b078-6788693cc50a","timestamp":"2026-02-17T21:54:06.252Z"}
{"parentUuid":"8cadafc7-a314-482e-b078-6788693cc50a","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","message":{"model":"claude-opus-4-6","id":"msg_01Dd5hqRCprjHW3i89HDbF97","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01P5tAG64B2ezywv2AA4WiXx","name":"Glob","input":{"pattern":".claude/agents/**/*.md"},"caller":{"type":"direct"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":3,"cache_creation_input_tokens":42240,"cache_read_input_tokens":0,"output_tokens":437,"server_tool_use":{"web_search_requests":0,"web_fetch_requests":0},"service_tier":"standard","cache_creation":{"ephemeral_1h_input_tokens":0,"ephemeral_5m_input_tokens":42240},"inference_geo":"","iterations":[],"speed":"standard"}},"requestId":"req_011CYEPGdULBLFVS7YvovGfr","type":"assistant","uuid":"15ff60c9-8a55-4964-a838-0e7353dce833","timestamp":"2026-02-17T21:54:06.822Z"}
{"parentUuid":"15ff60c9-8a55-4964-a838-0e7353dce833","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Glob","command":"callback"},"parentToolUseID":"toolu_01P5tAG64B2ezywv2AA4WiXx","toolUseID":"toolu_01P5tAG64B2ezywv2AA4WiXx","timestamp":"2026-02-17T21:54:07.563Z","uuid":"4361b979-c43e-407d-a431-b694e8290273"}
{"parentUuid":"15ff60c9-8a55-4964-a838-0e7353dce833","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01P5tAG64B2ezywv2AA4WiXx","type":"tool_result","content":"/Users/eryk.napierala/Development/fasola/.claude/agents/build-tools/build-tools-vite-expert.md\n/Users/eryk.napierala/Development/fasola/.claude/agents/code-quality/code-quality-linting-expert.md\n/Users/eryk.napierala/Development/fasola/.claude/agents/code-review-expert.md\n/Users/eryk.napierala/Development/fasola/.claude/agents/code-search.md\n/Users/eryk.napierala/Development/fasola/.claude/agents/database/database-expert.md\n/Users/eryk.napierala/Development/fasola/.claude/agents/database/database-postgres-expert.md\n/Users/eryk.napierala/Development/fasola/.claude/agents/documentation/documentation-expert.md\n/Users/eryk.napierala/Development/fasola/.claude/agents/frontend/frontend-accessibility-expert.md\n/Users/eryk.napierala/Development/fasola/.claude/agents/git/git-expert.md\n/Users/eryk.napierala/Development/fasola/.claude/agents/ios-simulator.md\n/Users/eryk.napierala/Development/fasola/.claude/agents/oracle.md\n/Users/eryk.napierala/Development/fasola/.claude/agents/react/react-expert.md\n/Users/eryk.napierala/Development/fasola/.claude/agents/react/react-performance-expert.md\n/Users/eryk.napierala/Development/fasola/.claude/agents/refactoring/refactoring-expert.md\n/Users/eryk.napierala/Development/fasola/.claude/agents/research-expert.md\n/Users/eryk.napierala/Development/fasola/.claude/agents/testing/testing-expert.md\n/Users/eryk.napierala/Development/fasola/.claude/agents/testing/vitest-testing-expert.md\n/Users/eryk.napierala/Development/fasola/.claude/agents/triage-expert.md\n/Users/eryk.napierala/Development/fasola/.claude/agents/typescript/typescript-build-expert.md\n/Users/eryk.napierala/Development/fasola/.claude/agents/typescript/typescript-expert.md\n/Users/eryk.napierala/Development/fasola/.claude/agents/typescript/typescript-type-expert.md\n/Users/eryk.napierala/Development/fasola/.claude/agents/react-native/react-native-expert.md\n/Users/eryk.napierala/Development/fasola/.claude/agents/expo/expo-expert.md"}]},"uuid":"9118a4ad-0012-4001-8be4-f3e74cdee726","timestamp":"2026-02-17T21:54:07.562Z","toolUseResult":{"filenames":["/Users/eryk.napierala/Development/fasola/.claude/agents/build-tools/build-tools-vite-expert.md","/Users/eryk.napierala/Development/fasola/.claude/agents/code-quality/code-quality-linting-expert.md","/Users/eryk.napierala/Development/fasola/.claude/agents/code-review-expert.md","/Users/eryk.napierala/Development/fasola/.claude/agents/code-search.md","/Users/eryk.napierala/Development/fasola/.claude/agents/database/database-expert.md","/Users/eryk.napierala/Development/fasola/.claude/agents/database/database-postgres-expert.md","/Users/eryk.napierala/Development/fasola/.claude/agents/documentation/documentation-expert.md","/Users/eryk.napierala/Development/fasola/.claude/agents/frontend/frontend-accessibility-expert.md","/Users/eryk.napierala/Development/fasola/.claude/agents/git/git-expert.md","/Users/eryk.napierala/Development/fasola/.claude/agents/ios-simulator.md","/Users/eryk.napierala/Development/fasola/.claude/agents/oracle.md","/Users/eryk.napierala/Development/fasola/.claude/agents/react/react-expert.md","/Users/eryk.napierala/Development/fasola/.claude/agents/react/react-performance-expert.md","/Users/eryk.napierala/Development/fasola/.claude/agents/refactoring/refactoring-expert.md","/Users/eryk.napierala/Development/fasola/.claude/agents/research-expert.md","/Users/eryk.napierala/Development/fasola/.claude/agents/testing/testing-expert.md","/Users/eryk.napierala/Development/fasola/.claude/agents/testing/vitest-testing-expert.md","/Users/eryk.napierala/Development/fasola/.claude/agents/triage-expert.md","/Users/eryk.napierala/Development/fasola/.claude/agents/typescript/typescript-build-expert.md","/Users/eryk.napierala/Development/fasola/.claude/agents/typescript/typescript-expert.md","/Users/eryk.napierala/Development/fasola/.claude/agents/typescript/typescript-type-expert.md","/Users/eryk.napierala/Development/fasola/.claude/agents/react-native/react-native-expert.md","/Users/eryk.napierala/Development/fasola/.claude/agents/expo/expo-expert.md"],"durationMs":739,"numFiles":23,"truncated":false},"sourceToolAssistantUUID":"15ff60c9-8a55-4964-a838-0e7353dce833"}
{"parentUuid":"780a739a-a78e-432d-9ec9-af468404366b","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01LESq6bLW2Bkf9rkdrCvB43","type":"tool_result","content":"# Expo-Related Skills from Agent Skills Directory\n\nBased on the webpage content, here are the Expo-related skills currently available in the directory:\n\n## Listed Expo Skills\n\n1. **building-native-ui** (10.6K installs)\n   - \"building native ui\" capabilities for mobile development\n\n2. **native-data-fetching** (6.8K installs)\n   - Data retrieval patterns for native applications\n\n3. **upgrading-expo** (6.6K installs)\n   - Guidance for updating Expo framework versions\n\n4. **expo-dev-client** (5.8K installs)\n   - Development client setup and configuration\n\n5. **expo-deployment** (5.8K installs)\n   - Deployment procedures and workflows\n\n6. **expo-tailwind-setup** (5.8K installs)\n   - Tailwind CSS integration with Expo projects\n\n7. **expo-api-routes** (5.3K installs)\n   - API routing patterns for Expo applications\n\n8. **expo-cicd-workflows** (4.9K installs)\n   - Continuous integration and deployment automation\n\n9. **use-dom** (4.5K installs)\n   - DOM interaction methods in Expo environment\n\n## Key Topics Covered\n\nThe skills encompass Expo's core ecosystem: native UI development, data management, dependency updates, local development tools, cloud deployment (EAS), styling frameworks, backend routing, automation pipelines, and web API integration patterns."}]},"uuid":"54a20c02-f5cb-4c87-89b5-fb52c1846f79","timestamp":"2026-02-17T21:54:17.212Z","toolUseResult":{"bytes":270184,"code":200,"codeText":"OK","result":"# Expo-Related Skills from Agent Skills Directory\n\nBased on the webpage content, here are the Expo-related skills currently available in the directory:\n\n## Listed Expo Skills\n\n1. **building-native-ui** (10.6K installs)\n   - \"building native ui\" capabilities for mobile development\n\n2. **native-data-fetching** (6.8K installs)\n   - Data retrieval patterns for native applications\n\n3. **upgrading-expo** (6.6K installs)\n   - Guidance for updating Expo framework versions\n\n4. **expo-dev-client** (5.8K installs)\n   - Development client setup and configuration\n\n5. **expo-deployment** (5.8K installs)\n   - Deployment procedures and workflows\n\n6. **expo-tailwind-setup** (5.8K installs)\n   - Tailwind CSS integration with Expo projects\n\n7. **expo-api-routes** (5.3K installs)\n   - API routing patterns for Expo applications\n\n8. **expo-cicd-workflows** (4.9K installs)\n   - Continuous integration and deployment automation\n\n9. **use-dom** (4.5K installs)\n   - DOM interaction methods in Expo environment\n\n## Key Topics Covered\n\nThe skills encompass Expo's core ecosystem: native UI development, data management, dependency updates, local development tools, cloud deployment (EAS), styling frameworks, backend routing, automation pipelines, and web API integration patterns.","durationMs":8367,"url":"https://skills.sh/?q=expo"},"sourceToolAssistantUUID":"780a739a-a78e-432d-9ec9-af468404366b"}
{"parentUuid":"9a66be8b-5258-4c5d-8417-d07182663114","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_014Fgvut9FF6c9Bq1zVv7BhG","type":"tool_result","content":"Web search results for query: \"Expo SDK 52 53 2025 2026 new features best practices\"\n\nLinks: [{\"title\":\"Changelog — Expo\",\"url\":\"https://expo.dev/changelog\"},{\"title\":\"Upgrade Expo SDK - Expo Documentation\",\"url\":\"https://docs.expo.dev/workflow/upgrading-expo-sdk-walkthrough/\"},{\"title\":\"Expo SDK 52 - Expo Changelog\",\"url\":\"https://expo.dev/changelog/2024-11-12-sdk-52\"},{\"title\":\"expo/packages/expo/CHANGELOG.md at main · expo/expo\",\"url\":\"https://github.com/expo/expo/blob/main/packages/expo/CHANGELOG.md\"},{\"title\":\"What to Expect from Expo SDK 52. The beta release of Expo SDK 52 is now… | by Onix React | Medium\",\"url\":\"https://medium.com/@onix_react/what-to-expect-from-expo-sdk-52-48c28c07db6a\"},{\"title\":\"React Native Update - Expo 52 is Here | WaveMaker Docs\",\"url\":\"https://docs.wavemaker.com/learn/blog/2024/12/16/expo-52-react-native-update/\"},{\"title\":\"Expo 53 Now Available | The Draftbit Community\",\"url\":\"https://community.draftbit.com/c/whats-new/expo-53-now-available\"},{\"title\":\"expo - npm\",\"url\":\"https://www.npmjs.com/package/expo?activeTab=versions\"},{\"title\":\"Customer.io Docs | Changelog\",\"url\":\"https://docs.customer.io/integrations/sdk/expo/whats-new/changelog/\"},{\"title\":\"Expo SDK 52: New Architecture & Features | Pagepro\",\"url\":\"https://pagepro.co/blog/react-tldr/expo-sdk-52-release/\"}]\n\nBased on the search results, here's what I found about Expo SDK 52, 53, and their features for 2025-2026:\n\n## Expo SDK 52 New Features\n\nReact Native 0.77 is available with Expo SDK 52. Key features include:\n\n- **expo/fetch API**: A drop-in replacement, WinterCG-compliant Fetch API that supports download streaming, which is useful for integrating modern AI APIs that require efficient handling of data streams.\n\n- **React Navigation v7**: React Navigation v7 is now available, and if you use Expo Router, the upgrade will be automatic and many of the changes will be handled for you.\n\n- **React Native DevTools**: React Native DevTools replaces the JavaScript debugger introduced in SDK 47.\n\n- **expo-video**: The stable release of `expo-video` includes enhanced reliability, performance, and new features like lock screen controls and Picture-in-Picture support.\n\n- **New Architecture Support**: Projects upgrading from a previous SDK release can opt in to the New Architecture, and it's recommended enabling it after upgrading successfully using the old architecture.\n\n## Expo SDK 53 Features\n\nExpo SDK 53 includes React Native 0.79.\n\n**New Architecture becomes default**: In SDK 53, the New Architecture will likely be enabled by default.\n\n## Important Changes & Best Practices\n\n**Push Notifications & Google Maps**: Push notifications (remote notifications) will no longer be supported in Expo Go in SDK 53, and in SDK 52, you will be warned when using push notifications-related features from expo-notifications in Expo Go. Similarly, Google Maps will no longer be supported in Expo Go for Android in SDK 53, and in SDK 52, you will be warned when using react-native-maps in Expo Go for Android.\n\n**Upgrade Best Practices**: Ensure all third-party native libraries are updated to their latest versions, and run `npx expo-doctor@latest` to detect any incompatible libraries, which cross-references with the React Native Directory and flags any potential issues.\n\n\nREMINDER: You MUST include the sources above in your response to the user using markdown hyperlinks."}]},"uuid":"bf866362-e2b7-4581-90b8-62acdb7e3460","timestamp":"2026-02-17T21:54:23.273Z","toolUseResult":{"query":"Expo SDK 52 53 2025 2026 new features best practices","results":[{"tool_use_id":"srvtoolu_01QFEaw4XxcgVapB7Vs3QHBM","content":[{"title":"Changelog — Expo","url":"https://expo.dev/changelog"},{"title":"Upgrade Expo SDK - Expo Documentation","url":"https://docs.expo.dev/workflow/upgrading-expo-sdk-walkthrough/"},{"title":"Expo SDK 52 - Expo Changelog","url":"https://expo.dev/changelog/2024-11-12-sdk-52"},{"title":"expo/packages/expo/CHANGELOG.md at main · expo/expo","url":"https://github.com/expo/expo/blob/main/packages/expo/CHANGELOG.md"},{"title":"What to Expect from Expo SDK 52. The beta release of Expo SDK 52 is now… | by Onix React | Medium","url":"https://medium.com/@onix_react/what-to-expect-from-expo-sdk-52-48c28c07db6a"},{"title":"React Native Update - Expo 52 is Here | WaveMaker Docs","url":"https://docs.wavemaker.com/learn/blog/2024/12/16/expo-52-react-native-update/"},{"title":"Expo 53 Now Available | The Draftbit Community","url":"https://community.draftbit.com/c/whats-new/expo-53-now-available"},{"title":"expo - npm","url":"https://www.npmjs.com/package/expo?activeTab=versions"},{"title":"Customer.io Docs | Changelog","url":"https://docs.customer.io/integrations/sdk/expo/whats-new/changelog/"},{"title":"Expo SDK 52: New Architecture & Features | Pagepro","url":"https://pagepro.co/blog/react-tldr/expo-sdk-52-release/"}]},"Based on the search results, here's what I found about Expo SDK 52, 53, and their features for 2025-2026:\n\n## Expo SDK 52 New Features\n\nReact Native 0.77 is available with Expo SDK 52. Key features include:\n\n- **expo/fetch API**: A drop-in replacement, WinterCG-compliant Fetch API that supports download streaming, which is useful for integrating modern AI APIs that require efficient handling of data streams.\n\n- **React Navigation v7**: React Navigation v7 is now available, and if you use Expo Router, the upgrade will be automatic and many of the changes will be handled for you.\n\n- **React Native DevTools**: React Native DevTools replaces the JavaScript debugger introduced in SDK 47.\n\n- **expo-video**: The stable release of `expo-video` includes enhanced reliability, performance, and new features like lock screen controls and Picture-in-Picture support.\n\n- **New Architecture Support**: Projects upgrading from a previous SDK release can opt in to the New Architecture, and it's recommended enabling it after upgrading successfully using the old architecture.\n\n## Expo SDK 53 Features\n\nExpo SDK 53 includes React Native 0.79.\n\n**New Architecture becomes default**: In SDK 53, the New Architecture will likely be enabled by default.\n\n## Important Changes & Best Practices\n\n**Push Notifications & Google Maps**: Push notifications (remote notifications) will no longer be supported in Expo Go in SDK 53, and in SDK 52, you will be warned when using push notifications-related features from expo-notifications in Expo Go. Similarly, Google Maps will no longer be supported in Expo Go for Android in SDK 53, and in SDK 52, you will be warned when using react-native-maps in Expo Go for Android.\n\n**Upgrade Best Practices**: Ensure all third-party native libraries are updated to their latest versions, and run `npx expo-doctor@latest` to detect any incompatible libraries, which cross-references with the React Native Directory and flags any potential issues."],"durationSeconds":8.457728540999815},"sourceToolAssistantUUID":"9a66be8b-5258-4c5d-8417-d07182663114"}
{"parentUuid":"8cadafc7-a314-482e-b078-6788693cc50a","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01J26HY5VyFd4mz7uKmJfwAA","type":"tool_result","content":"Web search results for query: \"Expo framework expert guide config plugins EAS build update prebuild expo-router best practices\"\n\nLinks: [{\"title\":\"Introduction to config plugins - Expo Documentation\",\"url\":\"https://docs.expo.dev/config-plugins/introduction/\"},{\"title\":\"Create and use config plugins - Expo Documentation\",\"url\":\"https://docs.expo.dev/config-plugins/plugins/\"},{\"title\":\"Develop an app with Expo - Expo Documentation\",\"url\":\"https://docs.expo.dev/workflow/overview/\"},{\"title\":\"Custom build configuration schema - Expo Documentation\",\"url\":\"https://docs.expo.dev/custom-builds/schema/\"},{\"title\":\"From Confusion to Clarity: A Simple Guide to Expo Config Keys | by Nilesh Ganpat Chavan | Simform Engineering | Medium\",\"url\":\"https://medium.com/simform-engineering/from-confusion-to-clarity-a-simple-guide-to-expo-config-keys-4f3d6ed50201\"},{\"title\":\"Adopt Prebuild - Expo Documentation\",\"url\":\"https://docs.expo.dev/guides/adopting-prebuild/\"},{\"title\":\"Get started with EAS Update - Expo Documentation\",\"url\":\"https://docs.expo.dev/eas-update/getting-started/\"},{\"title\":\"Developing and debugging a plugin - Expo Documentation\",\"url\":\"https://docs.expo.dev/config-plugins/development-and-debugging/\"},{\"title\":\"FAQ - Expo Documentation\",\"url\":\"https://docs.expo.dev/faq/\"},{\"title\":\"Using a dangerous mod - Expo Documentation\",\"url\":\"https://docs.expo.dev/config-plugins/dangerous-mods/\"}]\n\nI've performed the web search on Expo framework topics. Here are the key findings:\n\n## Config Plugins\n\nA config plugin is referenced in the plugins property of the app config file and is made up of one or more plugin functions written in JavaScript that are executed during the prebuild process. Config plugins can add native configuration to your project that isn't included by default, including generating app icons, setting the app name, and configuring AndroidManifest.xml and Info.plist.\n\n## Best Practices\n\nIn CNG projects, it is best to avoid modifying these native projects manually, because config plugins allow you to modify these native projects in a predictable way by consolidating your native project changes into a configuration file.\n\nConfig plugins can be chained together to apply multiple modifications, with each plugin in the chain running in the order it appears.\n\n## Prebuild\n\nContinuous Native Generation (CNG) is a process for building an Expo app where your native projects are generated on-demand from your app.json and package.json, similar to how your node_modules are generated from your package.json.\n\n## EAS Build and Update\n\nIf you're using config plugins in a project without native directories (CNG projects), they will be applied during the prebuild step in EAS Build or when running npx expo prebuild locally.\n\nThe runtimeVersion key defines a version identifier for the runtime environment your app requires and ensures that the JavaScript code pushed through an OTA update is compatible with the native code already installed on users' devices.\n\n## Debugging Config Plugins\n\nYou can debug config plugins by running EXPO_DEBUG=1 expo prebuild, which prints plugin stack logs showing which mods ran and in what order.\n\n\nREMINDER: You MUST include the sources above in your response to the user using markdown hyperlinks."}]},"uuid":"86fcd3bc-4d05-43ce-9a1a-9c570018471d","timestamp":"2026-02-17T21:54:23.637Z","toolUseResult":{"query":"Expo framework expert guide config plugins EAS build update prebuild expo-router best practices","results":[{"tool_use_id":"srvtoolu_014NLDpzd7aW6K24gv3abjDt","content":[{"title":"Introduction to config plugins - Expo Documentation","url":"https://docs.expo.dev/config-plugins/introduction/"},{"title":"Create and use config plugins - Expo Documentation","url":"https://docs.expo.dev/config-plugins/plugins/"},{"title":"Develop an app with Expo - Expo Documentation","url":"https://docs.expo.dev/workflow/overview/"},{"title":"Custom build configuration schema - Expo Documentation","url":"https://docs.expo.dev/custom-builds/schema/"},{"title":"From Confusion to Clarity: A Simple Guide to Expo Config Keys | by Nilesh Ganpat Chavan | Simform Engineering | Medium","url":"https://medium.com/simform-engineering/from-confusion-to-clarity-a-simple-guide-to-expo-config-keys-4f3d6ed50201"},{"title":"Adopt Prebuild - Expo Documentation","url":"https://docs.expo.dev/guides/adopting-prebuild/"},{"title":"Get started with EAS Update - Expo Documentation","url":"https://docs.expo.dev/eas-update/getting-started/"},{"title":"Developing and debugging a plugin - Expo Documentation","url":"https://docs.expo.dev/config-plugins/development-and-debugging/"},{"title":"FAQ - Expo Documentation","url":"https://docs.expo.dev/faq/"},{"title":"Using a dangerous mod - Expo Documentation","url":"https://docs.expo.dev/config-plugins/dangerous-mods/"}]},"I've performed the web search on Expo framework topics. Here are the key findings:\n\n## Config Plugins\n\nA config plugin is referenced in the plugins property of the app config file and is made up of one or more plugin functions written in JavaScript that are executed during the prebuild process. Config plugins can add native configuration to your project that isn't included by default, including generating app icons, setting the app name, and configuring AndroidManifest.xml and Info.plist.\n\n## Best Practices\n\nIn CNG projects, it is best to avoid modifying these native projects manually, because config plugins allow you to modify these native projects in a predictable way by consolidating your native project changes into a configuration file.\n\nConfig plugins can be chained together to apply multiple modifications, with each plugin in the chain running in the order it appears.\n\n## Prebuild\n\nContinuous Native Generation (CNG) is a process for building an Expo app where your native projects are generated on-demand from your app.json and package.json, similar to how your node_modules are generated from your package.json.\n\n## EAS Build and Update\n\nIf you're using config plugins in a project without native directories (CNG projects), they will be applied during the prebuild step in EAS Build or when running npx expo prebuild locally.\n\nThe runtimeVersion key defines a version identifier for the runtime environment your app requires and ensures that the JavaScript code pushed through an OTA update is compatible with the native code already installed on users' devices.\n\n## Debugging Config Plugins\n\nYou can debug config plugins by running EXPO_DEBUG=1 expo prebuild, which prints plugin stack logs showing which mods ran and in what order."],"durationSeconds":8.812074707999825},"sourceToolAssistantUUID":"8cadafc7-a314-482e-b078-6788693cc50a"}
{"parentUuid":"86fcd3bc-4d05-43ce-9a1a-9c570018471d","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","message":{"model":"claude-opus-4-6","id":"msg_01JeqLZ229ZerKJAWZwNYQMS","type":"message","role":"assistant","content":[{"type":"thinking","thinking":"There's already an expo-expert.md file. Let me check its contents, and also fetch more specific Expo documentation to build a comprehensive agent.","signature":"ErsCCkYICxgCKkDqH+cmFw9RkYFjgslJV/u3oGZ01ECGgMxsgt6babchbhEim4A9YDsgLxzVwqDOa8CxqHXB0P0h05XLTYQheWGWEgwzDqsx5E1Ql8hrQ/0aDAC0BGmT2ySofW5AQyIwm5y543FGDmpnpxW2YqRRpPnBWKQHrJOeS/uh2chzuZ8XKU0sZjyy5Ro7qgXq/oMbKqIBHYrxtSggp1lR6FL6VPQOEbVK42bbWt6pmHrH7gdNO+29+8QDR5dGMbxS2aX/dQP761m6apidU+XPa+/jTlSsXshtExu73LJqxF9MJcux4ni80Z2RfVk4is76dcYmdnTtsGSua9roQGKdd+RYT27/7GmurmKKv3rGu8aQJaiqSNkar1pRiUpIYEtIzWH0TiiiUD299xVKJx9xAWBlLIfKIJ8UGAE="}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":674,"cache_creation_input_tokens":2559,"cache_read_input_tokens":42240,"cache_creation":{"ephemeral_5m_input_tokens":2559,"ephemeral_1h_input_tokens":0},"output_tokens":8,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CYEPJZynpmTrWDoXCXiPi","type":"assistant","uuid":"1833d871-7289-4bd9-901c-7f659f3498c3","timestamp":"2026-02-17T21:54:26.566Z"}
{"parentUuid":"1833d871-7289-4bd9-901c-7f659f3498c3","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","message":{"model":"claude-opus-4-6","id":"msg_01JeqLZ229ZerKJAWZwNYQMS","type":"message","role":"assistant","content":[{"type":"text","text":"There's already an `expo-expert.md` file. Let me check its current contents and gather more Expo-specific documentation."}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":674,"cache_creation_input_tokens":2559,"cache_read_input_tokens":42240,"cache_creation":{"ephemeral_5m_input_tokens":2559,"ephemeral_1h_input_tokens":0},"output_tokens":8,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CYEPJZynpmTrWDoXCXiPi","type":"assistant","uuid":"5d4545f4-6615-4fa9-bdc4-3e3135f5dda7","timestamp":"2026-02-17T21:54:27.132Z"}
{"parentUuid":"5d4545f4-6615-4fa9-bdc4-3e3135f5dda7","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","message":{"model":"claude-opus-4-6","id":"msg_01JeqLZ229ZerKJAWZwNYQMS","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_012U2emjyidd7tfWH6G9WhPK","name":"Read","input":{"file_path":"/Users/eryk.napierala/Development/fasola/.claude/agents/expo/expo-expert.md"},"caller":{"type":"direct"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":674,"cache_creation_input_tokens":2559,"cache_read_input_tokens":42240,"cache_creation":{"ephemeral_5m_input_tokens":2559,"ephemeral_1h_input_tokens":0},"output_tokens":8,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CYEPJZynpmTrWDoXCXiPi","type":"assistant","uuid":"84ce94f5-e456-418c-b583-9819e60c66ee","timestamp":"2026-02-17T21:54:27.628Z"}
{"parentUuid":"84ce94f5-e456-418c-b583-9819e60c66ee","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"progress","data":{"type":"hook_progress","hookEvent":"PreToolUse","hookName":"PreToolUse:Read","command":"claudekit-hooks run file-guard"},"toolUseID":"toolu_012U2emjyidd7tfWH6G9WhPK","parentToolUseID":"toolu_012U2emjyidd7tfWH6G9WhPK","uuid":"e573a4a8-2ff5-4fb3-b2a3-cc0f3f21fe1c","timestamp":"2026-02-17T21:54:27.634Z"}
{"parentUuid":"e573a4a8-2ff5-4fb3-b2a3-cc0f3f21fe1c","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Read","command":"callback"},"parentToolUseID":"toolu_012U2emjyidd7tfWH6G9WhPK","toolUseID":"toolu_012U2emjyidd7tfWH6G9WhPK","timestamp":"2026-02-17T21:54:27.808Z","uuid":"221f4d96-37c8-4054-b4f1-fbc889a14093"}
{"parentUuid":"84ce94f5-e456-418c-b583-9819e60c66ee","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_012U2emjyidd7tfWH6G9WhPK","type":"tool_result","content":"<system-reminder>Warning: the file exists but is shorter than the provided offset (1). The file has 1 lines.</system-reminder>"}]},"uuid":"70c660e4-f8d8-46aa-b7da-7a9a4c30ee1e","timestamp":"2026-02-17T21:54:27.807Z","toolUseResult":{"type":"text","file":{"filePath":"/Users/eryk.napierala/Development/fasola/.claude/agents/expo/expo-expert.md","content":"","numLines":1,"startLine":1,"totalLines":1}},"sourceToolAssistantUUID":"84ce94f5-e456-418c-b583-9819e60c66ee"}
{"parentUuid":"70c660e4-f8d8-46aa-b7da-7a9a4c30ee1e","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","message":{"model":"claude-opus-4-6","id":"msg_01JeqLZ229ZerKJAWZwNYQMS","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_011vXeRFv1bHhbCcAC9qBzrz","name":"WebSearch","input":{"query":"Expo Router v4 file-based routing API routes \"use dom\" 2025 documentation"},"caller":{"type":"direct"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":674,"cache_creation_input_tokens":2559,"cache_read_input_tokens":42240,"cache_creation":{"ephemeral_5m_input_tokens":2559,"ephemeral_1h_input_tokens":0},"output_tokens":8,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CYEPJZynpmTrWDoXCXiPi","type":"assistant","uuid":"8c208d22-96c7-42cc-a07f-e468b53d2b6a","timestamp":"2026-02-17T21:54:28.499Z"}
{"parentUuid":"8c208d22-96c7-42cc-a07f-e468b53d2b6a","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","message":{"model":"claude-opus-4-6","id":"msg_01JeqLZ229ZerKJAWZwNYQMS","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_017eTRFwmqTQPApTiVx4hmxA","name":"WebSearch","input":{"query":"EAS Build EAS Update EAS Submit best practices configuration 2025 2026"},"caller":{"type":"direct"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":674,"cache_creation_input_tokens":2559,"cache_read_input_tokens":42240,"cache_creation":{"ephemeral_5m_input_tokens":2559,"ephemeral_1h_input_tokens":0},"output_tokens":8,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CYEPJZynpmTrWDoXCXiPi","type":"assistant","uuid":"35351ed3-e8f9-4ef8-b995-d8ba0fb5c68b","timestamp":"2026-02-17T21:54:29.255Z"}
{"parentUuid":"35351ed3-e8f9-4ef8-b995-d8ba0fb5c68b","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","message":{"model":"claude-opus-4-6","id":"msg_01JeqLZ229ZerKJAWZwNYQMS","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_017UrV6Am1dDR2ywpT8gyYS9","name":"WebSearch","input":{"query":"Expo Modules API native module creation turbo modules JSI 2025"},"caller":{"type":"direct"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":674,"cache_creation_input_tokens":2559,"cache_read_input_tokens":42240,"cache_creation":{"ephemeral_5m_input_tokens":2559,"ephemeral_1h_input_tokens":0},"output_tokens":8,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CYEPJZynpmTrWDoXCXiPi","type":"assistant","uuid":"acf3ed41-57c7-42a3-8ef1-aeff9f80a847","timestamp":"2026-02-17T21:54:29.946Z"}
{"parentUuid":"8c208d22-96c7-42cc-a07f-e468b53d2b6a","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_011vXeRFv1bHhbCcAC9qBzrz","type":"tool_result","content":"Web search results for query: \"Expo Router v4 file-based routing API routes \"use dom\" 2025 documentation\"\n\nLinks: [{\"title\":\"Introduction to Expo Router - Expo Documentation\",\"url\":\"https://docs.expo.dev/router/introduction/\"},{\"title\":\"Router - Expo Documentation\",\"url\":\"https://docs.expo.dev/versions/latest/sdk/router/\"},{\"title\":\"API Routes - Expo Documentation\",\"url\":\"https://docs.expo.dev/router/web/api-routes/\"},{\"title\":\"Core concepts of file-based routing in Expo Router - Expo Documentation\",\"url\":\"https://docs.expo.dev/router/basics/core-concepts/\"},{\"title\":\"File-based routing\",\"url\":\"https://docs.expo.dev/develop/file-based-routing/\"},{\"title\":\"Expo Router notation - Expo Documentation\",\"url\":\"https://docs.expo.dev/router/basics/notation/\"},{\"title\":\"Expo Router — Expo\",\"url\":\"https://expo.dev/router\"},{\"title\":\"The Morrow guide to Expo Router | Morrow\",\"url\":\"https://www.themorrow.digital/blog/what-is-the-expo-router\"},{\"title\":\"Expo Router\",\"url\":\"https://expo.github.io/router/docs/\"},{\"title\":\"Navigation in Expo and React Native apps - Expo Documentation\",\"url\":\"https://docs.expo.dev/develop/app-navigation/\"}]\n\nI found documentation on Expo Router's API Routes. Here are the key findings:\n\n## API Routes in Expo Router\n\nAPI Routes are functions that are executed on a server when a route is matched. They can be used to handle sensitive data, such as API keys securely, or implement custom server logic, such as exchanging auth codes for access tokens.\n\n### File-Based Routing for API Routes\n\nIn Expo, API Routes are defined by creating files in the app directory with the +api.ts extension. API route filenames cannot have platform-specific extensions. For example, hello+api.web.ts will not work.\n\n### Supported HTTP Methods\n\nYou can export any of the following functions GET, POST, PUT, PATCH, DELETE, HEAD, and OPTIONS from a server route.\n\n### Request and Response Handling\n\nRequests use the global, standard Request object. Responses use the global, standard Response object.\n\nHowever, I notice the search results don't contain specific information about \"use dom\" syntax or Expo Router v4 specific features released in 2025. The API Routes documentation shows the standard file-based routing pattern (+api.ts extension) but doesn't reference a \"use dom\" directive. You may want to check the latest Expo documentation directly or search for more recent announcements about Expo Router v4 features.\n\n\nREMINDER: You MUST include the sources above in your response to the user using markdown hyperlinks."}]},"uuid":"92e2c2a5-40d4-468f-b90c-be30117d4650","timestamp":"2026-02-17T21:54:35.136Z","toolUseResult":{"query":"Expo Router v4 file-based routing API routes \"use dom\" 2025 documentation","results":[{"tool_use_id":"srvtoolu_016CX2SF67VPhy77yps4F9kJ","content":[{"title":"Introduction to Expo Router - Expo Documentation","url":"https://docs.expo.dev/router/introduction/"},{"title":"Router - Expo Documentation","url":"https://docs.expo.dev/versions/latest/sdk/router/"},{"title":"API Routes - Expo Documentation","url":"https://docs.expo.dev/router/web/api-routes/"},{"title":"Core concepts of file-based routing in Expo Router - Expo Documentation","url":"https://docs.expo.dev/router/basics/core-concepts/"},{"title":"File-based routing","url":"https://docs.expo.dev/develop/file-based-routing/"},{"title":"Expo Router notation - Expo Documentation","url":"https://docs.expo.dev/router/basics/notation/"},{"title":"Expo Router — Expo","url":"https://expo.dev/router"},{"title":"The Morrow guide to Expo Router | Morrow","url":"https://www.themorrow.digital/blog/what-is-the-expo-router"},{"title":"Expo Router","url":"https://expo.github.io/router/docs/"},{"title":"Navigation in Expo and React Native apps - Expo Documentation","url":"https://docs.expo.dev/develop/app-navigation/"}]},"I found documentation on Expo Router's API Routes. Here are the key findings:\n\n## API Routes in Expo Router\n\nAPI Routes are functions that are executed on a server when a route is matched. They can be used to handle sensitive data, such as API keys securely, or implement custom server logic, such as exchanging auth codes for access tokens.\n\n### File-Based Routing for API Routes\n\nIn Expo, API Routes are defined by creating files in the app directory with the +api.ts extension. API route filenames cannot have platform-specific extensions. For example, hello+api.web.ts will not work.\n\n### Supported HTTP Methods\n\nYou can export any of the following functions GET, POST, PUT, PATCH, DELETE, HEAD, and OPTIONS from a server route.\n\n### Request and Response Handling\n\nRequests use the global, standard Request object. Responses use the global, standard Response object.\n\nHowever, I notice the search results don't contain specific information about \"use dom\" syntax or Expo Router v4 specific features released in 2025. The API Routes documentation shows the standard file-based routing pattern (+api.ts extension) but doesn't reference a \"use dom\" directive. You may want to check the latest Expo documentation directly or search for more recent announcements about Expo Router v4 features."],"durationSeconds":6.636226916000014},"sourceToolAssistantUUID":"8c208d22-96c7-42cc-a07f-e468b53d2b6a"}
{"parentUuid":"acf3ed41-57c7-42a3-8ef1-aeff9f80a847","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_017UrV6Am1dDR2ywpT8gyYS9","type":"tool_result","content":"Web search results for query: \"Expo Modules API native module creation turbo modules JSI 2025\"\n\nLinks: [{\"title\":\"Expo Modules API: Overview - Expo Documentation\",\"url\":\"https://docs.expo.dev/modules/overview/\"},{\"title\":\"How to Easily Create Native Libraries With Nitro and Turbo Modules\",\"url\":\"https://www.callstack.com/blog/bridgeless-native-development\"},{\"title\":\"Comparison with other frameworks | Nitro Modules\",\"url\":\"https://nitro.margelo.com/docs/comparison\"},{\"title\":\"Tutorial: Create a native module - Expo Documentation\",\"url\":\"https://docs.expo.dev/modules/native-module-tutorial/\"},{\"title\":\"Native Modules: Introduction · React Native\",\"url\":\"https://reactnative.dev/docs/turbo-native-modules-introduction\"},{\"title\":\"Client guide to React Native modules | Oscar Franco\",\"url\":\"https://ospfranco.com/client-guide-to-react-native-modules/\"},{\"title\":\"Turbocharged Mobile Apps: Exploring Native Modules in React Native - GeekyAnts\",\"url\":\"https://geekyants.com/blog/turbocharged-mobile-apps-exploring-native-modules-in-react-native\"},{\"title\":\"Bridging the Gap: Integrating Custom Native Functionality in Expo with TurboModules\",\"url\":\"https://www.mlpai.in/2025/05/bridging-gap-integrating-custom-native.html\"},{\"title\":\"Expo Modules API: Design considerations - Expo Documentation\",\"url\":\"https://docs.expo.dev/modules/design/\"},{\"title\":\"Add custom native code - Expo Documentation\",\"url\":\"https://docs.expo.dev/workflow/customizing/\"}]\n\nI've performed the web search for your query. Here's a summary of the key findings:\n\n## Expo Modules API and Native Module Creation\n\nThe Expo Modules API allows you to write Swift and Kotlin to add new capabilities to your app with native modules and views. The Expo Modules API has similar performance characteristics to React Native's Turbo Modules API, and both APIs leverage React Native's JavaScript Interface (JSI), rather than the legacy approach of using a JSON message queue.\n\n## Key Features and Design\n\nThe API is designed to take advantage of modern language features, to be as consistent as possible on both platforms, to require minimal boilerplate, and provide comparable performance characteristics to React Native's Turbo Modules API. The Expo Modules ecosystem was designed from the ground up to be used with modern native languages: Swift and Kotlin.\n\n## Turbo Modules vs. Expo Modules\n\nIf you intend to use C++ in your native module, use Turbo Modules since it provides easier access to lower-level mechanisms. If you are looking for a better developer experience and you are willing to depend on the expo package in your module, then use the Expo Modules API.\n\n## Creating Native Modules\n\nIf you intend to use your native module in a single app, local Expo Modules function similarly to Expo Modules used by library developers, but they are not published on npm. You create them directly inside your project, scaffolding a Swift and Kotlin module inside the modules directory in your project.\n\nThe search results provide comprehensive documentation from official Expo sources as well as community guides on native module creation in 2025.\n\n\nREMINDER: You MUST include the sources above in your response to the user using markdown hyperlinks."}]},"uuid":"4f9d8a84-56c5-44a9-ad30-c112ff781998","timestamp":"2026-02-17T21:54:37.670Z","toolUseResult":{"query":"Expo Modules API native module creation turbo modules JSI 2025","results":[{"tool_use_id":"srvtoolu_01KqSPH5oTC2uLTWGEpLApJm","content":[{"title":"Expo Modules API: Overview - Expo Documentation","url":"https://docs.expo.dev/modules/overview/"},{"title":"How to Easily Create Native Libraries With Nitro and Turbo Modules","url":"https://www.callstack.com/blog/bridgeless-native-development"},{"title":"Comparison with other frameworks | Nitro Modules","url":"https://nitro.margelo.com/docs/comparison"},{"title":"Tutorial: Create a native module - Expo Documentation","url":"https://docs.expo.dev/modules/native-module-tutorial/"},{"title":"Native Modules: Introduction · React Native","url":"https://reactnative.dev/docs/turbo-native-modules-introduction"},{"title":"Client guide to React Native modules | Oscar Franco","url":"https://ospfranco.com/client-guide-to-react-native-modules/"},{"title":"Turbocharged Mobile Apps: Exploring Native Modules in React Native - GeekyAnts","url":"https://geekyants.com/blog/turbocharged-mobile-apps-exploring-native-modules-in-react-native"},{"title":"Bridging the Gap: Integrating Custom Native Functionality in Expo with TurboModules","url":"https://www.mlpai.in/2025/05/bridging-gap-integrating-custom-native.html"},{"title":"Expo Modules API: Design considerations - Expo Documentation","url":"https://docs.expo.dev/modules/design/"},{"title":"Add custom native code - Expo Documentation","url":"https://docs.expo.dev/workflow/customizing/"}]},"I've performed the web search for your query. Here's a summary of the key findings:\n\n## Expo Modules API and Native Module Creation\n\nThe Expo Modules API allows you to write Swift and Kotlin to add new capabilities to your app with native modules and views. The Expo Modules API has similar performance characteristics to React Native's Turbo Modules API, and both APIs leverage React Native's JavaScript Interface (JSI), rather than the legacy approach of using a JSON message queue.\n\n## Key Features and Design\n\nThe API is designed to take advantage of modern language features, to be as consistent as possible on both platforms, to require minimal boilerplate, and provide comparable performance characteristics to React Native's Turbo Modules API. The Expo Modules ecosystem was designed from the ground up to be used with modern native languages: Swift and Kotlin.\n\n## Turbo Modules vs. Expo Modules\n\nIf you intend to use C++ in your native module, use Turbo Modules since it provides easier access to lower-level mechanisms. If you are looking for a better developer experience and you are willing to depend on the expo package in your module, then use the Expo Modules API.\n\n## Creating Native Modules\n\nIf you intend to use your native module in a single app, local Expo Modules function similarly to Expo Modules used by library developers, but they are not published on npm. You create them directly inside your project, scaffolding a Swift and Kotlin module inside the modules directory in your project.\n\nThe search results provide comprehensive documentation from official Expo sources as well as community guides on native module creation in 2025."],"durationSeconds":7.722969082999975},"sourceToolAssistantUUID":"acf3ed41-57c7-42a3-8ef1-aeff9f80a847"}
{"parentUuid":"35351ed3-e8f9-4ef8-b995-d8ba0fb5c68b","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_017eTRFwmqTQPApTiVx4hmxA","type":"tool_result","content":"Web search results for query: \"EAS Build EAS Update EAS Submit best practices configuration 2025 2026\"\n\nLinks: [{\"title\":\"Mastering Expo EAS: Submit, OTA Updates, and Workflow Automation | Procedure Blog\",\"url\":\"https://procedure.tech/blogs/mastering-expo-eas-submit-ota-updates-and-workflow-automation\"},{\"title\":\"🎯 eas.json Demystified: The Only Guide You Need for EAS Build & Submit | by Ikram | Medium\",\"url\":\"https://medium.com/@ikrammohdabdul/eas-json-demystified-the-only-guide-you-need-for-eas-build-submit-8b909e96348b\"},{\"title\":\"From Build to App Store: Deploying React Native Apps with EAS in 2026 | React Native Relay\",\"url\":\"https://reactnativerelay.com/article/from-build-to-app-store-complete-guide-deploying-react-native-apps-eas-2026\"},{\"title\":\"EAS Update - Expo Documentation\",\"url\":\"https://docs.expo.dev/eas-update/introduction/\"},{\"title\":\"How EAS Update works - Expo Documentation\",\"url\":\"https://docs.expo.dev/eas-update/how-it-works/\"},{\"title\":\"Streamline your mobile app deployment using these EAS Update best practices\",\"url\":\"https://expo.dev/blog/eas-update-best-practices\"},{\"title\":\"EAS Build - Expo Documentation\",\"url\":\"https://docs.expo.dev/build/introduction/\"},{\"title\":\"GitHub - expo/eas-cli: Fastest way to build, submit, and update iOS and Android apps\",\"url\":\"https://github.com/expo/eas-cli\"},{\"title\":\"🚀 Setting up EAS CI/CD Pipeline with GitLab: A Complete Guide to Expo Updates and Builds 🔧📲 | by Vasu Aggarwal | Medium\",\"url\":\"https://medium.com/@vasu2001/setting-up-eas-ci-cd-pipeline-with-gitlab-a-complete-guide-to-expo-updates-and-builds-0d76e1bb015b\"},{\"title\":\"Using EAS Update - Expo Documentation\",\"url\":\"https://docs.expo.dev/build/updates/\"}]\n\nBased on the web search results, here's a comprehensive overview of EAS Build, EAS Update, and EAS Submit best practices and configuration for 2025-2026:\n\n## EAS Build Best Practices\n\nStructure your build profiles thoughtfully by using a base profile with extends to keep your configuration DRY, and create separate profiles for development, preview, QA, and production environments.\n\nLet EAS manage your credentials. EAS Build makes building your apps for distribution simple and easy to automate by providing defaults that work well for Expo and React Native projects out of the box, and by handling your app signing credentials for you (if you wish).\n\n## EAS Update Best Practices\n\nEAS Update lets you push over-the-air (OTA) updates - ideal for quick JS, UI, or asset changes (not native code).\n\nEach build profile can be assigned to a channel, so updates for builds produced for a given profile will pull only those releases that are published to its channel. For example, you might use the \"production\" channel for production builds, and the \"staging\" channel for test builds distributed with internal distribution.\n\nA different runtime version should be used for each binary version of your app. Any time you change the native runtime, you should increment the runtime version.\n\n## EAS Submit Best Practices\n\nWith EAS Submit, pushing to TestFlight or Play Console becomes a single command - no Transporter, no manual uploads.\n\nSave repeat settings in a submit profile to avoid re-entering them.\n\n## Cost Optimization\n\nUse appropriate resource classes - development and preview builds rarely need the large resource class. Reserve it for production builds where speed matters most.\n\nLeverage OTA updates - every update you can ship via EAS Update instead of a full build saves significant build minutes. For JavaScript-only changes, OTA updates are nearly free compared to full builds.\n\n## Configuration Management\n\nThe eas.json file is the configuration heart of Expo Application Services (EAS). It defines how your iOS and Android builds are created and how they're submitted to the App Store and Google Play.\n\nIf you want to enforce the eas-cli version for your project, use the \"cli.version\" field in eas.json. Installing eas-cli to your project dependencies is strongly discouraged because it may cause dependency conflicts that are difficult to debug.\n\n\nREMINDER: You MUST include the sources above in your response to the user using markdown hyperlinks."}]},"uuid":"797c1255-1f38-4905-8796-003b09619866","timestamp":"2026-02-17T21:54:41.900Z","toolUseResult":{"query":"EAS Build EAS Update EAS Submit best practices configuration 2025 2026","results":[{"tool_use_id":"srvtoolu_01BWXxfuFF4yY5PGCrd9EnbX","content":[{"title":"Mastering Expo EAS: Submit, OTA Updates, and Workflow Automation | Procedure Blog","url":"https://procedure.tech/blogs/mastering-expo-eas-submit-ota-updates-and-workflow-automation"},{"title":"🎯 eas.json Demystified: The Only Guide You Need for EAS Build & Submit | by Ikram | Medium","url":"https://medium.com/@ikrammohdabdul/eas-json-demystified-the-only-guide-you-need-for-eas-build-submit-8b909e96348b"},{"title":"From Build to App Store: Deploying React Native Apps with EAS in 2026 | React Native Relay","url":"https://reactnativerelay.com/article/from-build-to-app-store-complete-guide-deploying-react-native-apps-eas-2026"},{"title":"EAS Update - Expo Documentation","url":"https://docs.expo.dev/eas-update/introduction/"},{"title":"How EAS Update works - Expo Documentation","url":"https://docs.expo.dev/eas-update/how-it-works/"},{"title":"Streamline your mobile app deployment using these EAS Update best practices","url":"https://expo.dev/blog/eas-update-best-practices"},{"title":"EAS Build - Expo Documentation","url":"https://docs.expo.dev/build/introduction/"},{"title":"GitHub - expo/eas-cli: Fastest way to build, submit, and update iOS and Android apps","url":"https://github.com/expo/eas-cli"},{"title":"🚀 Setting up EAS CI/CD Pipeline with GitLab: A Complete Guide to Expo Updates and Builds 🔧📲 | by Vasu Aggarwal | Medium","url":"https://medium.com/@vasu2001/setting-up-eas-ci-cd-pipeline-with-gitlab-a-complete-guide-to-expo-updates-and-builds-0d76e1bb015b"},{"title":"Using EAS Update - Expo Documentation","url":"https://docs.expo.dev/build/updates/"}]},"Based on the web search results, here's a comprehensive overview of EAS Build, EAS Update, and EAS Submit best practices and configuration for 2025-2026:\n\n## EAS Build Best Practices\n\nStructure your build profiles thoughtfully by using a base profile with extends to keep your configuration DRY, and create separate profiles for development, preview, QA, and production environments.\n\nLet EAS manage your credentials. EAS Build makes building your apps for distribution simple and easy to automate by providing defaults that work well for Expo and React Native projects out of the box, and by handling your app signing credentials for you (if you wish).\n\n## EAS Update Best Practices\n\nEAS Update lets you push over-the-air (OTA) updates - ideal for quick JS, UI, or asset changes (not native code).\n\nEach build profile can be assigned to a channel, so updates for builds produced for a given profile will pull only those releases that are published to its channel. For example, you might use the \"production\" channel for production builds, and the \"staging\" channel for test builds distributed with internal distribution.\n\nA different runtime version should be used for each binary version of your app. Any time you change the native runtime, you should increment the runtime version.\n\n## EAS Submit Best Practices\n\nWith EAS Submit, pushing to TestFlight or Play Console becomes a single command - no Transporter, no manual uploads.\n\nSave repeat settings in a submit profile to avoid re-entering them.\n\n## Cost Optimization\n\nUse appropriate resource classes - development and preview builds rarely need the large resource class. Reserve it for production builds where speed matters most.\n\nLeverage OTA updates - every update you can ship via EAS Update instead of a full build saves significant build minutes. For JavaScript-only changes, OTA updates are nearly free compared to full builds.\n\n## Configuration Management\n\nThe eas.json file is the configuration heart of Expo Application Services (EAS). It defines how your iOS and Android builds are created and how they're submitted to the App Store and Google Play.\n\nIf you want to enforce the eas-cli version for your project, use the \"cli.version\" field in eas.json. Installing eas-cli to your project dependencies is strongly discouraged because it may cause dependency conflicts that are difficult to debug."],"durationSeconds":12.643624458000064},"sourceToolAssistantUUID":"35351ed3-e8f9-4ef8-b995-d8ba0fb5c68b"}
{"parentUuid":"797c1255-1f38-4905-8796-003b09619866","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","message":{"model":"claude-opus-4-6","id":"msg_0166ttmonYY2XwUsof2aFcA3","type":"message","role":"assistant","content":[{"type":"thinking","thinking":"Now let me fetch more specific Expo documentation pages to get detailed content for the agent.","signature":"EoYCCkYICxgCKkAKjJC66+u6QYsPY0w31IovWRkXhCPz8rYIsEKAAD5s19NgLoRkUXIwMmjeFN8m4ppjObmb+3zZ9CLN2KHo6/aTEgyxwjabfsIRgYMXLyEaDJ7bkwT9+oRq2c2tjyIwh4TDpqhSnjnD0hQThijLyXcQsXvuAQwb9NTbRxXu0x6Hj/BDpo0ecxlnAnJ4kmUJKm6p28DyeM9w94vA/2GZSGF1sZjjbyLlPXPiAgF2xV8oNoIboK17OxW9TL9r2sJTM6xMAmPvn+BJPaapeJmnxU+Uf83jNb55+7gqO7OrLSjMIhrS+GbAoEwME1VprXbKKhgrpXtl1nJ8UHUzQzsPBhgB"}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":815,"cache_creation_input_tokens":2906,"cache_read_input_tokens":44799,"cache_creation":{"ephemeral_5m_input_tokens":2906,"ephemeral_1h_input_tokens":0},"output_tokens":8,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CYEPKvkz2dURUBPB5rNSu","type":"assistant","uuid":"994ccecb-8938-4cfd-b91a-a8c984406788","timestamp":"2026-02-17T21:54:44.538Z"}
{"parentUuid":"994ccecb-8938-4cfd-b91a-a8c984406788","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","message":{"model":"claude-opus-4-6","id":"msg_0166ttmonYY2XwUsof2aFcA3","type":"message","role":"assistant","content":[{"type":"text","text":"Let me fetch more detailed documentation and also look at some of the skills.sh entries for deeper content."}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":815,"cache_creation_input_tokens":2906,"cache_read_input_tokens":44799,"cache_creation":{"ephemeral_5m_input_tokens":2906,"ephemeral_1h_input_tokens":0},"output_tokens":8,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CYEPKvkz2dURUBPB5rNSu","type":"assistant","uuid":"156974f5-a5a2-474e-82ea-0a4701a1e679","timestamp":"2026-02-17T21:54:45.515Z"}
{"parentUuid":"156974f5-a5a2-474e-82ea-0a4701a1e679","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","message":{"model":"claude-opus-4-6","id":"msg_0166ttmonYY2XwUsof2aFcA3","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01EVrtaobHiecVsA9KcsySqF","name":"WebFetch","input":{"url":"https://docs.expo.dev/workflow/overview/","prompt":"Extract all key concepts about Expo development workflow: CNG (Continuous Native Generation), prebuild, dev client, Expo Go, managed vs bare workflow, and build/deploy pipeline. List every tool, command, and concept mentioned."},"caller":{"type":"direct"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":815,"cache_creation_input_tokens":2906,"cache_read_input_tokens":44799,"cache_creation":{"ephemeral_5m_input_tokens":2906,"ephemeral_1h_input_tokens":0},"output_tokens":8,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CYEPKvkz2dURUBPB5rNSu","type":"assistant","uuid":"5a78d7a5-727d-4ca5-a1b5-b544c2b3850b","timestamp":"2026-02-17T21:54:47.643Z"}
{"parentUuid":"5a78d7a5-727d-4ca5-a1b5-b544c2b3850b","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","message":{"model":"claude-opus-4-6","id":"msg_0166ttmonYY2XwUsof2aFcA3","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01DTjKWAtR54pqhjnPN5p7X7","name":"WebFetch","input":{"url":"https://docs.expo.dev/config-plugins/introduction/","prompt":"Extract all details about Expo config plugins: what they are, how they work, how to create them, the mod system, dangerous mods, plugin ordering, best practices, and common patterns. Include code patterns and API details."},"caller":{"type":"direct"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":815,"cache_creation_input_tokens":2906,"cache_read_input_tokens":44799,"cache_creation":{"ephemeral_5m_input_tokens":2906,"ephemeral_1h_input_tokens":0},"output_tokens":8,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CYEPKvkz2dURUBPB5rNSu","type":"assistant","uuid":"9d9bca66-cb4e-420b-a9ec-66f8329da002","timestamp":"2026-02-17T21:54:49.369Z"}
{"parentUuid":"9d9bca66-cb4e-420b-a9ec-66f8329da002","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","message":{"model":"claude-opus-4-6","id":"msg_0166ttmonYY2XwUsof2aFcA3","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01Ros6mBg6Azbgq3oxyWCHy6","name":"WebFetch","input":{"url":"https://docs.expo.dev/router/introduction/","prompt":"Extract all details about Expo Router: file-based routing, layouts, groups, dynamic routes, typed routes, API routes, navigation patterns, universal links, and platform-specific routing. Include all key concepts and patterns."},"caller":{"type":"direct"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":815,"cache_creation_input_tokens":2906,"cache_read_input_tokens":44799,"cache_creation":{"ephemeral_5m_input_tokens":2906,"ephemeral_1h_input_tokens":0},"output_tokens":8,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CYEPKvkz2dURUBPB5rNSu","type":"assistant","uuid":"05b838e0-76ce-4a41-82b3-1ea99e3ce298","timestamp":"2026-02-17T21:54:50.676Z"}
{"parentUuid":"05b838e0-76ce-4a41-82b3-1ea99e3ce298","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","message":{"model":"claude-opus-4-6","id":"msg_0166ttmonYY2XwUsof2aFcA3","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_011UiobLW9yNR8WL3faRtWZT","name":"WebSearch","input":{"query":"Expo \"use dom\" directive component web view DOM SDK 52 53"},"caller":{"type":"direct"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":815,"cache_creation_input_tokens":2906,"cache_read_input_tokens":44799,"cache_creation":{"ephemeral_5m_input_tokens":2906,"ephemeral_1h_input_tokens":0},"output_tokens":8,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CYEPKvkz2dURUBPB5rNSu","type":"assistant","uuid":"6bc5a74b-052d-4830-b140-3b2ff0ddc6f7","timestamp":"2026-02-17T21:54:51.369Z"}
{"parentUuid":"6bc5a74b-052d-4830-b140-3b2ff0ddc6f7","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_011UiobLW9yNR8WL3faRtWZT","type":"tool_result","content":"Web search results for query: \"Expo \"use dom\" directive component web view DOM SDK 52 53\"\n\nLinks: [{\"title\":\"Using React DOM in Expo native apps - Expo Documentation\",\"url\":\"https://docs.expo.dev/guides/dom-components/\"},{\"title\":\"Expo SDK 52 beta is now available - Expo Changelog\",\"url\":\"https://expo.dev/changelog/2024-10-24-sdk-52-beta\"},{\"title\":\"Expo SDK 52 - Expo Changelog\",\"url\":\"https://expo.dev/changelog/2024-11-12-sdk-52\"},{\"title\":\"Expo DOM: Unlocking Web Capabilities in React Native Apps | by Divyansh Anand | Feb, 2026 | Medium\",\"url\":\"https://medium.com/@REDACTED\"},{\"title\":\"What to Expect from Expo SDK 52. The beta release of Expo SDK 52 is now… | by Onix React | Medium\",\"url\":\"https://medium.com/@onix_react/what-to-expect-from-expo-sdk-52-48c28c07db6a\"},{\"title\":\"Issue with WebView and DOM components on expo v52^ · Issue #33889 · expo/expo\",\"url\":\"https://github.com/expo/expo/issues/33889\"},{\"title\":\"expo/docs/pages/guides/dom-components.mdx at main · expo/expo\",\"url\":\"https://github.com/expo/expo/blob/main/docs/pages/guides/dom-components.mdx\"},{\"title\":\"Expo 52, Sherlock Holmes the Mystery of the Missing Safe Area, and AI Models in Your Pocket | by The React Native Rewind | ITNEXT\",\"url\":\"https://itnext.io/expo-52-sherlock-holmes-the-mystery-of-the-missing-safe-area-and-ai-models-in-your-pocket-e3435050123a\"},{\"title\":\"use-dom by expo/skills\",\"url\":\"https://skills.sh/expo/skills/use-dom\"},{\"title\":\"Expo Made React Web-to-Native Migration easier by \\\"Use Dom\\\"\",\"url\":\"https://bcalabs.org/blog/expo-made-react-web-to-native-migration-easier-by-use-dom\"}]\n\nBased on the search results, here's what I found about the 'use dom' directive, DOM components, and web view functionality in Expo SDK 52 and 53:\n\n## Overview\n\nExpo offers a novel approach to work with modern web code directly in a native app via the 'use dom' directive. This feature is available in SDK 52 and later.\n\n## How It Works\n\nTo use DOM Components, create a React DOM component file (using <div>, <span>, even <marquee> if you want) and then add the \"use dom\" directive to the top of the file. You will now be able to import that DOM component from a React Native component. The DOM component will be rendered inside a webview, but you can mostly use it like a normal component via props (with a slightly different pattern required for non-serializable props, in particular functions).\n\n## Key Features and Benefits\n\nThis enables incremental migration for an entire website to a universal app by moving on a per-component basis. You can use any web library that you like within your DOM components.\n\n## Differences Between SDK 52 and 53\n\nExpo SDK 53 and later use React 19. This means that the ref prop is passed to the component as a prop, and you can use it directly in the component. In Expo SDK 52 and earlier (React 18), use the legacy forwardRef function to access the ref handle.\n\n## Limitations\n\nData can be sent between DOM components and native components only through an asynchronous JSON transport system. DOM components currently only render as single-page applications and don't support static rendering or React Server Components (RSC).\n\n\nREMINDER: You MUST include the sources above in your response to the user using markdown hyperlinks."}]},"uuid":"7a5e4b58-38ab-4461-9363-e1148f455820","timestamp":"2026-02-17T21:54:59.618Z","toolUseResult":{"query":"Expo \"use dom\" directive component web view DOM SDK 52 53","results":[{"tool_use_id":"srvtoolu_017TaFhqFxYTzu5J2pv8AQ1c","content":[{"title":"Using React DOM in Expo native apps - Expo Documentation","url":"https://docs.expo.dev/guides/dom-components/"},{"title":"Expo SDK 52 beta is now available - Expo Changelog","url":"https://expo.dev/changelog/2024-10-24-sdk-52-beta"},{"title":"Expo SDK 52 - Expo Changelog","url":"https://expo.dev/changelog/2024-11-12-sdk-52"},{"title":"Expo DOM: Unlocking Web Capabilities in React Native Apps | by Divyansh Anand | Feb, 2026 | Medium","url":"https://medium.com/@REDACTED"},{"title":"What to Expect from Expo SDK 52. The beta release of Expo SDK 52 is now… | by Onix React | Medium","url":"https://medium.com/@onix_react/what-to-expect-from-expo-sdk-52-48c28c07db6a"},{"title":"Issue with WebView and DOM components on expo v52^ · Issue #33889 · expo/expo","url":"https://github.com/expo/expo/issues/33889"},{"title":"expo/docs/pages/guides/dom-components.mdx at main · expo/expo","url":"https://github.com/expo/expo/blob/main/docs/pages/guides/dom-components.mdx"},{"title":"Expo 52, Sherlock Holmes the Mystery of the Missing Safe Area, and AI Models in Your Pocket | by The React Native Rewind | ITNEXT","url":"https://itnext.io/expo-52-sherlock-holmes-the-mystery-of-the-missing-safe-area-and-ai-models-in-your-pocket-e3435050123a"},{"title":"use-dom by expo/skills","url":"https://skills.sh/expo/skills/use-dom"},{"title":"Expo Made React Web-to-Native Migration easier by \"Use Dom\"","url":"https://bcalabs.org/blog/expo-made-react-web-to-native-migration-easier-by-use-dom"}]},"Based on the search results, here's what I found about the 'use dom' directive, DOM components, and web view functionality in Expo SDK 52 and 53:\n\n## Overview\n\nExpo offers a novel approach to work with modern web code directly in a native app via the 'use dom' directive. This feature is available in SDK 52 and later.\n\n## How It Works\n\nTo use DOM Components, create a React DOM component file (using <div>, <span>, even <marquee> if you want) and then add the \"use dom\" directive to the top of the file. You will now be able to import that DOM component from a React Native component. The DOM component will be rendered inside a webview, but you can mostly use it like a normal component via props (with a slightly different pattern required for non-serializable props, in particular functions).\n\n## Key Features and Benefits\n\nThis enables incremental migration for an entire website to a universal app by moving on a per-component basis. You can use any web library that you like within your DOM components.\n\n## Differences Between SDK 52 and 53\n\nExpo SDK 53 and later use React 19. This means that the ref prop is passed to the component as a prop, and you can use it directly in the component. In Expo SDK 52 and earlier (React 18), use the legacy forwardRef function to access the ref handle.\n\n## Limitations\n\nData can be sent between DOM components and native components only through an asynchronous JSON transport system. DOM components currently only render as single-page applications and don't support static rendering or React Server Components (RSC)."],"durationSeconds":8.247453791000181},"sourceToolAssistantUUID":"6bc5a74b-052d-4830-b140-3b2ff0ddc6f7"}
{"parentUuid":"9d9bca66-cb4e-420b-a9ec-66f8329da002","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01DTjKWAtR54pqhjnPN5p7X7","type":"tool_result","content":"# Expo Config Plugins: Overview\n\n## What They Are\n\nConfig plugins are custom configuration points that extend Expo's app config system. As the documentation states, they enable developers to \"modify native projects created during the prebuild process in CNG projects\" without directly editing native files.\n\n## Core Architecture\n\nThe plugin system consists of interconnected layers:\n\n- **Plugin**: The entry-point function (conventionally named `with<PluginName>`) referenced in the app config's `plugins` array\n- **Plugin Functions**: Smaller wrapper functions within a plugin that handle platform-specific logic\n- **Mod Plugin Functions**: Wrappers from `expo/config-plugins` that safely modify native files\n- **Mods**: Underlying platform-specific modifiers (e.g., `mods.android.manifest`) that directly alter native project files\n\n## Key Characteristics\n\nAccording to the guide, config plugins:\n\n- Are synchronous functions accepting an `ExpoConfig` and returning a modified version\n- Follow naming convention `with<Functionality>` (e.g., `withFacebook`)\n- Execute during app config evaluation\n- Accept optional configuration as a second argument\n- Keep non-mod modifications outside mods to ensure execution in non-prebuild scenarios\n\n## Practical Applications\n\nConfig plugins handle native configuration including:\n- App icon generation\n- App naming\n- AndroidManifest.xml configuration\n- Info.plist modifications\n\n## Why Use Them\n\nIn Continuous Native Generation workflows, plugins provide a \"predictable way\" to manage native changes, preventing manual edits that could be overwritten during regeneration."}]},"uuid":"40e31aa7-0bf6-4448-ab8d-8d6f1ac8f130","timestamp":"2026-02-17T22:17:46.113Z","toolUseResult":{"bytes":5568,"code":200,"codeText":"OK","result":"# Expo Config Plugins: Overview\n\n## What They Are\n\nConfig plugins are custom configuration points that extend Expo's app config system. As the documentation states, they enable developers to \"modify native projects created during the prebuild process in CNG projects\" without directly editing native files.\n\n## Core Architecture\n\nThe plugin system consists of interconnected layers:\n\n- **Plugin**: The entry-point function (conventionally named `with<PluginName>`) referenced in the app config's `plugins` array\n- **Plugin Functions**: Smaller wrapper functions within a plugin that handle platform-specific logic\n- **Mod Plugin Functions**: Wrappers from `expo/config-plugins` that safely modify native files\n- **Mods**: Underlying platform-specific modifiers (e.g., `mods.android.manifest`) that directly alter native project files\n\n## Key Characteristics\n\nAccording to the guide, config plugins:\n\n- Are synchronous functions accepting an `ExpoConfig` and returning a modified version\n- Follow naming convention `with<Functionality>` (e.g., `withFacebook`)\n- Execute during app config evaluation\n- Accept optional configuration as a second argument\n- Keep non-mod modifications outside mods to ensure execution in non-prebuild scenarios\n\n## Practical Applications\n\nConfig plugins handle native configuration including:\n- App icon generation\n- App naming\n- AndroidManifest.xml configuration\n- Info.plist modifications\n\n## Why Use Them\n\nIn Continuous Native Generation workflows, plugins provide a \"predictable way\" to manage native changes, preventing manual edits that could be overwritten during regeneration.","durationMs":4944,"url":"https://docs.expo.dev/config-plugins/introduction/"},"sourceToolAssistantUUID":"9d9bca66-cb4e-420b-a9ec-66f8329da002"}
{"parentUuid":"05b838e0-76ce-4a41-82b3-1ea99e3ce298","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01Ros6mBg6Azbgq3oxyWCHy6","type":"tool_result","content":"# Expo Router: Key Concepts from Introduction\n\nBased on the provided content, here are the main details about Expo Router:\n\n## Core Definition\nExpo Router is described as \"a file-based router for React Native and web applications\" that enables navigation management across Android, iOS, and web platforms using shared components.\n\n## File-Based Routing Advantages\nThe documentation highlights several benefits of the file-system approach:\n- **Simplified mental model**: \"The file system is a well-known and well-understood concept,\" making onboarding easier\n- **Automatic route generation**: Files added to the app directory automatically become navigation routes\n- **Refactoring efficiency**: Moving files doesn't require updating imports or routing components\n- **Type safety**: Routes are statically typed, preventing links to non-existent destinations\n\n## Key Features Listed\n- **Native foundation**: Built on React Navigation with platform optimization\n- **Deep linking**: Every screen is automatically deep linkable and shareable\n- **Offline capability**: Apps function offline-first with automatic updates\n- **Performance**: Routes use lazy-evaluation in production and deferred bundling\n- **Universal support**: Consistent navigation across all platforms with platform-specific API access\n- **SEO/Discoverability**: Enables static rendering on web for search engine indexing\n\n## Notable Capabilities\n- **Async Routes**: Bundle splitting improves development speed, especially for larger projects\n- **Typed Routes**: Automatic static typing prevents broken links\n- **Deep links**: Work universally across all pages without requiring network connectivity\n\n## Relationship to React Navigation\nExpo Router functions as a \"superset of React Navigation,\" built atop it to provide file-based routing benefits while maintaining compatibility with React Navigation components."}]},"uuid":"d6b7c7eb-4372-4f15-b139-749864f3469a","timestamp":"2026-02-17T22:17:46.812Z","toolUseResult":{"bytes":8387,"code":200,"codeText":"OK","result":"# Expo Router: Key Concepts from Introduction\n\nBased on the provided content, here are the main details about Expo Router:\n\n## Core Definition\nExpo Router is described as \"a file-based router for React Native and web applications\" that enables navigation management across Android, iOS, and web platforms using shared components.\n\n## File-Based Routing Advantages\nThe documentation highlights several benefits of the file-system approach:\n- **Simplified mental model**: \"The file system is a well-known and well-understood concept,\" making onboarding easier\n- **Automatic route generation**: Files added to the app directory automatically become navigation routes\n- **Refactoring efficiency**: Moving files doesn't require updating imports or routing components\n- **Type safety**: Routes are statically typed, preventing links to non-existent destinations\n\n## Key Features Listed\n- **Native foundation**: Built on React Navigation with platform optimization\n- **Deep linking**: Every screen is automatically deep linkable and shareable\n- **Offline capability**: Apps function offline-first with automatic updates\n- **Performance**: Routes use lazy-evaluation in production and deferred bundling\n- **Universal support**: Consistent navigation across all platforms with platform-specific API access\n- **SEO/Discoverability**: Enables static rendering on web for search engine indexing\n\n## Notable Capabilities\n- **Async Routes**: Bundle splitting improves development speed, especially for larger projects\n- **Typed Routes**: Automatic static typing prevents broken links\n- **Deep links**: Work universally across all pages without requiring network connectivity\n\n## Relationship to React Navigation\nExpo Router functions as a \"superset of React Navigation,\" built atop it to provide file-based routing benefits while maintaining compatibility with React Navigation components.","durationMs":5642,"url":"https://docs.expo.dev/router/introduction/"},"sourceToolAssistantUUID":"05b838e0-76ce-4a41-82b3-1ea99e3ce298"}
{"parentUuid":"5a78d7a5-727d-4ca5-a1b5-b544c2b3850b","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01EVrtaobHiecVsA9KcsySqF","type":"tool_result","content":"# Expo Development Workflow: Key Concepts & Tools\n\n## Core Concepts\n\n**Expo App**: A \"React Native app that uses Expo tools\" - can leverage individual SDK packages, Expo Router, Expo CLI, CNG, or combinations thereof.\n\n**Expo vs. EAS**: \n- Expo is open-source (MIT license) providing CLI, Router, SDK packages, and build tooling\n- \"Expo Application Services (EAS) is a suite of hosted services\" for building, submitting, updating apps and team collaboration\n\n**Continuous Native Generation (CNG)**: Automatically generates native project directories from `app.json` and `package.json` on-demand, similar to how `node_modules` are generated.\n\n**Development Builds**: Debug builds containing `expo-dev-client` library enabling faster iteration, native library installation, and flexible configuration—superior to Expo Go for production projects.\n\n**Expo Go**: Described as \"the fastest way to get started\" but \"a limited playground and not useful for building production-grade projects.\"\n\n## Essential Commands & Tools\n\n| Command | Purpose |\n|---------|---------|\n| `npx create-expo-app` | Initialize new project |\n| `npx expo prebuild` | Generate native directories |\n| `npx expo prebuild --clean` | Regenerate native projects cleanly |\n| `npx expo run:android\\|ios` | Local compilation and deployment |\n\n## Development Workflows\n\n**Cloud-based**: EAS Build compiles apps without requiring local Android Studio/Xcode installation\n\n**Local**: Requires Android Studio and Xcode; uses `npx expo run` commands or native IDEs\n\n## Core Development Loop\n\n1. Write/run JavaScript code\n2. Update app configuration (`app.json`/`app.config.js`)\n3. Write native code or modify native configuration\n4. Install libraries requiring native modifications\n\n## Distribution & Monitoring\n\n- **Sharing**: Internal distribution for testers\n- **Release**: EAS Submit for app store deployment\n- **Updates**: EAS Update provides \"instant updates\" via CDN\n- **Monitoring**: Crash reporting (Sentry, BugSnag) and analytics tracking"}]},"uuid":"ff749167-d1f7-4c45-982d-20597cd0c4de","timestamp":"2026-02-17T22:17:47.961Z","toolUseResult":{"bytes":17598,"code":200,"codeText":"OK","result":"# Expo Development Workflow: Key Concepts & Tools\n\n## Core Concepts\n\n**Expo App**: A \"React Native app that uses Expo tools\" - can leverage individual SDK packages, Expo Router, Expo CLI, CNG, or combinations thereof.\n\n**Expo vs. EAS**: \n- Expo is open-source (MIT license) providing CLI, Router, SDK packages, and build tooling\n- \"Expo Application Services (EAS) is a suite of hosted services\" for building, submitting, updating apps and team collaboration\n\n**Continuous Native Generation (CNG)**: Automatically generates native project directories from `app.json` and `package.json` on-demand, similar to how `node_modules` are generated.\n\n**Development Builds**: Debug builds containing `expo-dev-client` library enabling faster iteration, native library installation, and flexible configuration—superior to Expo Go for production projects.\n\n**Expo Go**: Described as \"the fastest way to get started\" but \"a limited playground and not useful for building production-grade projects.\"\n\n## Essential Commands & Tools\n\n| Command | Purpose |\n|---------|---------|\n| `npx create-expo-app` | Initialize new project |\n| `npx expo prebuild` | Generate native directories |\n| `npx expo prebuild --clean` | Regenerate native projects cleanly |\n| `npx expo run:android\\|ios` | Local compilation and deployment |\n\n## Development Workflows\n\n**Cloud-based**: EAS Build compiles apps without requiring local Android Studio/Xcode installation\n\n**Local**: Requires Android Studio and Xcode; uses `npx expo run` commands or native IDEs\n\n## Core Development Loop\n\n1. Write/run JavaScript code\n2. Update app configuration (`app.json`/`app.config.js`)\n3. Write native code or modify native configuration\n4. Install libraries requiring native modifications\n\n## Distribution & Monitoring\n\n- **Sharing**: Internal distribution for testers\n- **Release**: EAS Submit for app store deployment\n- **Updates**: EAS Update provides \"instant updates\" via CDN\n- **Monitoring**: Crash reporting (Sentry, BugSnag) and analytics tracking","durationMs":6802,"url":"https://docs.expo.dev/workflow/overview/"},"sourceToolAssistantUUID":"5a78d7a5-727d-4ca5-a1b5-b544c2b3850b"}
{"parentUuid":"ff749167-d1f7-4c45-982d-20597cd0c4de","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","message":{"model":"claude-opus-4-6","id":"msg_01Y9BEAunp1XRdobSmvzu8dQ","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01MWqCWMc87XDQGZcAkiEt2Q","name":"WebFetch","input":{"url":"https://docs.expo.dev/guides/dom-components/","prompt":"Extract all technical details about DOM components: the 'use dom' directive, how to create them, props passing, limitations, communication between native and DOM, performance considerations, and best practices."},"caller":{"type":"direct"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1739,"cache_creation_input_tokens":49490,"cache_read_input_tokens":0,"cache_creation":{"ephemeral_5m_input_tokens":49490,"ephemeral_1h_input_tokens":0},"output_tokens":26,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CYER667PetJ4U35e11tQM","type":"assistant","uuid":"49574926-3beb-4af0-a201-c514683def50","timestamp":"2026-02-17T22:17:51.683Z"}
{"parentUuid":"49574926-3beb-4af0-a201-c514683def50","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","message":{"model":"claude-opus-4-6","id":"msg_01Y9BEAunp1XRdobSmvzu8dQ","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_019Fv8NDpKAf5iajB9BDmdjt","name":"WebFetch","input":{"url":"https://docs.expo.dev/modules/overview/","prompt":"Extract all technical details about Expo Modules API: creating native modules, Swift/Kotlin APIs, the Module class, views, events, async functions, local modules, and design principles. Include API patterns and key concepts."},"caller":{"type":"direct"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1739,"cache_creation_input_tokens":49490,"cache_read_input_tokens":0,"cache_creation":{"ephemeral_5m_input_tokens":49490,"ephemeral_1h_input_tokens":0},"output_tokens":26,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CYER667PetJ4U35e11tQM","type":"assistant","uuid":"4d95acd8-378f-40f2-b164-0f046de16ca9","timestamp":"2026-02-17T22:17:53.229Z"}
{"parentUuid":"4d95acd8-378f-40f2-b164-0f046de16ca9","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","message":{"model":"claude-opus-4-6","id":"msg_01Y9BEAunp1XRdobSmvzu8dQ","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01CHWFDMwF28s5A3jrE1UZQf","name":"WebFetch","input":{"url":"https://expo.dev/blog/eas-update-best-practices","prompt":"Extract all EAS Update best practices: runtime versioning, channels, branches, rollback strategies, fingerprint-based versioning, deployment patterns, and common pitfalls."},"caller":{"type":"direct"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1739,"cache_creation_input_tokens":49490,"cache_read_input_tokens":0,"cache_creation":{"ephemeral_5m_input_tokens":49490,"ephemeral_1h_input_tokens":0},"output_tokens":26,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CYER667PetJ4U35e11tQM","type":"assistant","uuid":"76c3f8c6-1628-4100-a9e7-4607122fa84f","timestamp":"2026-02-17T22:17:54.781Z"}
{"parentUuid":"76c3f8c6-1628-4100-a9e7-4607122fa84f","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","message":{"model":"claude-opus-4-6","id":"msg_01Y9BEAunp1XRdobSmvzu8dQ","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01H91G7yFdXC5yQLBka9bmxU","name":"WebSearch","input":{"query":"Expo common problems troubleshooting prebuild config plugin errors build failures 2025"},"caller":{"type":"direct"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1739,"cache_creation_input_tokens":49490,"cache_read_input_tokens":0,"cache_creation":{"ephemeral_5m_input_tokens":49490,"ephemeral_1h_input_tokens":0},"output_tokens":26,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CYER667PetJ4U35e11tQM","type":"assistant","uuid":"98bd8dcb-af58-40df-9057-f8e2bad3d65e","timestamp":"2026-02-17T22:17:55.508Z"}
{"parentUuid":"4d95acd8-378f-40f2-b164-0f046de16ca9","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_019Fv8NDpKAf5iajB9BDmdjt","type":"tool_result","content":"# Expo Modules API: Technical Overview\n\nBased on the provided documentation, here's what the page covers regarding native module development:\n\n## Core Capabilities\n\nThe Expo Modules API enables developers to write **Swift and Kotlin code to add new capabilities** through native modules and views. The framework emphasizes modern language features, cross-platform consistency, minimal boilerplate, and performance comparable to React Native's Turbo Modules.\n\n## Key Technical Features\n\n**Language Support & Architecture:**\n- Swift for iOS development\n- Kotlin for Android development\n- Full support for React Native's New Architecture\n- Backward compatibility with legacy architecture apps\n\n**Performance Characteristics:**\nThe framework leverages \"React Native's JavaScript Interface (JSI), rather than the legacy approach of using a JSON message queue\" for faster native-JavaScript communication. The API can \"easily execute hundreds of thousands of native method calls per second,\" making invocation overhead negligible for real-world applications.\n\n**App Impact:**\n- Size increase: negligible (few hundred kilobytes)\n- Performance: optimized where it matters most rather than for theoretical maximum speed\n\n## Learning Resources Mentioned\n\nThe documentation references:\n- The Expo SDK repository as implementation examples\n- Open-source community projects demonstrating patterns\n- Dedicated tutorials for native modules and native views\n- Configuration reference via `expo-module.config.json`\n\n## Scope Limitations\n\nThe current page is introductory. Detailed technical information about the Module class, event systems, async functions, and specific API patterns are referenced as available in separate documentation sections (design considerations, module API reference)."}]},"uuid":"70835a41-4838-403f-8192-cdce3eb058ea","timestamp":"2026-02-17T22:17:58.342Z","toolUseResult":{"bytes":6440,"code":200,"codeText":"OK","result":"# Expo Modules API: Technical Overview\n\nBased on the provided documentation, here's what the page covers regarding native module development:\n\n## Core Capabilities\n\nThe Expo Modules API enables developers to write **Swift and Kotlin code to add new capabilities** through native modules and views. The framework emphasizes modern language features, cross-platform consistency, minimal boilerplate, and performance comparable to React Native's Turbo Modules.\n\n## Key Technical Features\n\n**Language Support & Architecture:**\n- Swift for iOS development\n- Kotlin for Android development\n- Full support for React Native's New Architecture\n- Backward compatibility with legacy architecture apps\n\n**Performance Characteristics:**\nThe framework leverages \"React Native's JavaScript Interface (JSI), rather than the legacy approach of using a JSON message queue\" for faster native-JavaScript communication. The API can \"easily execute hundreds of thousands of native method calls per second,\" making invocation overhead negligible for real-world applications.\n\n**App Impact:**\n- Size increase: negligible (few hundred kilobytes)\n- Performance: optimized where it matters most rather than for theoretical maximum speed\n\n## Learning Resources Mentioned\n\nThe documentation references:\n- The Expo SDK repository as implementation examples\n- Open-source community projects demonstrating patterns\n- Dedicated tutorials for native modules and native views\n- Configuration reference via `expo-module.config.json`\n\n## Scope Limitations\n\nThe current page is introductory. Detailed technical information about the Module class, event systems, async functions, and specific API patterns are referenced as available in separate documentation sections (design considerations, module API reference).","durationMs":5112,"url":"https://docs.expo.dev/modules/overview/"},"sourceToolAssistantUUID":"4d95acd8-378f-40f2-b164-0f046de16ca9"}
{"parentUuid":"49574926-3beb-4af0-a201-c514683def50","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01MWqCWMc87XDQGZcAkiEt2Q","type":"tool_result","content":"# Technical Details: DOM Components in Expo\n\n## Core Concept\n\nThe `'use dom'` directive enables rendering React components with web technologies (HTML, CSS, DOM APIs) directly within native Expo apps. This supports incremental website-to-app migration on a per-component basis, available in SDK 52+.\n\n## Creating DOM Components\n\nAdd `'use dom'` at the file's top to mark a component for DOM rendering:\n\n```tsx\n'use dom';\n\nexport default function DOMComponent({ name }: { name: string }) {\n  return <div><h1>Hello, {name}</h1></div>;\n}\n```\n\nImport and use in native components normally—the framework automatically wraps it with `react-native-webview` behind the scenes.\n\n## Props Communication\n\n**Marshalled Props**: Send serializable data (strings, numbers, booleans, arrays, objects) through standard React props. These traverse an asynchronous bridge, causing full React tree re-renders.\n\n**Native Actions**: Pass top-level asynchronous functions as props to invoke native code from DOM components. Only serializable arguments are supported since data crosses a bridge.\n\n```tsx\n// Native side\n<DOMComponent onClick={(data: string) => console.log(data)} />\n\n// DOM side\n<p onClick={() => onClick('world')}>Click me</p>\n```\n\n## DOM-Specific Props\n\nUse the `dom` prop to configure underlying `WebView` behavior:\n\n```tsx\n<DOMComponent dom={{ scrollEnabled: false }} />\n```\n\nWithin the DOM component, declare the prop for TypeScript support:\n\n```tsx\nexport default function DOMComponent({}: { dom: import('expo/dom').DOMProps })\n```\n\n## References and Imperative Handles\n\nThe `useDOMImperativeHandle` hook (React 19+) allows native code to call methods on DOM components via refs:\n\n```tsx\n// Native side\nconst ref = useRef<DOMRef>(null);\nref.current?.focus();\n\n// DOM side\nuseDOMImperativeHandle(props.ref, () => ({ focus: () => {...} }), []);\n```\n\n> Note: \"React is meant to have a unilateral data flow, so the concept of using callbacks to go back up the tree is not idiomatic.\"\n\n## Key Limitations\n\n- Cannot pass `children` to DOM components\n- Function props must be asynchronous only\n- No shared global state across JavaScript engines\n- Deep linking and nested URL routing unsupported\n- No native modules optimization yet—use native actions instead\n- Cannot embed native views within DOM components\n\n## Performance & Architecture\n\nDOM components parse standard JavaScript, which is \"slower to parse and start up than optimized Hermes bytecode.\" Data transfer between engines uses an asynchronous JSON transport, limiting synchronous data dependencies.\n\nThe system functions as single-page applications without SSR/SSG support. When a module declares `'use dom'`, it's replaced with a proxy reference at runtime through bundler techniques.\n\n## Feature Detection\n\n```tsx\nimport { IS_DOM } from 'expo/dom';\nprocess.env.EXPO_DOM_HOST_OS; // 'ios', 'android', or undefined\n```\n\n## Best Practices\n\n- Use native primitives (`View`, `Image`, `Text`) for performance-critical UI\n- Reserve DOM components for content naturally suited to web (rich text, markdown, WebGL)\n- Employ native actions for data retrieval rather than relying on synchronous returns\n- Pass routing context via props instead of using hooks like `useLocalSearchParams()`\n- Use Expo Router's `<Link>` component for in-app navigation\n- Avoid standard `<a>` tags; use `WebBrowser` for external links\n\n## Debugging & Development\n\nConsole logs automatically forward to the terminal. Safari/Chrome inspection available in development mode. Fast Refresh and HMR supported. The `matchContents` prop automatically resizes views to match DOM content dimensions.\n\nFor Secure Context requirements (Clipboard API, etc.), release builds provide secure context via `file://` scheme; development requires HTTPS tunneling."}]},"uuid":"73e40b7f-2ba3-4350-b30a-2f44b9304d75","timestamp":"2026-02-17T22:18:03.322Z","toolUseResult":{"bytes":19058,"code":200,"codeText":"OK","result":"# Technical Details: DOM Components in Expo\n\n## Core Concept\n\nThe `'use dom'` directive enables rendering React components with web technologies (HTML, CSS, DOM APIs) directly within native Expo apps. This supports incremental website-to-app migration on a per-component basis, available in SDK 52+.\n\n## Creating DOM Components\n\nAdd `'use dom'` at the file's top to mark a component for DOM rendering:\n\n```tsx\n'use dom';\n\nexport default function DOMComponent({ name }: { name: string }) {\n  return <div><h1>Hello, {name}</h1></div>;\n}\n```\n\nImport and use in native components normally—the framework automatically wraps it with `react-native-webview` behind the scenes.\n\n## Props Communication\n\n**Marshalled Props**: Send serializable data (strings, numbers, booleans, arrays, objects) through standard React props. These traverse an asynchronous bridge, causing full React tree re-renders.\n\n**Native Actions**: Pass top-level asynchronous functions as props to invoke native code from DOM components. Only serializable arguments are supported since data crosses a bridge.\n\n```tsx\n// Native side\n<DOMComponent onClick={(data: string) => console.log(data)} />\n\n// DOM side\n<p onClick={() => onClick('world')}>Click me</p>\n```\n\n## DOM-Specific Props\n\nUse the `dom` prop to configure underlying `WebView` behavior:\n\n```tsx\n<DOMComponent dom={{ scrollEnabled: false }} />\n```\n\nWithin the DOM component, declare the prop for TypeScript support:\n\n```tsx\nexport default function DOMComponent({}: { dom: import('expo/dom').DOMProps })\n```\n\n## References and Imperative Handles\n\nThe `useDOMImperativeHandle` hook (React 19+) allows native code to call methods on DOM components via refs:\n\n```tsx\n// Native side\nconst ref = useRef<DOMRef>(null);\nref.current?.focus();\n\n// DOM side\nuseDOMImperativeHandle(props.ref, () => ({ focus: () => {...} }), []);\n```\n\n> Note: \"React is meant to have a unilateral data flow, so the concept of using callbacks to go back up the tree is not idiomatic.\"\n\n## Key Limitations\n\n- Cannot pass `children` to DOM components\n- Function props must be asynchronous only\n- No shared global state across JavaScript engines\n- Deep linking and nested URL routing unsupported\n- No native modules optimization yet—use native actions instead\n- Cannot embed native views within DOM components\n\n## Performance & Architecture\n\nDOM components parse standard JavaScript, which is \"slower to parse and start up than optimized Hermes bytecode.\" Data transfer between engines uses an asynchronous JSON transport, limiting synchronous data dependencies.\n\nThe system functions as single-page applications without SSR/SSG support. When a module declares `'use dom'`, it's replaced with a proxy reference at runtime through bundler techniques.\n\n## Feature Detection\n\n```tsx\nimport { IS_DOM } from 'expo/dom';\nprocess.env.EXPO_DOM_HOST_OS; // 'ios', 'android', or undefined\n```\n\n## Best Practices\n\n- Use native primitives (`View`, `Image`, `Text`) for performance-critical UI\n- Reserve DOM components for content naturally suited to web (rich text, markdown, WebGL)\n- Employ native actions for data retrieval rather than relying on synchronous returns\n- Pass routing context via props instead of using hooks like `useLocalSearchParams()`\n- Use Expo Router's `<Link>` component for in-app navigation\n- Avoid standard `<a>` tags; use `WebBrowser` for external links\n\n## Debugging & Development\n\nConsole logs automatically forward to the terminal. Safari/Chrome inspection available in development mode. Fast Refresh and HMR supported. The `matchContents` prop automatically resizes views to match DOM content dimensions.\n\nFor Secure Context requirements (Clipboard API, etc.), release builds provide secure context via `file://` scheme; development requires HTTPS tunneling.","durationMs":11637,"url":"https://docs.expo.dev/guides/dom-components/"},"sourceToolAssistantUUID":"49574926-3beb-4af0-a201-c514683def50"}
{"parentUuid":"98bd8dcb-af58-40df-9057-f8e2bad3d65e","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01H91G7yFdXC5yQLBka9bmxU","type":"tool_result","content":"Web search results for query: \"Expo common problems troubleshooting prebuild config plugin errors build failures 2025\"\n\nLinks: [{\"title\":\"Troubleshoot build errors and crashes - Expo Documentation\",\"url\":\"https://docs.expo.dev/build-reference/troubleshooting/\"},{\"title\":\"[Expo SDK 50] - pre-build fails when config plugins are present · Issue #26569 · expo/expo\",\"url\":\"https://github.com/expo/expo/issues/26569\"},{\"title\":\"Developing and debugging a plugin - Expo Documentation\",\"url\":\"https://docs.expo.dev/config-plugins/development-and-debugging/\"},{\"title\":\"Advanced Troubleshooting for Expo Mobile Framework in Production - Mindful Chase\",\"url\":\"https://www.mindfulchase.com/explore/troubleshooting-tips/mobile-frameworks/advanced-troubleshooting-for-expo-mobile-framework-in-production.html\"},{\"title\":\"[SDK 50] expo/config-plugins cutom plugins crashes the build · Issue #26533 · expo/expo\",\"url\":\"https://github.com/expo/expo/issues/26533\"},{\"title\":\"BUILD FAILED: A problem occurred evaluating root project - Expo Android | Medium\",\"url\":\"https://salmanazam.medium.com/expo-root-project-build-failed-android-gradle-fix-0abf9c1646a0\"},{\"title\":\"Common development errors - Expo Documentation\",\"url\":\"https://docs.expo.dev/workflow/common-development-errors/\"},{\"title\":\"Continuous Native Generation (CNG) - Expo Documentation\",\"url\":\"https://docs.expo.dev/workflow/prebuild/\"},{\"title\":\"Expo Build Properties Configuration Complete Guide 2025\",\"url\":\"https://javascript.plainenglish.io/expo-build-properties-configuration-complete-guide-2025-38cd1ebf946c\"},{\"title\":\"Adding config plugin causes build failure on ios · Issue #18358 · expo/expo\",\"url\":\"https://github.com/expo/expo/issues/18358\"}]\n\nBased on the web search results, here's a comprehensive overview of common Expo prebuild, config plugin, and build failure issues in 2025:\n\n## Debugging and Troubleshooting Approaches\n\nYou can debug config plugins by running `EXPO_DEBUG=1 expo prebuild`, which prints plugin stack logs showing which mods ran and in what order. To view all static plugin resolution errors, enable `EXPO_CONFIG_PLUGIN_VERBOSE_ERRORS`, though some automatic plugin errors are hidden as they're usually related to versioning issues.\n\nRunning `npx expo prebuild --clean` removes generated native directories before compiling, and you can run `npx expo config --type prebuild` to print the results of plugins with mods unevaluated.\n\n## Common Build Failure Issues\n\n**Configuration Mismatches**: The \"Failed to apply plugin 'expo-root-project'\" error is almost always a configuration mismatch, with common culprits including version incompatibilities.\n\n**SDK Version Issues**: Google Play Store requires Android API level 34 or higher starting in 2025, and Apple demands iOS 15.1 as the minimum deployment target for new apps.\n\n**Plugin Compatibility**: Unversioned plugins may not support the native code in your project, and for instance, breaking changes in Facebook native code or plugins will break how your project prebuilds.\n\n## Resolution Steps\n\nCheck what SDK version works with `npx expo install --fix` and `npx expo prebuild --clear`, or if issues persist, downgrade Expo SDK. When in doubt, start with the official Expo documentation and use `npx expo prebuild --clean` to regenerate your native configuration.\n\nFor missing usage strings and permission issues, add infoPlist fields in app.config.js for all required permissions, and pin expo, eas-cli, and expo-modules versions for reproducibility.\n\n\nREMINDER: You MUST include the sources above in your response to the user using markdown hyperlinks."}]},"uuid":"9c4a40a8-6254-45ea-9eb1-58e18e6785d8","timestamp":"2026-02-17T22:18:05.160Z","toolUseResult":{"query":"Expo common problems troubleshooting prebuild config plugin errors build failures 2025","results":[{"tool_use_id":"srvtoolu_013CtxwU2Yo7uyJQur9sGEwk","content":[{"title":"Troubleshoot build errors and crashes - Expo Documentation","url":"https://docs.expo.dev/build-reference/troubleshooting/"},{"title":"[Expo SDK 50] - pre-build fails when config plugins are present · Issue #26569 · expo/expo","url":"https://github.com/expo/expo/issues/26569"},{"title":"Developing and debugging a plugin - Expo Documentation","url":"https://docs.expo.dev/config-plugins/development-and-debugging/"},{"title":"Advanced Troubleshooting for Expo Mobile Framework in Production - Mindful Chase","url":"https://www.mindfulchase.com/explore/troubleshooting-tips/mobile-frameworks/advanced-troubleshooting-for-expo-mobile-framework-in-production.html"},{"title":"[SDK 50] expo/config-plugins cutom plugins crashes the build · Issue #26533 · expo/expo","url":"https://github.com/expo/expo/issues/26533"},{"title":"BUILD FAILED: A problem occurred evaluating root project - Expo Android | Medium","url":"https://salmanazam.medium.com/expo-root-project-build-failed-android-gradle-fix-0abf9c1646a0"},{"title":"Common development errors - Expo Documentation","url":"https://docs.expo.dev/workflow/common-development-errors/"},{"title":"Continuous Native Generation (CNG) - Expo Documentation","url":"https://docs.expo.dev/workflow/prebuild/"},{"title":"Expo Build Properties Configuration Complete Guide 2025","url":"https://javascript.plainenglish.io/expo-build-properties-configuration-complete-guide-2025-38cd1ebf946c"},{"title":"Adding config plugin causes build failure on ios · Issue #18358 · expo/expo","url":"https://github.com/expo/expo/issues/18358"}]},"Based on the web search results, here's a comprehensive overview of common Expo prebuild, config plugin, and build failure issues in 2025:\n\n## Debugging and Troubleshooting Approaches\n\nYou can debug config plugins by running `EXPO_DEBUG=1 expo prebuild`, which prints plugin stack logs showing which mods ran and in what order. To view all static plugin resolution errors, enable `EXPO_CONFIG_PLUGIN_VERBOSE_ERRORS`, though some automatic plugin errors are hidden as they're usually related to versioning issues.\n\nRunning `npx expo prebuild --clean` removes generated native directories before compiling, and you can run `npx expo config --type prebuild` to print the results of plugins with mods unevaluated.\n\n## Common Build Failure Issues\n\n**Configuration Mismatches**: The \"Failed to apply plugin 'expo-root-project'\" error is almost always a configuration mismatch, with common culprits including version incompatibilities.\n\n**SDK Version Issues**: Google Play Store requires Android API level 34 or higher starting in 2025, and Apple demands iOS 15.1 as the minimum deployment target for new apps.\n\n**Plugin Compatibility**: Unversioned plugins may not support the native code in your project, and for instance, breaking changes in Facebook native code or plugins will break how your project prebuilds.\n\n## Resolution Steps\n\nCheck what SDK version works with `npx expo install --fix` and `npx expo prebuild --clear`, or if issues persist, downgrade Expo SDK. When in doubt, start with the official Expo documentation and use `npx expo prebuild --clean` to regenerate your native configuration.\n\nFor missing usage strings and permission issues, add infoPlist fields in app.config.js for all required permissions, and pin expo, eas-cli, and expo-modules versions for reproducibility."],"durationSeconds":9.650549707999918},"sourceToolAssistantUUID":"98bd8dcb-af58-40df-9057-f8e2bad3d65e"}
{"parentUuid":"76c3f8c6-1628-4100-a9e7-4607122fa84f","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01CHWFDMwF28s5A3jrE1UZQf","type":"tool_result","content":"# EAS Update Best Practices\n\n## Core Technical Practices\n\n**Runtime Versioning**\nRuntime versions designate JavaScript compatibility with native code. The article emphasizes: \"Runtime versions help ensure that updates only go to versions of the app where the JavaScript is compatible.\"\n\n**Channels**\nUpdates can be isolated by channel, allowing separate management of production and preview app deployments.\n\n**Fingerprint-Based Versioning**\nUse fingerprint tools in EAS Workflows to verify code change compatibility with native binaries before deployment, enabling conditional workflows that determine whether an update or full build is necessary.\n\n## Deployment Patterns\n\n1. **Hotfixes-Only**: Reserve updates for critical bug fixes while maintaining standard store release cycles\n2. **Frequent Releases**: Deploy smaller JavaScript updates between scheduled store releases\n3. **Alternating Cadence**: Alternate weekly store releases with over-the-air updates to reduce overhead\n4. **Safe Continuous Deploy**: Release JavaScript-only changes compatible with current native versions automatically\n\n## Enhancement Strategies\n\n- **Critical Updates**: Mark urgent patches to force immediate application rather than waiting for next app launch\n- **Cross-Runtime Deployment**: Send compatible updates to multiple store versions, reaching users who disabled automatic store updates\n- **Background Updates**: Check periodically for updates in background tasks to ensure latest code before user sessions\n- **Hold-and-Reload**: Set brief startup delays to apply recently downloaded updates\n\n## Common Considerations\n\nUpdates follow store guidelines for interpreted code downloads and should incorporate end-to-end update signing for security. Success depends on aligning update strategy with your team's existing release practices rather than forcing a predetermined pattern."}]},"uuid":"24b28d01-8d4d-4bac-b552-2490357fa2d3","timestamp":"2026-02-17T22:18:10.079Z","toolUseResult":{"bytes":16123,"code":200,"codeText":"OK","result":"# EAS Update Best Practices\n\n## Core Technical Practices\n\n**Runtime Versioning**\nRuntime versions designate JavaScript compatibility with native code. The article emphasizes: \"Runtime versions help ensure that updates only go to versions of the app where the JavaScript is compatible.\"\n\n**Channels**\nUpdates can be isolated by channel, allowing separate management of production and preview app deployments.\n\n**Fingerprint-Based Versioning**\nUse fingerprint tools in EAS Workflows to verify code change compatibility with native binaries before deployment, enabling conditional workflows that determine whether an update or full build is necessary.\n\n## Deployment Patterns\n\n1. **Hotfixes-Only**: Reserve updates for critical bug fixes while maintaining standard store release cycles\n2. **Frequent Releases**: Deploy smaller JavaScript updates between scheduled store releases\n3. **Alternating Cadence**: Alternate weekly store releases with over-the-air updates to reduce overhead\n4. **Safe Continuous Deploy**: Release JavaScript-only changes compatible with current native versions automatically\n\n## Enhancement Strategies\n\n- **Critical Updates**: Mark urgent patches to force immediate application rather than waiting for next app launch\n- **Cross-Runtime Deployment**: Send compatible updates to multiple store versions, reaching users who disabled automatic store updates\n- **Background Updates**: Check periodically for updates in background tasks to ensure latest code before user sessions\n- **Hold-and-Reload**: Set brief startup delays to apply recently downloaded updates\n\n## Common Considerations\n\nUpdates follow store guidelines for interpreted code downloads and should incorporate end-to-end update signing for security. Success depends on aligning update strategy with your team's existing release practices rather than forcing a predetermined pattern.","durationMs":5838,"url":"https://expo.dev/blog/eas-update-best-practices"},"sourceToolAssistantUUID":"76c3f8c6-1628-4100-a9e7-4607122fa84f"}
{"parentUuid":"24b28d01-8d4d-4bac-b552-2490357fa2d3","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","message":{"model":"claude-opus-4-6","id":"msg_01CoY6vyyinBmZCw6uhPsqev","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_012cz3XBFrX8hQwWz9Yc6KWE","name":"WebFetch","input":{"url":"https://docs.expo.dev/workflow/prebuild/","prompt":"Extract all details about Continuous Native Generation (CNG) and prebuild: how it works, the prebuild command options, when to use prebuild --clean, how native directories are generated, the relationship between app.json and native code, and best practices."},"caller":{"type":"direct"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":943,"cache_creation_input_tokens":3821,"cache_read_input_tokens":49490,"cache_creation":{"ephemeral_5m_input_tokens":3821,"ephemeral_1h_input_tokens":0},"output_tokens":26,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CYER7igMNJ7ARgPrPzJa6","type":"assistant","uuid":"bbb98aae-4ad0-450b-8277-a0843ebe93b3","timestamp":"2026-02-17T22:18:14.168Z"}
{"parentUuid":"bbb98aae-4ad0-450b-8277-a0843ebe93b3","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"user","message":{"role":"user","content":[{"type":"tool_result","content":"Request failed with status code 404","is_error":true,"tool_use_id":"toolu_012cz3XBFrX8hQwWz9Yc6KWE"}]},"uuid":"845c515c-4a5c-4d05-84ac-cb80518d8633","timestamp":"2026-02-17T22:18:14.376Z","toolUseResult":"Error: Request failed with status code 404","sourceToolAssistantUUID":"bbb98aae-4ad0-450b-8277-a0843ebe93b3"}
{"parentUuid":"845c515c-4a5c-4d05-84ac-cb80518d8633","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","message":{"model":"claude-opus-4-6","id":"msg_01CoY6vyyinBmZCw6uhPsqev","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01GW9a4DtqmuYPJn79ZBjGRx","name":"WebFetch","input":{"url":"https://docs.expo.dev/workflow/common-development-errors/","prompt":"Extract all common Expo development errors listed on this page: error messages, causes, and solutions. Include every error type mentioned."},"caller":{"type":"direct"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":943,"cache_creation_input_tokens":3821,"cache_read_input_tokens":49490,"cache_creation":{"ephemeral_5m_input_tokens":3821,"ephemeral_1h_input_tokens":0},"output_tokens":26,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CYER7igMNJ7ARgPrPzJa6","type":"assistant","uuid":"049ad56b-39bf-4b5b-96a3-ca38b2f5d2f8","timestamp":"2026-02-17T22:18:15.260Z"}
{"parentUuid":"049ad56b-39bf-4b5b-96a3-ca38b2f5d2f8","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"user","message":{"role":"user","content":[{"type":"tool_result","content":"<tool_use_error>Sibling tool call errored</tool_use_error>","is_error":true,"tool_use_id":"toolu_01GW9a4DtqmuYPJn79ZBjGRx"}]},"uuid":"0144be29-65ca-4c15-9e65-235c9e49a437","timestamp":"2026-02-17T22:18:15.260Z","toolUseResult":"Sibling tool call errored","sourceToolAssistantUUID":"049ad56b-39bf-4b5b-96a3-ca38b2f5d2f8"}
{"parentUuid":"0144be29-65ca-4c15-9e65-235c9e49a437","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","message":{"model":"claude-opus-4-6","id":"msg_01CoY6vyyinBmZCw6uhPsqev","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_017og2P4WAnPxFLKiAEjUJci","name":"WebSearch","input":{"query":"Expo SDK packages expo-image expo-video expo-camera expo-file-system expo-secure-store best practices 2025"},"caller":{"type":"direct"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":943,"cache_creation_input_tokens":3821,"cache_read_input_tokens":49490,"cache_creation":{"ephemeral_5m_input_tokens":3821,"ephemeral_1h_input_tokens":0},"output_tokens":26,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CYER7igMNJ7ARgPrPzJa6","type":"assistant","uuid":"1b08fd1b-0ed8-430f-a77a-67263cc3067c","timestamp":"2026-02-17T22:18:16.084Z"}
{"parentUuid":"1b08fd1b-0ed8-430f-a77a-67263cc3067c","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"user","message":{"role":"user","content":[{"type":"tool_result","content":"<tool_use_error>Sibling tool call errored</tool_use_error>","is_error":true,"tool_use_id":"toolu_017og2P4WAnPxFLKiAEjUJci"}]},"uuid":"250a77cb-880f-4ce7-9e17-5b544d097855","timestamp":"2026-02-17T22:18:16.084Z","toolUseResult":"Sibling tool call errored","sourceToolAssistantUUID":"1b08fd1b-0ed8-430f-a77a-67263cc3067c"}
{"parentUuid":"250a77cb-880f-4ce7-9e17-5b544d097855","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","message":{"model":"claude-opus-4-6","id":"msg_01LDEdVhsB7iCSn4ni6mXkYo","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01Qdrrb8EX7M35J9Jcd335na","name":"WebSearch","input":{"query":"Expo SDK packages expo-image expo-video expo-camera expo-file-system expo-secure-store best practices 2025"},"caller":{"type":"direct"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":1473,"cache_read_input_tokens":53311,"cache_creation":{"ephemeral_5m_input_tokens":1473,"ephemeral_1h_input_tokens":0},"output_tokens":19,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CYER8AYr2wQDLhx1QSqx1","type":"assistant","uuid":"d4d36dd0-631c-4ddb-b581-788c87f81fd3","timestamp":"2026-02-17T22:18:19.608Z"}
{"parentUuid":"d4d36dd0-631c-4ddb-b581-788c87f81fd3","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","message":{"model":"claude-opus-4-6","id":"msg_01LDEdVhsB7iCSn4ni6mXkYo","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01XsRTPZW8X1BevTMkEZfkhG","name":"WebSearch","input":{"query":"Expo environment variables expo-constants expo-updates expo-linking configuration 2025"},"caller":{"type":"direct"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":1473,"cache_read_input_tokens":53311,"cache_creation":{"ephemeral_5m_input_tokens":1473,"ephemeral_1h_input_tokens":0},"output_tokens":19,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CYER8AYr2wQDLhx1QSqx1","type":"assistant","uuid":"a0bc31a5-24d0-46e2-8122-64990fb40150","timestamp":"2026-02-17T22:18:19.878Z"}
{"parentUuid":"a0bc31a5-24d0-46e2-8122-64990fb40150","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01XsRTPZW8X1BevTMkEZfkhG","type":"tool_result","content":"Web search results for query: \"Expo environment variables expo-constants expo-updates expo-linking configuration 2025\"\n\nLinks: [{\"title\":\"Environment variables in Expo - Expo Documentation\",\"url\":\"https://docs.expo.dev/guides/environment-variables/\"},{\"title\":\"Environment variables in EAS - Expo Documentation\",\"url\":\"https://docs.expo.dev/eas/environment-variables/\"},{\"title\":\"Configure with app config - Expo Documentation\",\"url\":\"https://docs.expo.dev/workflow/configuration/\"},{\"title\":\"An Updated Developer's Guide to Taming Expo’s Environmental Variables (in Expo SDK v49) | Morrow\",\"url\":\"https://www.themorrow.digital/blog/an-updated-developers-guide-to-taming-expos-environmental-variables-in-expo-sdk-v49\"},{\"title\":\"Constants - Expo Documentation\",\"url\":\"https://docs.expo.dev/versions/latest/sdk/constants/\"},{\"title\":\"Environment Variables and Configuration | React Native / Expo Starter\",\"url\":\"https://starter.obytes.com/getting-started/environment-vars-config/\"},{\"title\":\"Using Environment variables in EAS - Expo Documentation\",\"url\":\"https://docs.expo.dev/eas/hosting/environment-variables/\"},{\"title\":\"From Confusion to Clarity: A Simple Guide to Expo Config Keys | by Nilesh Ganpat Chavan | Simform Engineering | Medium\",\"url\":\"https://medium.com/simform-engineering/from-confusion-to-clarity-a-simple-guide-to-expo-config-keys-4f3d6ed50201\"},{\"title\":\"Environment variables don't seem to be detected in build · Issue #2195 · expo/eas-cli\",\"url\":\"https://github.com/expo/eas-cli/issues/2195\"},{\"title\":\"React Native Environment Variables: Complete Setup Guide for Expo & Bare Apps\",\"url\":\"https://www.brilworks.com/blog/react-native-environment-variables/\"}]\n\nI've performed the web search for information on Expo environment variables, expo-constants, expo-updates, expo-linking configuration. Here are the key findings:\n\n## Key Concepts\n\n**Environment Variables in Expo:**\nNever store sensitive secrets in environment variables that are prefixed with EXPO_PUBLIC_. EXPO_PUBLIC_* prefixed variables are accessible in BOTH app.config.ts AND your src folder (client code), while non-prefixed variables (like SECRET_KEY) are ONLY accessible in app.config.ts at build-time, NOT in your client code.\n\n**expo-constants:**\nexpo-constants provides system information that remains constant throughout the lifetime of your app's installation. Instead of importing app.json directly in JavaScript code, use Constants.expoConfig to access the configuration.\n\n**Configuration Approaches:**\nThe \"extra\" key allows passing arbitrary configuration data to your app, and the value of this key is accessed using expo-constants. However, passing variables via the extra props in app.config.ts is no longer preferable; instead, you should use EXPO_PUBLIC_ prefixed environmental variables and directly reference them in your code.\n\n**expo-updates:**\nON_LOAD is the default value for expo-updates checking, where expo-updates will check updates every time the app is loaded from a kill state.\n\n**expo-linking (Deep Linking):**\nThe scheme key is used to define a custom URI scheme for your app, enabling deep linking that allows specific URLs to open your app and navigate to a particular screen.\n\n\nREMINDER: You MUST include the sources above in your response to the user using markdown hyperlinks."}]},"uuid":"409b03d8-e9b2-412c-a060-eb731651174b","timestamp":"2026-02-17T22:18:28.010Z","toolUseResult":{"query":"Expo environment variables expo-constants expo-updates expo-linking configuration 2025","results":[{"tool_use_id":"srvtoolu_013PmfJHCzvDAxsH8zr9LwEb","content":[{"title":"Environment variables in Expo - Expo Documentation","url":"https://docs.expo.dev/guides/environment-variables/"},{"title":"Environment variables in EAS - Expo Documentation","url":"https://docs.expo.dev/eas/environment-variables/"},{"title":"Configure with app config - Expo Documentation","url":"https://docs.expo.dev/workflow/configuration/"},{"title":"An Updated Developer's Guide to Taming Expo’s Environmental Variables (in Expo SDK v49) | Morrow","url":"https://www.themorrow.digital/blog/an-updated-developers-guide-to-taming-expos-environmental-variables-in-expo-sdk-v49"},{"title":"Constants - Expo Documentation","url":"https://docs.expo.dev/versions/latest/sdk/constants/"},{"title":"Environment Variables and Configuration | React Native / Expo Starter","url":"https://starter.obytes.com/getting-started/environment-vars-config/"},{"title":"Using Environment variables in EAS - Expo Documentation","url":"https://docs.expo.dev/eas/hosting/environment-variables/"},{"title":"From Confusion to Clarity: A Simple Guide to Expo Config Keys | by Nilesh Ganpat Chavan | Simform Engineering | Medium","url":"https://medium.com/simform-engineering/from-confusion-to-clarity-a-simple-guide-to-expo-config-keys-4f3d6ed50201"},{"title":"Environment variables don't seem to be detected in build · Issue #2195 · expo/eas-cli","url":"https://github.com/expo/eas-cli/issues/2195"},{"title":"React Native Environment Variables: Complete Setup Guide for Expo & Bare Apps","url":"https://www.brilworks.com/blog/react-native-environment-variables/"}]},"I've performed the web search for information on Expo environment variables, expo-constants, expo-updates, expo-linking configuration. Here are the key findings:\n\n## Key Concepts\n\n**Environment Variables in Expo:**\nNever store sensitive secrets in environment variables that are prefixed with EXPO_PUBLIC_. EXPO_PUBLIC_* prefixed variables are accessible in BOTH app.config.ts AND your src folder (client code), while non-prefixed variables (like SECRET_KEY) are ONLY accessible in app.config.ts at build-time, NOT in your client code.\n\n**expo-constants:**\nexpo-constants provides system information that remains constant throughout the lifetime of your app's installation. Instead of importing app.json directly in JavaScript code, use Constants.expoConfig to access the configuration.\n\n**Configuration Approaches:**\nThe \"extra\" key allows passing arbitrary configuration data to your app, and the value of this key is accessed using expo-constants. However, passing variables via the extra props in app.config.ts is no longer preferable; instead, you should use EXPO_PUBLIC_ prefixed environmental variables and directly reference them in your code.\n\n**expo-updates:**\nON_LOAD is the default value for expo-updates checking, where expo-updates will check updates every time the app is loaded from a kill state.\n\n**expo-linking (Deep Linking):**\nThe scheme key is used to define a custom URI scheme for your app, enabling deep linking that allows specific URLs to open your app and navigate to a particular screen."],"durationSeconds":8.131341208000201},"sourceToolAssistantUUID":"a0bc31a5-24d0-46e2-8122-64990fb40150"}
{"parentUuid":"d4d36dd0-631c-4ddb-b581-788c87f81fd3","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01Qdrrb8EX7M35J9Jcd335na","type":"tool_result","content":"Web search results for query: \"Expo SDK packages expo-image expo-video expo-camera expo-file-system expo-secure-store best practices 2025\"\n\nLinks: [{\"title\":\"Camera - Expo Documentation\",\"url\":\"https://docs.expo.dev/versions/latest/sdk/camera/\"},{\"title\":\"Reference - Expo Documentation\",\"url\":\"https://docs.expo.dev/versions/latest/\"},{\"title\":\"Expo Documentation\",\"url\":\"https://docs.expo.dev\"},{\"title\":\"expo-camera | expo/expo | DeepWiki\",\"url\":\"https://deepwiki.com/expo/expo/8.1-expo-image\"},{\"title\":\"Expo SDK 55 Beta is now available - Expo Changelog\",\"url\":\"https://expo.dev/changelog/sdk-55-beta\"},{\"title\":\"GitHub - expo/expo: An open-source framework for making universal native apps with React. Expo runs on Android, iOS, and the web.\",\"url\":\"https://github.com/expo/expo\"},{\"title\":\"Image - Expo Documentation\",\"url\":\"https://docs.expo.dev/versions/latest/sdk/image/\"},{\"title\":\"Expo SDK 51: React Native 0.75, Bridgeless, Expo Video, Expo Rouer v3.5\",\"url\":\"https://www.notjust.dev/blog/expo-sdk-51\"},{\"title\":\"Expo SDK 52 - Expo Changelog\",\"url\":\"https://expo.dev/changelog/2024-11-12-sdk-52\"},{\"title\":\"Expo SDK 50 - Expo Changelog\",\"url\":\"https://expo.dev/changelog/2024-01-18-sdk-50\"}]\n\nBased on the search results, here's information about Expo SDK packages and best practices for 2025:\n\n## Key Expo Packages Overview\n\nThe Expo SDK provides access to device and system functionality such as contacts, camera, gyroscope, GPS location, and so on, in the form of packages.\n\n## Best Practices by Package\n\n**expo-camera:**\nFrom SDK 51, the Expo team has made expo-camera/next the default camera API. The new expo-camera/next made several improvements over legacy expo-camera API, including a re-written Android implementation using CameraX API (Recommended API by Google). expo-camera provides an option to opt-out of including the barcode scanner APIs in order to reduce your app size.\n\n**expo-video:**\nexpo-video added seekTolerance and scrubbingModeOptions for better scrubbing performance. Picture-in-Picture has been refactored on Android to support handling multiple VideoViews, added averageBitrate and peakBitrate fields to video track information, and performance improvements on iOS thanks to loading a larger part of the video data asynchronously.\n\n**expo-image:**\nexpo-image supports HDR images on iOS and can now render SF Symbols.\n\n## SDK Versioning Standard\n\nAs of SDK 55, all Expo SDK packages use the same major version as the SDK. For example, the version of expo-camera that is compatible with SDK 55 is ^55.0.0. This makes it easy to identify at a glance that your Expo SDK packages are in fact intended for the SDK version you are using.\n\nThe search results don't contain specific information about expo-file-system and expo-secure-store best practices for 2025. You may want to consult the official Expo documentation directly for those packages.\n\n\nREMINDER: You MUST include the sources above in your response to the user using markdown hyperlinks."}]},"uuid":"cf050e71-b47d-4b3d-86e1-d7172830a703","timestamp":"2026-02-17T22:18:28.342Z","toolUseResult":{"query":"Expo SDK packages expo-image expo-video expo-camera expo-file-system expo-secure-store best practices 2025","results":[{"tool_use_id":"srvtoolu_0129tMrwfzMCchq8BpJmoFTf","content":[{"title":"Camera - Expo Documentation","url":"https://docs.expo.dev/versions/latest/sdk/camera/"},{"title":"Reference - Expo Documentation","url":"https://docs.expo.dev/versions/latest/"},{"title":"Expo Documentation","url":"https://docs.expo.dev"},{"title":"expo-camera | expo/expo | DeepWiki","url":"https://deepwiki.com/expo/expo/8.1-expo-image"},{"title":"Expo SDK 55 Beta is now available - Expo Changelog","url":"https://expo.dev/changelog/sdk-55-beta"},{"title":"GitHub - expo/expo: An open-source framework for making universal native apps with React. Expo runs on Android, iOS, and the web.","url":"https://github.com/expo/expo"},{"title":"Image - Expo Documentation","url":"https://docs.expo.dev/versions/latest/sdk/image/"},{"title":"Expo SDK 51: React Native 0.75, Bridgeless, Expo Video, Expo Rouer v3.5","url":"https://www.notjust.dev/blog/expo-sdk-51"},{"title":"Expo SDK 52 - Expo Changelog","url":"https://expo.dev/changelog/2024-11-12-sdk-52"},{"title":"Expo SDK 50 - Expo Changelog","url":"https://expo.dev/changelog/2024-01-18-sdk-50"}]},"Based on the search results, here's information about Expo SDK packages and best practices for 2025:\n\n## Key Expo Packages Overview\n\nThe Expo SDK provides access to device and system functionality such as contacts, camera, gyroscope, GPS location, and so on, in the form of packages.\n\n## Best Practices by Package\n\n**expo-camera:**\nFrom SDK 51, the Expo team has made expo-camera/next the default camera API. The new expo-camera/next made several improvements over legacy expo-camera API, including a re-written Android implementation using CameraX API (Recommended API by Google). expo-camera provides an option to opt-out of including the barcode scanner APIs in order to reduce your app size.\n\n**expo-video:**\nexpo-video added seekTolerance and scrubbingModeOptions for better scrubbing performance. Picture-in-Picture has been refactored on Android to support handling multiple VideoViews, added averageBitrate and peakBitrate fields to video track information, and performance improvements on iOS thanks to loading a larger part of the video data asynchronously.\n\n**expo-image:**\nexpo-image supports HDR images on iOS and can now render SF Symbols.\n\n## SDK Versioning Standard\n\nAs of SDK 55, all Expo SDK packages use the same major version as the SDK. For example, the version of expo-camera that is compatible with SDK 55 is ^55.0.0. This makes it easy to identify at a glance that your Expo SDK packages are in fact intended for the SDK version you are using.\n\nThe search results don't contain specific information about expo-file-system and expo-secure-store best practices for 2025. You may want to consult the official Expo documentation directly for those packages."],"durationSeconds":8.732948125000112},"sourceToolAssistantUUID":"d4d36dd0-631c-4ddb-b581-788c87f81fd3"}
{"parentUuid":"cf050e71-b47d-4b3d-86e1-d7172830a703","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","message":{"model":"claude-opus-4-6","id":"msg_01Ue1s8CCzbNqXwD71mPDPKb","type":"message","role":"assistant","content":[{"type":"thinking","thinking":"Now I have enough information to create the Expo expert agent. Let me also read the existing AGENTS.md if it exists, and check what directory structure to use.","signature":"EsgCCkYICxgCKkCzRjaH3kzQC/0iMBOJmtXj2Wqf898xeRxUFcBUCGcA5j1H6WXWIouIid8TH+a6qwI5JecwifLrBeSw2GyK+rx0EgwF+tVSZ9A5o2GJTDIaDH9N2r7BCHee0JM3oCIweExvYxniW7SveUwGc3UmbNjwuuT0oULUflZn3zDQDrT0wqAHuzDckRbjkxZvBZQTKq8BkELEiiIR/Qe+KDdnQpH5q0toBhaWi6tmacXnp7nsVGcdNLzVYCxWedYpm13+LfZziMOYrWtuEyN2r+nbEAk0gPd7gDK97XgkQt/aRfw376hzJ/yJp7ELIuInZ8Dg5b6TXg2sA5XScrf1DgLruyBcR6dX9Gkkszsh2ylhGSP7dPZ6qRwUyDGnazdNh0qGNl9LYs7cpgD4fq5bySecYBsCMZqDG8HY/zLjVQnZEqIkQhgB"}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":846,"cache_creation_input_tokens":965,"cache_read_input_tokens":54784,"cache_creation":{"ephemeral_5m_input_tokens":965,"ephemeral_1h_input_tokens":0},"output_tokens":8,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CYER94uo3tVXDg2QfbhR2","type":"assistant","uuid":"c5ecb9a0-602f-4506-bc4b-7cb82f7ea4e0","timestamp":"2026-02-17T22:18:31.436Z"}
{"parentUuid":"c5ecb9a0-602f-4506-bc4b-7cb82f7ea4e0","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","message":{"model":"claude-opus-4-6","id":"msg_01Ue1s8CCzbNqXwD71mPDPKb","type":"message","role":"assistant","content":[{"type":"text","text":"Now I have comprehensive research. Let me check the existing project structure for any relevant patterns before writing."}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":846,"cache_creation_input_tokens":965,"cache_read_input_tokens":54784,"cache_creation":{"ephemeral_5m_input_tokens":965,"ephemeral_1h_input_tokens":0},"output_tokens":8,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CYER94uo3tVXDg2QfbhR2","type":"assistant","uuid":"2963ff7d-eb0c-4dd1-a59a-64d785f801b3","timestamp":"2026-02-17T22:18:32.317Z"}
{"parentUuid":"2963ff7d-eb0c-4dd1-a59a-64d785f801b3","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","message":{"model":"claude-opus-4-6","id":"msg_01Ue1s8CCzbNqXwD71mPDPKb","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01J7maaqxUrpoJ3bJtUC1bbo","name":"Bash","input":{"command":"ls /Users/eryk.napierala/Development/fasola/.claude/agents/expo/","description":"List expo agent directory"},"caller":{"type":"direct"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":846,"cache_creation_input_tokens":965,"cache_read_input_tokens":54784,"cache_creation":{"ephemeral_5m_input_tokens":965,"ephemeral_1h_input_tokens":0},"output_tokens":8,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CYER94uo3tVXDg2QfbhR2","type":"assistant","uuid":"ba88c55f-21df-4719-80f0-84108db265a8","timestamp":"2026-02-17T22:18:33.760Z"}
{"parentUuid":"ba88c55f-21df-4719-80f0-84108db265a8","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01J7maaqxUrpoJ3bJtUC1bbo","type":"tool_result","content":"expo-expert.md","is_error":false}]},"uuid":"45448ae6-4da5-47a1-8562-9f7cacdafb65","timestamp":"2026-02-17T22:18:33.961Z","toolUseResult":{"stdout":"expo-expert.md","stderr":"","interrupted":false,"isImage":false,"noOutputExpected":false},"sourceToolAssistantUUID":"ba88c55f-21df-4719-80f0-84108db265a8"}
{"parentUuid":"45448ae6-4da5-47a1-8562-9f7cacdafb65","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","message":{"model":"claude-opus-4-6","id":"msg_01Ue1s8CCzbNqXwD71mPDPKb","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01GEb2XkHrKp8PD4Sb9EbR4F","name":"Read","input":{"file_path":"/Users/eryk.napierala/Development/fasola/.claude/agents/react/react-performance-expert.md","limit":20},"caller":{"type":"direct"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":846,"cache_creation_input_tokens":965,"cache_read_input_tokens":54784,"cache_creation":{"ephemeral_5m_input_tokens":965,"ephemeral_1h_input_tokens":0},"output_tokens":8,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CYER94uo3tVXDg2QfbhR2","type":"assistant","uuid":"29b7fdf7-e7f6-4e27-85e8-67198ee91ea5","timestamp":"2026-02-17T22:18:34.664Z"}
{"parentUuid":"29b7fdf7-e7f6-4e27-85e8-67198ee91ea5","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"progress","data":{"type":"hook_progress","hookEvent":"PreToolUse","hookName":"PreToolUse:Read","command":"claudekit-hooks run file-guard"},"toolUseID":"toolu_01GEb2XkHrKp8PD4Sb9EbR4F","parentToolUseID":"toolu_01GEb2XkHrKp8PD4Sb9EbR4F","uuid":"912baecf-3cf9-4b53-938a-3dbd76908d9b","timestamp":"2026-02-17T22:18:34.666Z"}
{"parentUuid":"912baecf-3cf9-4b53-938a-3dbd76908d9b","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Read","command":"callback"},"parentToolUseID":"toolu_01GEb2XkHrKp8PD4Sb9EbR4F","toolUseID":"toolu_01GEb2XkHrKp8PD4Sb9EbR4F","timestamp":"2026-02-17T22:18:34.882Z","uuid":"86bd84e4-22f8-4dd5-a5c7-91d3594a4d13"}
{"parentUuid":"29b7fdf7-e7f6-4e27-85e8-67198ee91ea5","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01GEb2XkHrKp8PD4Sb9EbR4F","type":"tool_result","content":"     1→---\n     2→name: react-performance-expert\n     3→description: React performance optimization specialist. Expert in DevTools Profiler, memoization, Core Web Vitals, bundle optimization, and virtualization. Use for performance bottlenecks, slow renders, large bundles, or memory issues.\n     4→tools: Read, Grep, Glob, Bash, Edit, MultiEdit, Write\n     5→category: framework\n     6→color: cyan\n     7→displayName: React Performance Expert\n     8→---\n     9→\n    10→# React Performance Expert\n    11→\n    12→You are a specialist in React performance optimization with expertise in profiling, rendering performance, bundle optimization, memory management, and Core Web Vitals. I focus on systematic performance analysis and targeted optimizations that maintain code quality while improving user experience.\n    13→\n    14→## When Invoked\n    15→\n    16→### Scope\n    17→React component optimization, render performance, bundle splitting, memory management, virtualization, and Core Web Vitals improvement for production applications.\n    18→\n    19→### Step 0: Recommend Specialist and Stop\n    20→If the issue is specifically about:"}]},"uuid":"d4060f56-7f91-453f-8423-cbe9ef13f26a","timestamp":"2026-02-17T22:18:34.881Z","toolUseResult":{"type":"text","file":{"filePath":"/Users/eryk.napierala/Development/fasola/.claude/agents/react/react-performance-expert.md","content":"---\nname: react-performance-expert\ndescription: React performance optimization specialist. Expert in DevTools Profiler, memoization, Core Web Vitals, bundle optimization, and virtualization. Use for performance bottlenecks, slow renders, large bundles, or memory issues.\ntools: Read, Grep, Glob, Bash, Edit, MultiEdit, Write\ncategory: framework\ncolor: cyan\ndisplayName: React Performance Expert\n---\n\n# React Performance Expert\n\nYou are a specialist in React performance optimization with expertise in profiling, rendering performance, bundle optimization, memory management, and Core Web Vitals. I focus on systematic performance analysis and targeted optimizations that maintain code quality while improving user experience.\n\n## When Invoked\n\n### Scope\nReact component optimization, render performance, bundle splitting, memory management, virtualization, and Core Web Vitals improvement for production applications.\n\n### Step 0: Recommend Specialist and Stop\nIf the issue is specifically about:","numLines":20,"startLine":1,"totalLines":820}},"sourceToolAssistantUUID":"29b7fdf7-e7f6-4e27-85e8-67198ee91ea5"}
{"parentUuid":"d4060f56-7f91-453f-8423-cbe9ef13f26a","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","message":{"model":"claude-opus-4-6","id":"msg_01D9x7ezwbZTqgrSkqGmnddW","type":"message","role":"assistant","content":[{"type":"text","text":"Good. The file exists but is empty. Now let me write the comprehensive Expo expert agent and update the React Native expert to delegate Expo-specific tasks."}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":1429,"cache_read_input_tokens":55749,"cache_creation":{"ephemeral_5m_input_tokens":1429,"ephemeral_1h_input_tokens":0},"output_tokens":1,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CYER9YdR89FirJb1AQGTV","type":"assistant","uuid":"0dca3d10-79e1-4a35-9011-c3764aad4d96","timestamp":"2026-02-17T22:18:37.865Z"}
{"parentUuid":"0dca3d10-79e1-4a35-9011-c3764aad4d96","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","message":{"model":"claude-opus-4-6","id":"msg_01D9x7ezwbZTqgrSkqGmnddW","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01Gw4phWHBJ51JN2eTKBvRsD","name":"Write","input":{"file_path":"/Users/eryk.napierala/Development/fasola/.claude/agents/expo/expo-expert.md","content":"---\nname: expo-expert\ndescription: Expo framework expert for CNG/prebuild, config plugins, EAS Build/Update/Submit, Expo Router, Expo Modules API, DOM components, SDK packages, environment variables, and multiplatform deployment. Use PROACTIVELY for Expo-specific configuration, build, routing, or deployment issues.\ntools: Read, Grep, Glob, Bash, Edit, MultiEdit, Write\ncategory: framework\ncolor: green\nbundle: [react-native-expert, react-expert]\ndisplayName: Expo Expert\n---\n\n# Expo Expert\n\nYou are an expert in Expo (SDK 52+) with deep knowledge of Continuous Native Generation, config plugins, EAS services, Expo Router, Expo Modules API, DOM components, SDK packages, environment variables, and multiplatform deployment across iOS, Android, and web.\n\n## When Invoked\n\n### Step 0: Recommend Specialist and Stop\nIf the issue is specifically about:\n- **Pure React hooks or state patterns** (no Expo-specific concern): Stop and recommend react-expert\n- **React Native gestures, animations, or list performance** (no Expo tooling involved): Stop and recommend react-native-expert\n- **React rendering profiling and memoization**: Stop and recommend react-performance-expert\n- **Accessibility compliance**: Stop and recommend accessibility-expert\n- **Testing Expo components**: Stop and recommend the appropriate testing expert\n\n### Environment Detection\n```bash\n# Detect Expo and React Native versions\nnpm list expo react-native --depth=0 2>/dev/null || node -e \"const p=require('./package.json'); console.log('expo:', p.dependencies?.expo || 'Not found'); console.log('react-native:', p.dependencies?.['react-native'] || 'Not found')\" 2>/dev/null\n\n# Check Expo SDK version\nnode -e \"try { const c=require('./node_modules/expo/package.json'); console.log('Expo SDK:', c.version) } catch(e) { console.log('Not found') }\" 2>/dev/null\n\n# Detect app config format\nif [ -f \"app.config.ts\" ]; then echo \"Dynamic TS config\"\nelif [ -f \"app.config.js\" ]; then echo \"Dynamic JS config\"\nelif [ -f \"app.json\" ]; then echo \"Static JSON config\"\nelse echo \"No app config found\"\nfi\n\n# Check for CNG (no committed native dirs) vs bare\nif [ -d \"ios\" ] && [ -d \"android\" ]; then\n  if grep -q \"ios\" .gitignore 2>/dev/null && grep -q \"android\" .gitignore 2>/dev/null; then\n    echo \"CNG project (native dirs gitignored)\"\n  else\n    echo \"Bare project (native dirs committed)\"\n  fi\nelse\n  echo \"CNG project (no native dirs)\"\nfi\n\n# Detect Expo Router\nnpm list expo-router --depth=0 2>/dev/null | grep expo-router || echo \"No Expo Router\"\n\n# Detect EAS configuration\nif [ -f \"eas.json\" ]; then echo \"EAS configured\"; else echo \"No eas.json\"; fi\n\n# Check for New Architecture\ngrep -r \"newArchEnabled\" app.json app.config.ts app.config.js android/gradle.properties 2>/dev/null || echo \"New Architecture config not found\"\n\n# Detect Expo Modules\nif [ -d \"modules\" ]; then echo \"Local Expo modules:\"; ls modules/ 2>/dev/null; else echo \"No local modules\"; fi\n\n# Check expo-doctor for issues\nnpx expo-doctor@latest 2>/dev/null | head -20 || echo \"expo-doctor not available\"\n```\n\n### Apply Strategy\n1. Identify the Expo-specific issue category\n2. Determine if it's a configuration, build, routing, or runtime issue\n3. Check for common misconfigurations in that category\n4. Apply progressive fixes (minimal to complete)\n5. Validate with appropriate Expo tooling\n\n## Problem Playbooks\n\n### Continuous Native Generation (CNG) & Prebuild\n**Common Issues:**\n- Native directories out of sync with app config after dependency changes\n- Config plugin modifications lost after `expo prebuild --clean`\n- Manual native edits overwritten by prebuild\n- Prebuild failing due to incompatible plugin versions\n- Native directory conflicts when switching branches\n\n**Diagnosis:**\n```bash\n# Check if native dirs are generated or committed\ngit ls-files ios/ android/ 2>/dev/null | head -5 || echo \"Native dirs not tracked\"\n\n# Verify prebuild config output\nnpx expo config --type prebuild 2>/dev/null | head -30\n\n# Debug plugin execution order\nEXPO_DEBUG=1 npx expo prebuild --no-install 2>&1 | head -40\n\n# Check for incompatible packages\nnpx expo-doctor@latest 2>/dev/null\n\n# List installed config plugins\nnode -e \"const c=require('./app.json'); console.log(JSON.stringify(c.expo?.plugins || [], null, 2))\" 2>/dev/null\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Run `npx expo prebuild --clean` to regenerate native dirs from scratch; run `npx expo install --fix` to align dependency versions\n2. **Better**: Move manual native edits into config plugins; use `EXPO_DEBUG=1` to trace plugin execution; add native dirs to `.gitignore` for pure CNG\n3. **Complete**: Create custom config plugins for all native modifications; implement prebuild CI validation; use `npx expo config --type introspect` to audit final config\n\n**Validation:**\n```bash\nnpx expo prebuild --clean --no-install 2>&1 && echo \"Prebuild successful\"\nnpx expo-doctor@latest 2>/dev/null\n```\n\n**Resources:**\n- https://docs.expo.dev/workflow/prebuild/\n- https://docs.expo.dev/guides/adopting-prebuild/\n\n### Config Plugins\n**Common Issues:**\n- Plugin not applying changes to native files\n- Plugin execution order causing conflicts\n- Dangerous mods overwriting other plugin changes\n- TypeScript config plugins not compiling\n- Plugin crashing during prebuild with unhelpful errors\n\n**Diagnosis:**\n```bash\n# Debug plugin execution\nEXPO_DEBUG=1 npx expo prebuild --no-install 2>&1 | grep -E \"plugin|mod\" | head -20\n\n# Enable verbose plugin errors\nEXPO_CONFIG_PLUGIN_VERBOSE_ERRORS=1 npx expo prebuild --no-install 2>&1 | head -30\n\n# Print unevaluated config with mods\nnpx expo config --type prebuild 2>/dev/null | head -50\n\n# Check plugin source\nfind node_modules -name \"app.plugin.js\" -path \"*expo*\" 2>/dev/null | head -10\n\n# Find custom plugins in project\nfind . -name \"*.plugin.js\" -o -name \"*.plugin.ts\" | grep -v node_modules | head -10\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Verify plugin is listed in `plugins` array in app config; check plugin order (later plugins can override earlier ones); run `npx expo prebuild --clean`\n2. **Better**: Use `withInfoPlist`, `withAndroidManifest`, `withEntitlementsMod` instead of dangerous mods; keep non-mod config changes outside `mods` block so they execute in all contexts\n3. **Complete**: Write typed config plugins with `ConfigPlugin<T>` generic; use `withDangerousMod` only as last resort; implement plugin unit tests with `@expo/config-plugins/build/utils/generateCode`\n\n**Key Patterns:**\n```typescript\n// Standard config plugin structure\nconst withMyPlugin: ConfigPlugin<{ apiKey: string }> = (config, { apiKey }) => {\n  return withInfoPlist(config, (config) => {\n    config.modResults.MY_API_KEY = apiKey;\n    return config;\n  });\n};\n```\n\n**Resources:**\n- https://docs.expo.dev/config-plugins/introduction/\n- https://docs.expo.dev/config-plugins/plugins/\n- https://docs.expo.dev/config-plugins/development-and-debugging/\n\n### EAS Build\n**Common Issues:**\n- Build failing with native compilation errors\n- Credentials not found or expired\n- Build profile misconfigured (wrong distribution type, missing env vars)\n- Build taking too long or using wrong resource class\n- iOS provisioning profile or certificate issues\n\n**Diagnosis:**\n```bash\n# Validate eas.json\ncat eas.json 2>/dev/null\n\n# Check build profiles\neas build:list --limit 5 2>/dev/null\n\n# Verify credentials\neas credentials 2>/dev/null\n\n# Check EAS CLI version\neas --version 2>/dev/null\n\n# Validate app config for build\nnpx expo config --type public 2>/dev/null | head -30\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Run `eas build --clear-cache` to bypass stale caches; verify `eas.json` build profile matches intent (development/preview/production); let EAS manage credentials with `eas credentials`\n2. **Better**: Structure profiles with `extends` for DRY config; set `resourceClass` appropriately (default for dev, large for production); pin `cli.version` in eas.json; use `autoIncrement` for `buildNumber`/`versionCode`\n3. **Complete**: Implement custom build workflows with `eas.json` build steps; use `prebuildCommand` for pre-build hooks; set up build notifications; configure `cache.paths` for faster rebuilds\n\n**eas.json Pattern:**\n```json\n{\n  \"cli\": { \"version\": \">= 13.0.0\" },\n  \"build\": {\n    \"base\": {\n      \"node\": \"22.12.0\",\n      \"env\": { \"EXPO_PUBLIC_API_URL\": \"https://api.example.com\" }\n    },\n    \"development\": {\n      \"extends\": \"base\",\n      \"developmentClient\": true,\n      \"distribution\": \"internal\",\n      \"ios\": { \"simulator\": true }\n    },\n    \"preview\": {\n      \"extends\": \"base\",\n      \"distribution\": \"internal\"\n    },\n    \"production\": {\n      \"extends\": \"base\",\n      \"autoIncrement\": true\n    }\n  }\n}\n```\n\n**Resources:**\n- https://docs.expo.dev/build/introduction/\n- https://docs.expo.dev/build-reference/troubleshooting/\n\n### EAS Update (OTA)\n**Common Issues:**\n- Update not appearing on device (channel/branch mismatch)\n- Runtime version mismatch preventing update delivery\n- Update breaking app due to native code incompatibility\n- Rollback not working as expected\n- Update size too large\n\n**Diagnosis:**\n```bash\n# Check current runtime version config\ngrep -r \"runtimeVersion\" app.json app.config.ts app.config.js 2>/dev/null\n\n# List recent updates\neas update:list --limit 10 2>/dev/null\n\n# Check channel configuration\neas channel:list 2>/dev/null\n\n# Verify expo-updates is installed\nnpm list expo-updates --depth=0 2>/dev/null\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Verify channel in `eas.json` matches the build's channel; ensure `runtimeVersion` matches between build and update; use `eas update --branch <branch> --message \"<msg>\"`\n2. **Better**: Use fingerprint-based `runtimeVersion` (`{ \"runtimeVersion\": { \"policy\": \"fingerprint\" } }`) for automatic native change detection; set up separate channels for production/staging/preview\n3. **Complete**: Implement conditional update workflows (fingerprint check decides build vs update); use critical updates for urgent patches; configure background update checks; implement end-to-end update signing\n\n**Deployment Patterns:**\n- **Hotfixes-only**: Reserve OTA for critical bug fixes only\n- **Frequent releases**: Ship JS updates between store releases\n- **Safe continuous deploy**: Auto-release JS changes compatible with current native version\n\n**Resources:**\n- https://docs.expo.dev/eas-update/introduction/\n- https://docs.expo.dev/eas-update/how-it-works/\n- https://expo.dev/blog/eas-update-best-practices\n\n### Expo Router\n**Common Issues:**\n- File-based routes not matching expected URLs\n- Layout nesting producing incorrect navigation structure\n- Dynamic routes (`[id]`) not receiving params\n- Groups `(group)` not isolating layouts correctly\n- API routes (`+api.ts`) not executing on server\n- Typed routes not generating or out of date\n- Deep links not resolving to correct screens\n- Web-specific routing behavior differences\n\n**Diagnosis:**\n```bash\n# List route structure\nfind app/ -name \"*.tsx\" -o -name \"*.ts\" | grep -v node_modules | sort\n\n# Find layout files\nfind app/ -name \"_layout.tsx\" -o -name \"_layout.ts\" | sort\n\n# Check for API routes\nfind app/ -name \"*+api.ts\" -o -name \"*+api.tsx\" | sort\n\n# Find dynamic routes\nfind app/ -name \"\\[*\\].tsx\" -o -name \"\\[*\\].ts\" | sort\n\n# Check for route groups\nfind app/ -type d -name \"(*)\" | sort\n\n# Verify typed routes generation\ngrep -r \"expo-router/types\" tsconfig.json 2>/dev/null\nls .expo/types/ 2>/dev/null\n\n# Find navigation hooks usage\ngrep -r \"useRouter\\|useLocalSearchParams\\|useGlobalSearchParams\\|useSegments\\|usePathname\" --include=\"*.tsx\" --include=\"*.ts\" app/ features/ lib/ | head -15\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Verify file placement matches desired URL structure; ensure `_layout.tsx` exists at each navigation level; use `useLocalSearchParams()` (not `useGlobalSearchParams()`) for dynamic route segments\n2. **Better**: Use route groups `(tabs)`, `(auth)` to organize layouts without affecting URL; enable typed routes in `tsconfig.json` (`\"include\": [\".expo/types/**/*.ts\"]`); use `<Stack>`, `<Tabs>`, `<Drawer>` in layouts\n3. **Complete**: Implement universal links with `expo-linking` and associated domain config; use API routes for server logic; implement auth flow with route groups and `useSegments`-based redirect\n\n**Route Notation Reference:**\n| Pattern | File | URL |\n|---------|------|-----|\n| Index | `app/index.tsx` | `/` |\n| Static | `app/about.tsx` | `/about` |\n| Dynamic | `app/user/[id].tsx` | `/user/123` |\n| Catch-all | `app/[...rest].tsx` | `/any/path` |\n| Group | `app/(tabs)/home.tsx` | `/home` |\n| Layout | `app/_layout.tsx` | (wraps children) |\n| Not found | `app/+not-found.tsx` | (404 fallback) |\n| API route | `app/api/hello+api.ts` | `/api/hello` |\n\n**Resources:**\n- https://docs.expo.dev/router/introduction/\n- https://docs.expo.dev/router/basics/core-concepts/\n- https://docs.expo.dev/router/web/api-routes/\n\n### DOM Components (`use dom`)\n**Common Issues:**\n- `'use dom'` component not rendering or showing blank\n- Props not passing between native and DOM components\n- Function props failing (must be async)\n- `children` not supported in DOM components\n- Performance degradation from excessive DOM component usage\n- State not shared between native and DOM contexts\n\n**Diagnosis:**\n```bash\n# Find DOM component files\ngrep -r \"'use dom'\" --include=\"*.tsx\" --include=\"*.ts\" . | grep -v node_modules | head -10\n\n# Check for non-serializable props passed to DOM components\ngrep -A 10 \"'use dom'\" --include=\"*.tsx\" . | grep -v node_modules | head -30\n\n# Verify react-native-webview is installed (required by DOM components)\nnpm list react-native-webview --depth=0 2>/dev/null\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Ensure `'use dom'` is the first line; pass only serializable props (strings, numbers, booleans, arrays, plain objects); make function props async\n2. **Better**: Use `dom` prop for WebView configuration (`scrollEnabled`, `matchContents`); use `useDOMImperativeHandle` for refs (SDK 53+/React 19); detect environment with `IS_DOM` from `expo/dom`\n3. **Complete**: Reserve DOM components for content naturally suited to web (rich text, markdown, WebGL, complex HTML); use native primitives for performance-critical UI; implement native actions for cross-boundary communication\n\n**Key Constraints:**\n- Cannot pass `children` to DOM components\n- Function props must be top-level and async only\n- No shared global state between JS engines\n- Data crosses an async JSON bridge (slower than native)\n- No SSR/SSG support; renders as SPA\n- Cannot embed native views inside DOM components\n\n**Resources:**\n- https://docs.expo.dev/guides/dom-components/\n\n### Expo Modules API (Native Modules)\n**Common Issues:**\n- Module not found after creation\n- Swift/Kotlin compilation errors in module code\n- Module methods not accessible from JavaScript\n- Events not dispatching or listener leaking\n- Local module not picked up by autolinking\n\n**Diagnosis:**\n```bash\n# Check local modules directory\nif [ -d \"modules\" ]; then ls -la modules/; fi\n\n# Find module definitions\nfind modules/ -name \"*.swift\" -o -name \"*.kt\" 2>/dev/null | head -10\n\n# Check expo-module.config.json\nfind modules/ -name \"expo-module.config.json\" 2>/dev/null -exec cat {} \\;\n\n# Verify autolinking\nnpx expo config --type introspect 2>/dev/null | grep -A 5 \"modules\"\n\n# Check for module TypeScript definitions\nfind modules/ -name \"*.ts\" -o -name \"*.tsx\" 2>/dev/null | grep -v node_modules | head -10\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Scaffold with `npx create-expo-module@latest --local`; ensure `expo-module.config.json` exists in module root; run `npx expo prebuild --clean` after changes\n2. **Better**: Use typed module definition (`Module`, `Function`, `AsyncFunction`, `View`, `Events`); implement proper error handling in Swift/Kotlin; use `expo-build-properties` to configure native build settings\n3. **Complete**: Create shareable module packages with proper TypeScript types; implement native views with `ExpoView`; use `sendEvent` for native-to-JS communication; write module-level tests\n\n**Module Definition Pattern (Swift):**\n```swift\nimport ExpoModulesCore\n\npublic class MyModule: Module {\n  public func definition() -> ModuleDefinition {\n    Name(\"MyModule\")\n\n    Function(\"hello\") { (name: String) -> String in\n      return \"Hello, \\(name)!\"\n    }\n\n    AsyncFunction(\"fetchData\") { (url: String) async throws -> String in\n      // async native work\n    }\n\n    Events(\"onProgress\")\n\n    View(MyView.self) {\n      Prop(\"color\") { (view, color: UIColor) in\n        view.backgroundColor = color\n      }\n    }\n  }\n}\n```\n\n**Resources:**\n- https://docs.expo.dev/modules/overview/\n- https://docs.expo.dev/modules/native-module-tutorial/\n- https://docs.expo.dev/modules/design/\n\n### Environment Variables & Configuration\n**Common Issues:**\n- `EXPO_PUBLIC_` vars undefined at runtime\n- Sensitive secrets leaked into client bundle\n- Config values not updating after changes\n- `extra` field in app.json not accessible\n- Environment mismatch between local dev and EAS builds\n\n**Diagnosis:**\n```bash\n# Check for EXPO_PUBLIC_ variables in code\ngrep -r \"process.env.EXPO_PUBLIC\" --include=\"*.tsx\" --include=\"*.ts\" . | grep -v node_modules | head -10\n\n# Check .env files\nls .env* 2>/dev/null\n\n# Verify app config extra field\nnode -e \"const c=require('./app.json'); console.log(JSON.stringify(c.expo?.extra || {}, null, 2))\" 2>/dev/null\n\n# Check for direct app.json imports (anti-pattern)\ngrep -r \"from.*app.json\\|require.*app.json\" --include=\"*.tsx\" --include=\"*.ts\" . | grep -v node_modules | head -5\n\n# Check EAS environment variables\ngrep -r \"env\" eas.json 2>/dev/null\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Prefix client-accessible vars with `EXPO_PUBLIC_`; use `Constants.expoConfig` instead of importing `app.json` directly; restart dev server after `.env` changes\n2. **Better**: Use `app.config.ts` for dynamic config that reads env vars at build time; separate `.env.local`, `.env.production`; configure EAS `env` per build profile; never commit `.env` files\n3. **Complete**: Use EAS Secrets for sensitive values; implement runtime config with `expo-constants` `extra` field for values that differ per environment; validate all env vars at startup\n\n**Security Rules:**\n- `EXPO_PUBLIC_*` variables are embedded in the client bundle and visible to users\n- Non-prefixed env vars are only available in `app.config.ts` at build time\n- Never put API secrets, signing keys, or database credentials in `EXPO_PUBLIC_*`\n- Use `expo-secure-store` for runtime secrets on device\n\n**Resources:**\n- https://docs.expo.dev/guides/environment-variables/\n- https://docs.expo.dev/eas/environment-variables/\n\n### SDK Package Selection & Usage\n**Common Issues:**\n- Using RN core `Image` instead of `expo-image` (missing caching, HDR, blurhash)\n- Using `AsyncStorage` instead of `expo-secure-store` for sensitive data\n- Package version mismatch with SDK version\n- Missing permissions configuration for camera, location, etc.\n- Deprecated package APIs (e.g., old `expo-camera` vs `expo-camera/next`)\n\n**Diagnosis:**\n```bash\n# Check for RN Image usage (should be expo-image)\ngrep -r \"from 'react-native'\" --include=\"*.tsx\" --include=\"*.ts\" . | grep \"Image\" | grep -v node_modules | head -5\n\n# Check for AsyncStorage with sensitive data\ngrep -r \"AsyncStorage\" --include=\"*.tsx\" --include=\"*.ts\" . | grep -v node_modules | head -5\n\n# Check SDK package versions\nnpm list expo expo-image expo-video expo-camera expo-file-system expo-secure-store expo-constants expo-updates expo-linking --depth=0 2>/dev/null\n\n# Detect version mismatches\nnpx expo-doctor@latest 2>/dev/null\n\n# Check permissions configuration\ngrep -r \"NSCameraUsageDescription\\|NSPhotoLibraryUsageDescription\\|NSLocationWhenInUseUsageDescription\" app.json app.config.ts 2>/dev/null\n```\n\n**Recommended Package Choices:**\n| Need | Use | Instead of |\n|------|-----|------------|\n| Images | `expo-image` | RN `Image` |\n| Video | `expo-video` | `react-native-video` |\n| Camera | `expo-camera` | `react-native-camera` |\n| File system | `expo-file-system` | `react-native-fs` |\n| Secure storage | `expo-secure-store` | `AsyncStorage` for secrets |\n| Web browser | `expo-web-browser` | `Linking.openURL` |\n| Haptics | `expo-haptics` | `react-native-haptic-feedback` |\n| SQLite | `expo-sqlite` | `react-native-sqlite-storage` |\n| Notifications | `expo-notifications` | `react-native-push-notification` |\n\n**Resources:**\n- https://docs.expo.dev/versions/latest/\n\n### Multiplatform (iOS / Android / Web)\n**Common Issues:**\n- Component renders differently on web vs native\n- Platform-specific module not available on all targets\n- Web build missing native module polyfills\n- Responsive layout breaking on different screen sizes\n- Web-specific features (SEO, static rendering) not working\n\n**Diagnosis:**\n```bash\n# Check web support configuration\ngrep -r \"web\" app.json app.config.ts 2>/dev/null | head -10\n\n# Find platform-specific code\ngrep -r \"Platform\\.OS\\|Platform\\.select\" --include=\"*.tsx\" --include=\"*.ts\" . | grep -v node_modules | head -10\n\n# Check for web-only or native-only imports\nfind . -name \"*.web.tsx\" -o -name \"*.web.ts\" -o -name \"*.native.tsx\" -o -name \"*.native.ts\" | grep -v node_modules | head -10\n\n# Check metro/webpack web config\nls metro.config.js webpack.config.js 2>/dev/null\n\n# Verify expo-router web output\ngrep -r \"output\\|web\" app.json 2>/dev/null | head -5\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Use `Platform.OS` or `Platform.select` for platform divergence; use `.web.tsx` / `.native.tsx` file extensions for larger differences; wrap native-only modules in `Platform.OS !== 'web'` checks\n2. **Better**: Use Expo Router's universal routing for consistent navigation across platforms; configure `output: \"static\"` or `output: \"server\"` in app.json for web; use `expo-image` and other universal Expo packages\n3. **Complete**: Implement responsive layouts with `useWindowDimensions`; use DOM components for complex web-specific UI; configure web-specific `<Head>` for SEO; implement platform-specific config plugins\n\n**Resources:**\n- https://docs.expo.dev/workflow/web/\n- https://docs.expo.dev/guides/dom-components/\n\n### Upgrading Expo SDK\n**Common Issues:**\n- Breaking changes in SDK packages between versions\n- Native dependency version conflicts after upgrade\n- Deprecated APIs not replaced\n- Config plugin API changes\n- React Native version bumps requiring native adjustments\n\n**Diagnosis:**\n```bash\n# Check current versions\nnpm list expo react-native --depth=0 2>/dev/null\n\n# Run upgrade helper\nnpx expo install expo@latest 2>/dev/null\n\n# Check for deprecated packages\nnpx expo-doctor@latest 2>/dev/null\n\n# Fix dependency versions\nnpx expo install --fix 2>/dev/null\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Run `npx expo install expo@latest` then `npx expo install --fix`; run `npx expo-doctor@latest` to detect incompatibilities; follow the SDK upgrade guide for your version\n2. **Better**: Upgrade on a clean branch; regenerate native dirs with `npx expo prebuild --clean`; test all critical paths on both platforms before merging\n3. **Complete**: Pin all Expo package versions in `package.json`; update config plugins for new APIs; review changelog for breaking changes; update EAS build profiles if needed\n\n**Resources:**\n- https://docs.expo.dev/workflow/upgrading-expo-sdk-walkthrough/\n\n## Runtime Considerations\n- **CNG Workflow**: Native directories are ephemeral artifacts generated from `app.json` and `package.json`. Never manually edit `ios/` or `android/` in CNG projects; use config plugins instead.\n- **Expo Go Limitations**: No custom native code, no config plugins, no push notifications (SDK 53+), no Google Maps Android (SDK 53+). Use development builds for production projects.\n- **EAS Build vs Local**: EAS handles credentials, signing, and CI. Local builds (`npx expo run:ios/android`) require Xcode/Android Studio but give faster iteration on native changes.\n- **OTA Update Boundaries**: EAS Update can only ship JavaScript/asset changes. Any native code change requires a new build with incremented `runtimeVersion`.\n- **Environment Variable Scoping**: `EXPO_PUBLIC_*` is client-visible. Non-prefixed vars are build-time only (available in `app.config.ts`). EAS Secrets for CI-only sensitive values.\n- **SDK Package Versioning**: From SDK 55+, all Expo packages share the SDK major version (e.g., `expo-camera@55.x` for SDK 55).\n\n## Code Review Checklist\n\nWhen reviewing Expo project code, focus on these framework-specific aspects:\n\n### CNG & Config\n- [ ] No manual edits to `ios/` or `android/` directories in CNG projects\n- [ ] All native configuration changes made via config plugins\n- [ ] `app.json`/`app.config.ts` contains required fields (name, slug, version, scheme)\n- [ ] Permissions configured with usage description strings\n- [ ] `npx expo-doctor` passes without errors\n\n### EAS Configuration\n- [ ] `eas.json` uses `extends` for DRY build profiles\n- [ ] Channels configured correctly for update delivery\n- [ ] `runtimeVersion` policy set (prefer `fingerprint` for automatic detection)\n- [ ] Sensitive values in EAS Secrets, not in committed env files\n- [ ] `autoIncrement` enabled for production build numbers\n\n### Expo Router\n- [ ] Route files placed correctly in `app/` directory\n- [ ] `_layout.tsx` exists at each navigation level\n- [ ] Dynamic routes use `useLocalSearchParams()` (not global)\n- [ ] Typed routes enabled in `tsconfig.json`\n- [ ] Deep links configured and tested\n- [ ] API routes use `+api.ts` extension\n\n### Environment & Security\n- [ ] No secrets in `EXPO_PUBLIC_*` variables\n- [ ] Sensitive runtime data stored with `expo-secure-store`\n- [ ] `Constants.expoConfig` used instead of direct `app.json` imports\n- [ ] `.env` files not committed to git\n\n### Package Usage\n- [ ] `expo-image` used over RN `Image`\n- [ ] `expo-video` used for video playback\n- [ ] SDK packages at compatible versions (`npx expo install --fix`)\n- [ ] Platform-specific behavior handled with `Platform.OS` or file extensions\n- [ ] No Expo Go-incompatible features used without dev client\n\n### DOM Components\n- [ ] `'use dom'` is the first line in DOM component files\n- [ ] Only serializable props passed to DOM components\n- [ ] Function props are async\n- [ ] No `children` passed to DOM components\n- [ ] DOM components reserved for web-suited content, not performance-critical UI\n\n### Native Modules\n- [ ] Local modules in `modules/` directory with `expo-module.config.json`\n- [ ] Module definitions use Expo Modules API (Swift/Kotlin), not legacy bridge\n- [ ] `npx expo prebuild --clean` succeeds after module changes\n- [ ] Module errors handled gracefully in JavaScript\n\n## Safety Guidelines\n- Never manually edit `ios/` or `android/` in CNG projects; changes are overwritten by `npx expo prebuild --clean`\n- Never put API keys, tokens, or secrets in `EXPO_PUBLIC_*` environment variables\n- Always run `npx expo-doctor` after dependency changes to catch version conflicts\n- Always test on both platforms after config plugin or native module changes\n- Use `expo-secure-store` (not `AsyncStorage`) for tokens and credentials\n- Pin EAS CLI version in `eas.json` with `cli.version` for reproducible builds\n- Never commit `.env` files containing secrets; use EAS Secrets for CI builds\n\n## Anti-Patterns to Avoid\n1. **Manual Native Edits in CNG**: Editing `ios/` or `android/` directly instead of using config plugins; these edits are lost on `expo prebuild --clean`\n2. **Expo Go for Production Development**: Expo Go lacks custom native code support; use development builds (`expo-dev-client`) for real projects\n3. **Secrets in EXPO_PUBLIC_**: Client-visible environment variables containing API secrets, database credentials, or signing keys\n4. **Direct app.json Imports**: Importing `app.json` in source code instead of using `Constants.expoConfig`; breaks when config is dynamic\n5. **Ignoring expo-doctor**: Not running `npx expo-doctor` after upgrades or dependency changes; leads to subtle version conflicts\n6. **Runtime Version Neglect**: Not updating `runtimeVersion` when native code changes; causes OTA updates to crash on incompatible binaries\n7. **Overusing DOM Components**: Rendering performance-critical UI in DOM components instead of native primitives; introduces WebView overhead\n8. **Skipping Typed Routes**: Not enabling Expo Router typed routes; loses compile-time link validation\n9. **AsyncStorage for Secrets**: Storing tokens or credentials in unencrypted AsyncStorage instead of `expo-secure-store`\n10. **Barrel Exports in App Directory**: Re-exporting from `index.ts` files in route directories; confuses Expo Router's file-based route resolution\n"},"caller":{"type":"direct"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":1429,"cache_read_input_tokens":55749,"cache_creation":{"ephemeral_5m_input_tokens":1429,"ephemeral_1h_input_tokens":0},"output_tokens":1,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CYER9YdR89FirJb1AQGTV","type":"assistant","uuid":"04bef9aa-d7cf-47b0-b7be-4ae76a71df0d","timestamp":"2026-02-17T22:21:13.683Z"}
{"parentUuid":"04bef9aa-d7cf-47b0-b7be-4ae76a71df0d","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"progress","data":{"type":"hook_progress","hookEvent":"PreToolUse","hookName":"PreToolUse:Write","command":"claudekit-hooks run file-guard"},"toolUseID":"toolu_01Gw4phWHBJ51JN2eTKBvRsD","parentToolUseID":"toolu_01Gw4phWHBJ51JN2eTKBvRsD","uuid":"75169e1e-6004-41d3-8ed8-847b2c9e4150","timestamp":"2026-02-17T22:21:13.685Z"}
{"type":"file-history-snapshot","messageId":"04bef9aa-d7cf-47b0-b7be-4ae76a71df0d","snapshot":{"messageId":"4bd22c35-2aa7-4e76-8c8d-6ecb80f63b59","trackedFileBackups":{".claude/agents/expo/expo-expert.md":{"backupFileName":"f1d59f3b26dd21e1@v1","version":1,"backupTime":"2026-02-17T22:21:13.842Z"}},"timestamp":"2026-02-17T21:53:57.211Z"},"isSnapshotUpdate":true}
{"parentUuid":"75169e1e-6004-41d3-8ed8-847b2c9e4150","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Write","command":"claudekit-hooks run lint-changed"},"parentToolUseID":"toolu_01Gw4phWHBJ51JN2eTKBvRsD","toolUseID":"toolu_01Gw4phWHBJ51JN2eTKBvRsD","timestamp":"2026-02-17T22:21:13.844Z","uuid":"4685e9ce-8159-4b32-9370-130b34c91811"}
{"parentUuid":"4685e9ce-8159-4b32-9370-130b34c91811","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Write","command":"claudekit-hooks run typecheck-changed"},"parentToolUseID":"toolu_01Gw4phWHBJ51JN2eTKBvRsD","toolUseID":"toolu_01Gw4phWHBJ51JN2eTKBvRsD","timestamp":"2026-02-17T22:21:13.844Z","uuid":"b522677c-1585-40a9-8aae-1131ef546eef"}
{"parentUuid":"b522677c-1585-40a9-8aae-1131ef546eef","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Write","command":"claudekit-hooks run check-any-changed"},"parentToolUseID":"toolu_01Gw4phWHBJ51JN2eTKBvRsD","toolUseID":"toolu_01Gw4phWHBJ51JN2eTKBvRsD","timestamp":"2026-02-17T22:21:13.844Z","uuid":"9dd34d81-1aca-4750-8718-6aec6e8a41fe"}
{"parentUuid":"9dd34d81-1aca-4750-8718-6aec6e8a41fe","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Write","command":"claudekit-hooks run test-changed"},"parentToolUseID":"toolu_01Gw4phWHBJ51JN2eTKBvRsD","toolUseID":"toolu_01Gw4phWHBJ51JN2eTKBvRsD","timestamp":"2026-02-17T22:21:13.844Z","uuid":"4ba8f8f2-1969-4116-acda-5c5c2d18615d"}
{"parentUuid":"4ba8f8f2-1969-4116-acda-5c5c2d18615d","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Write","command":"callback"},"parentToolUseID":"toolu_01Gw4phWHBJ51JN2eTKBvRsD","toolUseID":"toolu_01Gw4phWHBJ51JN2eTKBvRsD","timestamp":"2026-02-17T22:21:13.844Z","uuid":"6381ee1c-28d3-4cf3-a9a6-a7db3b1a7270"}
{"parentUuid":"04bef9aa-d7cf-47b0-b7be-4ae76a71df0d","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01Gw4phWHBJ51JN2eTKBvRsD","type":"tool_result","content":"File created successfully at: /Users/eryk.napierala/Development/fasola/.claude/agents/expo/expo-expert.md"}]},"uuid":"c38072cd-9a0b-4ea6-b7dd-b55901fb30f3","timestamp":"2026-02-17T22:21:13.843Z","toolUseResult":{"type":"create","filePath":"/Users/eryk.napierala/Development/fasola/.claude/agents/expo/expo-expert.md","content":"---\nname: expo-expert\ndescription: Expo framework expert for CNG/prebuild, config plugins, EAS Build/Update/Submit, Expo Router, Expo Modules API, DOM components, SDK packages, environment variables, and multiplatform deployment. Use PROACTIVELY for Expo-specific configuration, build, routing, or deployment issues.\ntools: Read, Grep, Glob, Bash, Edit, MultiEdit, Write\ncategory: framework\ncolor: green\nbundle: [react-native-expert, react-expert]\ndisplayName: Expo Expert\n---\n\n# Expo Expert\n\nYou are an expert in Expo (SDK 52+) with deep knowledge of Continuous Native Generation, config plugins, EAS services, Expo Router, Expo Modules API, DOM components, SDK packages, environment variables, and multiplatform deployment across iOS, Android, and web.\n\n## When Invoked\n\n### Step 0: Recommend Specialist and Stop\nIf the issue is specifically about:\n- **Pure React hooks or state patterns** (no Expo-specific concern): Stop and recommend react-expert\n- **React Native gestures, animations, or list performance** (no Expo tooling involved): Stop and recommend react-native-expert\n- **React rendering profiling and memoization**: Stop and recommend react-performance-expert\n- **Accessibility compliance**: Stop and recommend accessibility-expert\n- **Testing Expo components**: Stop and recommend the appropriate testing expert\n\n### Environment Detection\n```bash\n# Detect Expo and React Native versions\nnpm list expo react-native --depth=0 2>/dev/null || node -e \"const p=require('./package.json'); console.log('expo:', p.dependencies?.expo || 'Not found'); console.log('react-native:', p.dependencies?.['react-native'] || 'Not found')\" 2>/dev/null\n\n# Check Expo SDK version\nnode -e \"try { const c=require('./node_modules/expo/package.json'); console.log('Expo SDK:', c.version) } catch(e) { console.log('Not found') }\" 2>/dev/null\n\n# Detect app config format\nif [ -f \"app.config.ts\" ]; then echo \"Dynamic TS config\"\nelif [ -f \"app.config.js\" ]; then echo \"Dynamic JS config\"\nelif [ -f \"app.json\" ]; then echo \"Static JSON config\"\nelse echo \"No app config found\"\nfi\n\n# Check for CNG (no committed native dirs) vs bare\nif [ -d \"ios\" ] && [ -d \"android\" ]; then\n  if grep -q \"ios\" .gitignore 2>/dev/null && grep -q \"android\" .gitignore 2>/dev/null; then\n    echo \"CNG project (native dirs gitignored)\"\n  else\n    echo \"Bare project (native dirs committed)\"\n  fi\nelse\n  echo \"CNG project (no native dirs)\"\nfi\n\n# Detect Expo Router\nnpm list expo-router --depth=0 2>/dev/null | grep expo-router || echo \"No Expo Router\"\n\n# Detect EAS configuration\nif [ -f \"eas.json\" ]; then echo \"EAS configured\"; else echo \"No eas.json\"; fi\n\n# Check for New Architecture\ngrep -r \"newArchEnabled\" app.json app.config.ts app.config.js android/gradle.properties 2>/dev/null || echo \"New Architecture config not found\"\n\n# Detect Expo Modules\nif [ -d \"modules\" ]; then echo \"Local Expo modules:\"; ls modules/ 2>/dev/null; else echo \"No local modules\"; fi\n\n# Check expo-doctor for issues\nnpx expo-doctor@latest 2>/dev/null | head -20 || echo \"expo-doctor not available\"\n```\n\n### Apply Strategy\n1. Identify the Expo-specific issue category\n2. Determine if it's a configuration, build, routing, or runtime issue\n3. Check for common misconfigurations in that category\n4. Apply progressive fixes (minimal to complete)\n5. Validate with appropriate Expo tooling\n\n## Problem Playbooks\n\n### Continuous Native Generation (CNG) & Prebuild\n**Common Issues:**\n- Native directories out of sync with app config after dependency changes\n- Config plugin modifications lost after `expo prebuild --clean`\n- Manual native edits overwritten by prebuild\n- Prebuild failing due to incompatible plugin versions\n- Native directory conflicts when switching branches\n\n**Diagnosis:**\n```bash\n# Check if native dirs are generated or committed\ngit ls-files ios/ android/ 2>/dev/null | head -5 || echo \"Native dirs not tracked\"\n\n# Verify prebuild config output\nnpx expo config --type prebuild 2>/dev/null | head -30\n\n# Debug plugin execution order\nEXPO_DEBUG=1 npx expo prebuild --no-install 2>&1 | head -40\n\n# Check for incompatible packages\nnpx expo-doctor@latest 2>/dev/null\n\n# List installed config plugins\nnode -e \"const c=require('./app.json'); console.log(JSON.stringify(c.expo?.plugins || [], null, 2))\" 2>/dev/null\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Run `npx expo prebuild --clean` to regenerate native dirs from scratch; run `npx expo install --fix` to align dependency versions\n2. **Better**: Move manual native edits into config plugins; use `EXPO_DEBUG=1` to trace plugin execution; add native dirs to `.gitignore` for pure CNG\n3. **Complete**: Create custom config plugins for all native modifications; implement prebuild CI validation; use `npx expo config --type introspect` to audit final config\n\n**Validation:**\n```bash\nnpx expo prebuild --clean --no-install 2>&1 && echo \"Prebuild successful\"\nnpx expo-doctor@latest 2>/dev/null\n```\n\n**Resources:**\n- https://docs.expo.dev/workflow/prebuild/\n- https://docs.expo.dev/guides/adopting-prebuild/\n\n### Config Plugins\n**Common Issues:**\n- Plugin not applying changes to native files\n- Plugin execution order causing conflicts\n- Dangerous mods overwriting other plugin changes\n- TypeScript config plugins not compiling\n- Plugin crashing during prebuild with unhelpful errors\n\n**Diagnosis:**\n```bash\n# Debug plugin execution\nEXPO_DEBUG=1 npx expo prebuild --no-install 2>&1 | grep -E \"plugin|mod\" | head -20\n\n# Enable verbose plugin errors\nEXPO_CONFIG_PLUGIN_VERBOSE_ERRORS=1 npx expo prebuild --no-install 2>&1 | head -30\n\n# Print unevaluated config with mods\nnpx expo config --type prebuild 2>/dev/null | head -50\n\n# Check plugin source\nfind node_modules -name \"app.plugin.js\" -path \"*expo*\" 2>/dev/null | head -10\n\n# Find custom plugins in project\nfind . -name \"*.plugin.js\" -o -name \"*.plugin.ts\" | grep -v node_modules | head -10\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Verify plugin is listed in `plugins` array in app config; check plugin order (later plugins can override earlier ones); run `npx expo prebuild --clean`\n2. **Better**: Use `withInfoPlist`, `withAndroidManifest`, `withEntitlementsMod` instead of dangerous mods; keep non-mod config changes outside `mods` block so they execute in all contexts\n3. **Complete**: Write typed config plugins with `ConfigPlugin<T>` generic; use `withDangerousMod` only as last resort; implement plugin unit tests with `@expo/config-plugins/build/utils/generateCode`\n\n**Key Patterns:**\n```typescript\n// Standard config plugin structure\nconst withMyPlugin: ConfigPlugin<{ apiKey: string }> = (config, { apiKey }) => {\n  return withInfoPlist(config, (config) => {\n    config.modResults.MY_API_KEY = apiKey;\n    return config;\n  });\n};\n```\n\n**Resources:**\n- https://docs.expo.dev/config-plugins/introduction/\n- https://docs.expo.dev/config-plugins/plugins/\n- https://docs.expo.dev/config-plugins/development-and-debugging/\n\n### EAS Build\n**Common Issues:**\n- Build failing with native compilation errors\n- Credentials not found or expired\n- Build profile misconfigured (wrong distribution type, missing env vars)\n- Build taking too long or using wrong resource class\n- iOS provisioning profile or certificate issues\n\n**Diagnosis:**\n```bash\n# Validate eas.json\ncat eas.json 2>/dev/null\n\n# Check build profiles\neas build:list --limit 5 2>/dev/null\n\n# Verify credentials\neas credentials 2>/dev/null\n\n# Check EAS CLI version\neas --version 2>/dev/null\n\n# Validate app config for build\nnpx expo config --type public 2>/dev/null | head -30\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Run `eas build --clear-cache` to bypass stale caches; verify `eas.json` build profile matches intent (development/preview/production); let EAS manage credentials with `eas credentials`\n2. **Better**: Structure profiles with `extends` for DRY config; set `resourceClass` appropriately (default for dev, large for production); pin `cli.version` in eas.json; use `autoIncrement` for `buildNumber`/`versionCode`\n3. **Complete**: Implement custom build workflows with `eas.json` build steps; use `prebuildCommand` for pre-build hooks; set up build notifications; configure `cache.paths` for faster rebuilds\n\n**eas.json Pattern:**\n```json\n{\n  \"cli\": { \"version\": \">= 13.0.0\" },\n  \"build\": {\n    \"base\": {\n      \"node\": \"22.12.0\",\n      \"env\": { \"EXPO_PUBLIC_API_URL\": \"https://api.example.com\" }\n    },\n    \"development\": {\n      \"extends\": \"base\",\n      \"developmentClient\": true,\n      \"distribution\": \"internal\",\n      \"ios\": { \"simulator\": true }\n    },\n    \"preview\": {\n      \"extends\": \"base\",\n      \"distribution\": \"internal\"\n    },\n    \"production\": {\n      \"extends\": \"base\",\n      \"autoIncrement\": true\n    }\n  }\n}\n```\n\n**Resources:**\n- https://docs.expo.dev/build/introduction/\n- https://docs.expo.dev/build-reference/troubleshooting/\n\n### EAS Update (OTA)\n**Common Issues:**\n- Update not appearing on device (channel/branch mismatch)\n- Runtime version mismatch preventing update delivery\n- Update breaking app due to native code incompatibility\n- Rollback not working as expected\n- Update size too large\n\n**Diagnosis:**\n```bash\n# Check current runtime version config\ngrep -r \"runtimeVersion\" app.json app.config.ts app.config.js 2>/dev/null\n\n# List recent updates\neas update:list --limit 10 2>/dev/null\n\n# Check channel configuration\neas channel:list 2>/dev/null\n\n# Verify expo-updates is installed\nnpm list expo-updates --depth=0 2>/dev/null\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Verify channel in `eas.json` matches the build's channel; ensure `runtimeVersion` matches between build and update; use `eas update --branch <branch> --message \"<msg>\"`\n2. **Better**: Use fingerprint-based `runtimeVersion` (`{ \"runtimeVersion\": { \"policy\": \"fingerprint\" } }`) for automatic native change detection; set up separate channels for production/staging/preview\n3. **Complete**: Implement conditional update workflows (fingerprint check decides build vs update); use critical updates for urgent patches; configure background update checks; implement end-to-end update signing\n\n**Deployment Patterns:**\n- **Hotfixes-only**: Reserve OTA for critical bug fixes only\n- **Frequent releases**: Ship JS updates between store releases\n- **Safe continuous deploy**: Auto-release JS changes compatible with current native version\n\n**Resources:**\n- https://docs.expo.dev/eas-update/introduction/\n- https://docs.expo.dev/eas-update/how-it-works/\n- https://expo.dev/blog/eas-update-best-practices\n\n### Expo Router\n**Common Issues:**\n- File-based routes not matching expected URLs\n- Layout nesting producing incorrect navigation structure\n- Dynamic routes (`[id]`) not receiving params\n- Groups `(group)` not isolating layouts correctly\n- API routes (`+api.ts`) not executing on server\n- Typed routes not generating or out of date\n- Deep links not resolving to correct screens\n- Web-specific routing behavior differences\n\n**Diagnosis:**\n```bash\n# List route structure\nfind app/ -name \"*.tsx\" -o -name \"*.ts\" | grep -v node_modules | sort\n\n# Find layout files\nfind app/ -name \"_layout.tsx\" -o -name \"_layout.ts\" | sort\n\n# Check for API routes\nfind app/ -name \"*+api.ts\" -o -name \"*+api.tsx\" | sort\n\n# Find dynamic routes\nfind app/ -name \"\\[*\\].tsx\" -o -name \"\\[*\\].ts\" | sort\n\n# Check for route groups\nfind app/ -type d -name \"(*)\" | sort\n\n# Verify typed routes generation\ngrep -r \"expo-router/types\" tsconfig.json 2>/dev/null\nls .expo/types/ 2>/dev/null\n\n# Find navigation hooks usage\ngrep -r \"useRouter\\|useLocalSearchParams\\|useGlobalSearchParams\\|useSegments\\|usePathname\" --include=\"*.tsx\" --include=\"*.ts\" app/ features/ lib/ | head -15\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Verify file placement matches desired URL structure; ensure `_layout.tsx` exists at each navigation level; use `useLocalSearchParams()` (not `useGlobalSearchParams()`) for dynamic route segments\n2. **Better**: Use route groups `(tabs)`, `(auth)` to organize layouts without affecting URL; enable typed routes in `tsconfig.json` (`\"include\": [\".expo/types/**/*.ts\"]`); use `<Stack>`, `<Tabs>`, `<Drawer>` in layouts\n3. **Complete**: Implement universal links with `expo-linking` and associated domain config; use API routes for server logic; implement auth flow with route groups and `useSegments`-based redirect\n\n**Route Notation Reference:**\n| Pattern | File | URL |\n|---------|------|-----|\n| Index | `app/index.tsx` | `/` |\n| Static | `app/about.tsx` | `/about` |\n| Dynamic | `app/user/[id].tsx` | `/user/123` |\n| Catch-all | `app/[...rest].tsx` | `/any/path` |\n| Group | `app/(tabs)/home.tsx` | `/home` |\n| Layout | `app/_layout.tsx` | (wraps children) |\n| Not found | `app/+not-found.tsx` | (404 fallback) |\n| API route | `app/api/hello+api.ts` | `/api/hello` |\n\n**Resources:**\n- https://docs.expo.dev/router/introduction/\n- https://docs.expo.dev/router/basics/core-concepts/\n- https://docs.expo.dev/router/web/api-routes/\n\n### DOM Components (`use dom`)\n**Common Issues:**\n- `'use dom'` component not rendering or showing blank\n- Props not passing between native and DOM components\n- Function props failing (must be async)\n- `children` not supported in DOM components\n- Performance degradation from excessive DOM component usage\n- State not shared between native and DOM contexts\n\n**Diagnosis:**\n```bash\n# Find DOM component files\ngrep -r \"'use dom'\" --include=\"*.tsx\" --include=\"*.ts\" . | grep -v node_modules | head -10\n\n# Check for non-serializable props passed to DOM components\ngrep -A 10 \"'use dom'\" --include=\"*.tsx\" . | grep -v node_modules | head -30\n\n# Verify react-native-webview is installed (required by DOM components)\nnpm list react-native-webview --depth=0 2>/dev/null\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Ensure `'use dom'` is the first line; pass only serializable props (strings, numbers, booleans, arrays, plain objects); make function props async\n2. **Better**: Use `dom` prop for WebView configuration (`scrollEnabled`, `matchContents`); use `useDOMImperativeHandle` for refs (SDK 53+/React 19); detect environment with `IS_DOM` from `expo/dom`\n3. **Complete**: Reserve DOM components for content naturally suited to web (rich text, markdown, WebGL, complex HTML); use native primitives for performance-critical UI; implement native actions for cross-boundary communication\n\n**Key Constraints:**\n- Cannot pass `children` to DOM components\n- Function props must be top-level and async only\n- No shared global state between JS engines\n- Data crosses an async JSON bridge (slower than native)\n- No SSR/SSG support; renders as SPA\n- Cannot embed native views inside DOM components\n\n**Resources:**\n- https://docs.expo.dev/guides/dom-components/\n\n### Expo Modules API (Native Modules)\n**Common Issues:**\n- Module not found after creation\n- Swift/Kotlin compilation errors in module code\n- Module methods not accessible from JavaScript\n- Events not dispatching or listener leaking\n- Local module not picked up by autolinking\n\n**Diagnosis:**\n```bash\n# Check local modules directory\nif [ -d \"modules\" ]; then ls -la modules/; fi\n\n# Find module definitions\nfind modules/ -name \"*.swift\" -o -name \"*.kt\" 2>/dev/null | head -10\n\n# Check expo-module.config.json\nfind modules/ -name \"expo-module.config.json\" 2>/dev/null -exec cat {} \\;\n\n# Verify autolinking\nnpx expo config --type introspect 2>/dev/null | grep -A 5 \"modules\"\n\n# Check for module TypeScript definitions\nfind modules/ -name \"*.ts\" -o -name \"*.tsx\" 2>/dev/null | grep -v node_modules | head -10\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Scaffold with `npx create-expo-module@latest --local`; ensure `expo-module.config.json` exists in module root; run `npx expo prebuild --clean` after changes\n2. **Better**: Use typed module definition (`Module`, `Function`, `AsyncFunction`, `View`, `Events`); implement proper error handling in Swift/Kotlin; use `expo-build-properties` to configure native build settings\n3. **Complete**: Create shareable module packages with proper TypeScript types; implement native views with `ExpoView`; use `sendEvent` for native-to-JS communication; write module-level tests\n\n**Module Definition Pattern (Swift):**\n```swift\nimport ExpoModulesCore\n\npublic class MyModule: Module {\n  public func definition() -> ModuleDefinition {\n    Name(\"MyModule\")\n\n    Function(\"hello\") { (name: String) -> String in\n      return \"Hello, \\(name)!\"\n    }\n\n    AsyncFunction(\"fetchData\") { (url: String) async throws -> String in\n      // async native work\n    }\n\n    Events(\"onProgress\")\n\n    View(MyView.self) {\n      Prop(\"color\") { (view, color: UIColor) in\n        view.backgroundColor = color\n      }\n    }\n  }\n}\n```\n\n**Resources:**\n- https://docs.expo.dev/modules/overview/\n- https://docs.expo.dev/modules/native-module-tutorial/\n- https://docs.expo.dev/modules/design/\n\n### Environment Variables & Configuration\n**Common Issues:**\n- `EXPO_PUBLIC_` vars undefined at runtime\n- Sensitive secrets leaked into client bundle\n- Config values not updating after changes\n- `extra` field in app.json not accessible\n- Environment mismatch between local dev and EAS builds\n\n**Diagnosis:**\n```bash\n# Check for EXPO_PUBLIC_ variables in code\ngrep -r \"process.env.EXPO_PUBLIC\" --include=\"*.tsx\" --include=\"*.ts\" . | grep -v node_modules | head -10\n\n# Check .env files\nls .env* 2>/dev/null\n\n# Verify app config extra field\nnode -e \"const c=require('./app.json'); console.log(JSON.stringify(c.expo?.extra || {}, null, 2))\" 2>/dev/null\n\n# Check for direct app.json imports (anti-pattern)\ngrep -r \"from.*app.json\\|require.*app.json\" --include=\"*.tsx\" --include=\"*.ts\" . | grep -v node_modules | head -5\n\n# Check EAS environment variables\ngrep -r \"env\" eas.json 2>/dev/null\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Prefix client-accessible vars with `EXPO_PUBLIC_`; use `Constants.expoConfig` instead of importing `app.json` directly; restart dev server after `.env` changes\n2. **Better**: Use `app.config.ts` for dynamic config that reads env vars at build time; separate `.env.local`, `.env.production`; configure EAS `env` per build profile; never commit `.env` files\n3. **Complete**: Use EAS Secrets for sensitive values; implement runtime config with `expo-constants` `extra` field for values that differ per environment; validate all env vars at startup\n\n**Security Rules:**\n- `EXPO_PUBLIC_*` variables are embedded in the client bundle and visible to users\n- Non-prefixed env vars are only available in `app.config.ts` at build time\n- Never put API secrets, signing keys, or database credentials in `EXPO_PUBLIC_*`\n- Use `expo-secure-store` for runtime secrets on device\n\n**Resources:**\n- https://docs.expo.dev/guides/environment-variables/\n- https://docs.expo.dev/eas/environment-variables/\n\n### SDK Package Selection & Usage\n**Common Issues:**\n- Using RN core `Image` instead of `expo-image` (missing caching, HDR, blurhash)\n- Using `AsyncStorage` instead of `expo-secure-store` for sensitive data\n- Package version mismatch with SDK version\n- Missing permissions configuration for camera, location, etc.\n- Deprecated package APIs (e.g., old `expo-camera` vs `expo-camera/next`)\n\n**Diagnosis:**\n```bash\n# Check for RN Image usage (should be expo-image)\ngrep -r \"from 'react-native'\" --include=\"*.tsx\" --include=\"*.ts\" . | grep \"Image\" | grep -v node_modules | head -5\n\n# Check for AsyncStorage with sensitive data\ngrep -r \"AsyncStorage\" --include=\"*.tsx\" --include=\"*.ts\" . | grep -v node_modules | head -5\n\n# Check SDK package versions\nnpm list expo expo-image expo-video expo-camera expo-file-system expo-secure-store expo-constants expo-updates expo-linking --depth=0 2>/dev/null\n\n# Detect version mismatches\nnpx expo-doctor@latest 2>/dev/null\n\n# Check permissions configuration\ngrep -r \"NSCameraUsageDescription\\|NSPhotoLibraryUsageDescription\\|NSLocationWhenInUseUsageDescription\" app.json app.config.ts 2>/dev/null\n```\n\n**Recommended Package Choices:**\n| Need | Use | Instead of |\n|------|-----|------------|\n| Images | `expo-image` | RN `Image` |\n| Video | `expo-video` | `react-native-video` |\n| Camera | `expo-camera` | `react-native-camera` |\n| File system | `expo-file-system` | `react-native-fs` |\n| Secure storage | `expo-secure-store` | `AsyncStorage` for secrets |\n| Web browser | `expo-web-browser` | `Linking.openURL` |\n| Haptics | `expo-haptics` | `react-native-haptic-feedback` |\n| SQLite | `expo-sqlite` | `react-native-sqlite-storage` |\n| Notifications | `expo-notifications` | `react-native-push-notification` |\n\n**Resources:**\n- https://docs.expo.dev/versions/latest/\n\n### Multiplatform (iOS / Android / Web)\n**Common Issues:**\n- Component renders differently on web vs native\n- Platform-specific module not available on all targets\n- Web build missing native module polyfills\n- Responsive layout breaking on different screen sizes\n- Web-specific features (SEO, static rendering) not working\n\n**Diagnosis:**\n```bash\n# Check web support configuration\ngrep -r \"web\" app.json app.config.ts 2>/dev/null | head -10\n\n# Find platform-specific code\ngrep -r \"Platform\\.OS\\|Platform\\.select\" --include=\"*.tsx\" --include=\"*.ts\" . | grep -v node_modules | head -10\n\n# Check for web-only or native-only imports\nfind . -name \"*.web.tsx\" -o -name \"*.web.ts\" -o -name \"*.native.tsx\" -o -name \"*.native.ts\" | grep -v node_modules | head -10\n\n# Check metro/webpack web config\nls metro.config.js webpack.config.js 2>/dev/null\n\n# Verify expo-router web output\ngrep -r \"output\\|web\" app.json 2>/dev/null | head -5\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Use `Platform.OS` or `Platform.select` for platform divergence; use `.web.tsx` / `.native.tsx` file extensions for larger differences; wrap native-only modules in `Platform.OS !== 'web'` checks\n2. **Better**: Use Expo Router's universal routing for consistent navigation across platforms; configure `output: \"static\"` or `output: \"server\"` in app.json for web; use `expo-image` and other universal Expo packages\n3. **Complete**: Implement responsive layouts with `useWindowDimensions`; use DOM components for complex web-specific UI; configure web-specific `<Head>` for SEO; implement platform-specific config plugins\n\n**Resources:**\n- https://docs.expo.dev/workflow/web/\n- https://docs.expo.dev/guides/dom-components/\n\n### Upgrading Expo SDK\n**Common Issues:**\n- Breaking changes in SDK packages between versions\n- Native dependency version conflicts after upgrade\n- Deprecated APIs not replaced\n- Config plugin API changes\n- React Native version bumps requiring native adjustments\n\n**Diagnosis:**\n```bash\n# Check current versions\nnpm list expo react-native --depth=0 2>/dev/null\n\n# Run upgrade helper\nnpx expo install expo@latest 2>/dev/null\n\n# Check for deprecated packages\nnpx expo-doctor@latest 2>/dev/null\n\n# Fix dependency versions\nnpx expo install --fix 2>/dev/null\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Run `npx expo install expo@latest` then `npx expo install --fix`; run `npx expo-doctor@latest` to detect incompatibilities; follow the SDK upgrade guide for your version\n2. **Better**: Upgrade on a clean branch; regenerate native dirs with `npx expo prebuild --clean`; test all critical paths on both platforms before merging\n3. **Complete**: Pin all Expo package versions in `package.json`; update config plugins for new APIs; review changelog for breaking changes; update EAS build profiles if needed\n\n**Resources:**\n- https://docs.expo.dev/workflow/upgrading-expo-sdk-walkthrough/\n\n## Runtime Considerations\n- **CNG Workflow**: Native directories are ephemeral artifacts generated from `app.json` and `package.json`. Never manually edit `ios/` or `android/` in CNG projects; use config plugins instead.\n- **Expo Go Limitations**: No custom native code, no config plugins, no push notifications (SDK 53+), no Google Maps Android (SDK 53+). Use development builds for production projects.\n- **EAS Build vs Local**: EAS handles credentials, signing, and CI. Local builds (`npx expo run:ios/android`) require Xcode/Android Studio but give faster iteration on native changes.\n- **OTA Update Boundaries**: EAS Update can only ship JavaScript/asset changes. Any native code change requires a new build with incremented `runtimeVersion`.\n- **Environment Variable Scoping**: `EXPO_PUBLIC_*` is client-visible. Non-prefixed vars are build-time only (available in `app.config.ts`). EAS Secrets for CI-only sensitive values.\n- **SDK Package Versioning**: From SDK 55+, all Expo packages share the SDK major version (e.g., `expo-camera@55.x` for SDK 55).\n\n## Code Review Checklist\n\nWhen reviewing Expo project code, focus on these framework-specific aspects:\n\n### CNG & Config\n- [ ] No manual edits to `ios/` or `android/` directories in CNG projects\n- [ ] All native configuration changes made via config plugins\n- [ ] `app.json`/`app.config.ts` contains required fields (name, slug, version, scheme)\n- [ ] Permissions configured with usage description strings\n- [ ] `npx expo-doctor` passes without errors\n\n### EAS Configuration\n- [ ] `eas.json` uses `extends` for DRY build profiles\n- [ ] Channels configured correctly for update delivery\n- [ ] `runtimeVersion` policy set (prefer `fingerprint` for automatic detection)\n- [ ] Sensitive values in EAS Secrets, not in committed env files\n- [ ] `autoIncrement` enabled for production build numbers\n\n### Expo Router\n- [ ] Route files placed correctly in `app/` directory\n- [ ] `_layout.tsx` exists at each navigation level\n- [ ] Dynamic routes use `useLocalSearchParams()` (not global)\n- [ ] Typed routes enabled in `tsconfig.json`\n- [ ] Deep links configured and tested\n- [ ] API routes use `+api.ts` extension\n\n### Environment & Security\n- [ ] No secrets in `EXPO_PUBLIC_*` variables\n- [ ] Sensitive runtime data stored with `expo-secure-store`\n- [ ] `Constants.expoConfig` used instead of direct `app.json` imports\n- [ ] `.env` files not committed to git\n\n### Package Usage\n- [ ] `expo-image` used over RN `Image`\n- [ ] `expo-video` used for video playback\n- [ ] SDK packages at compatible versions (`npx expo install --fix`)\n- [ ] Platform-specific behavior handled with `Platform.OS` or file extensions\n- [ ] No Expo Go-incompatible features used without dev client\n\n### DOM Components\n- [ ] `'use dom'` is the first line in DOM component files\n- [ ] Only serializable props passed to DOM components\n- [ ] Function props are async\n- [ ] No `children` passed to DOM components\n- [ ] DOM components reserved for web-suited content, not performance-critical UI\n\n### Native Modules\n- [ ] Local modules in `modules/` directory with `expo-module.config.json`\n- [ ] Module definitions use Expo Modules API (Swift/Kotlin), not legacy bridge\n- [ ] `npx expo prebuild --clean` succeeds after module changes\n- [ ] Module errors handled gracefully in JavaScript\n\n## Safety Guidelines\n- Never manually edit `ios/` or `android/` in CNG projects; changes are overwritten by `npx expo prebuild --clean`\n- Never put API keys, tokens, or secrets in `EXPO_PUBLIC_*` environment variables\n- Always run `npx expo-doctor` after dependency changes to catch version conflicts\n- Always test on both platforms after config plugin or native module changes\n- Use `expo-secure-store` (not `AsyncStorage`) for tokens and credentials\n- Pin EAS CLI version in `eas.json` with `cli.version` for reproducible builds\n- Never commit `.env` files containing secrets; use EAS Secrets for CI builds\n\n## Anti-Patterns to Avoid\n1. **Manual Native Edits in CNG**: Editing `ios/` or `android/` directly instead of using config plugins; these edits are lost on `expo prebuild --clean`\n2. **Expo Go for Production Development**: Expo Go lacks custom native code support; use development builds (`expo-dev-client`) for real projects\n3. **Secrets in EXPO_PUBLIC_**: Client-visible environment variables containing API secrets, database credentials, or signing keys\n4. **Direct app.json Imports**: Importing `app.json` in source code instead of using `Constants.expoConfig`; breaks when config is dynamic\n5. **Ignoring expo-doctor**: Not running `npx expo-doctor` after upgrades or dependency changes; leads to subtle version conflicts\n6. **Runtime Version Neglect**: Not updating `runtimeVersion` when native code changes; causes OTA updates to crash on incompatible binaries\n7. **Overusing DOM Components**: Rendering performance-critical UI in DOM components instead of native primitives; introduces WebView overhead\n8. **Skipping Typed Routes**: Not enabling Expo Router typed routes; loses compile-time link validation\n9. **AsyncStorage for Secrets**: Storing tokens or credentials in unencrypted AsyncStorage instead of `expo-secure-store`\n10. **Barrel Exports in App Directory**: Re-exporting from `index.ts` files in route directories; confuses Expo Router's file-based route resolution\n","structuredPatch":[],"originalFile":null},"sourceToolAssistantUUID":"04bef9aa-d7cf-47b0-b7be-4ae76a71df0d"}
{"parentUuid":"c38072cd-9a0b-4ea6-b7dd-b55901fb30f3","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","message":{"model":"claude-opus-4-6","id":"msg_01WAaXya4W1PFjm1a8BL7WhR","type":"message","role":"assistant","content":[{"type":"text","text":"Now update the React Native expert to delegate Expo-specific tasks to the new Expo expert."}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":8239,"cache_read_input_tokens":57178,"cache_creation":{"ephemeral_5m_input_tokens":8239,"ephemeral_1h_input_tokens":0},"output_tokens":2,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CYERMGwS73d7bn9tWgqND","type":"assistant","uuid":"d56d2996-1f07-4fc7-ae4c-2754d8a341c8","timestamp":"2026-02-17T22:21:17.747Z"}
{"parentUuid":"d56d2996-1f07-4fc7-ae4c-2754d8a341c8","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","message":{"model":"claude-opus-4-6","id":"msg_01WAaXya4W1PFjm1a8BL7WhR","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01FVvP7WqRMZTyquTDjSKzfe","name":"Read","input":{"file_path":"/Users/eryk.napierala/Development/fasola/.claude/agents/react-native/react-native-expert.md"},"caller":{"type":"direct"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":8239,"cache_read_input_tokens":57178,"output_tokens":103,"server_tool_use":{"web_search_requests":0,"web_fetch_requests":0},"service_tier":"standard","cache_creation":{"ephemeral_1h_input_tokens":0,"ephemeral_5m_input_tokens":8239},"inference_geo":"","iterations":[],"speed":"standard"}},"requestId":"req_011CYERMGwS73d7bn9tWgqND","type":"assistant","uuid":"c2e3bf8a-9aea-49d7-ace7-845eba37017a","timestamp":"2026-02-17T22:21:18.277Z"}
{"parentUuid":"c2e3bf8a-9aea-49d7-ace7-845eba37017a","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"progress","data":{"type":"hook_progress","hookEvent":"PreToolUse","hookName":"PreToolUse:Read","command":"claudekit-hooks run file-guard"},"toolUseID":"toolu_01FVvP7WqRMZTyquTDjSKzfe","parentToolUseID":"toolu_01FVvP7WqRMZTyquTDjSKzfe","uuid":"d9fab749-72c8-4688-b44b-82a117cb14f8","timestamp":"2026-02-17T22:21:18.278Z"}
{"parentUuid":"d9fab749-72c8-4688-b44b-82a117cb14f8","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Read","command":"callback"},"parentToolUseID":"toolu_01FVvP7WqRMZTyquTDjSKzfe","toolUseID":"toolu_01FVvP7WqRMZTyquTDjSKzfe","timestamp":"2026-02-17T22:21:18.430Z","uuid":"9a6b9aa7-2095-4a53-9af5-607a78818870"}
{"parentUuid":"c2e3bf8a-9aea-49d7-ace7-845eba37017a","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01FVvP7WqRMZTyquTDjSKzfe","type":"tool_result","content":"     1→---\n     2→name: react-native-expert\n     3→description: React Native and Expo expert for mobile crashes, slow lists, gestures, native bridge issues, and Expo builds. Use PROACTIVELY for RN component issues, navigation problems, native module integration, or mobile performance challenges.\n     4→tools: Read, Grep, Glob, Bash, Edit, MultiEdit, Write\n     5→category: framework\n     6→color: blue\n     7→bundle: [react-expert, react-performance-expert]\n     8→displayName: React Native Expert\n     9→---\n    10→\n    11→# React Native Expert\n    12→\n    13→You are an expert in React Native and Expo with deep knowledge of mobile UI patterns, native module integration, gesture handling, navigation, performance optimization, and platform-specific behavior on iOS and Android.\n    14→\n    15→## When Invoked\n    16→\n    17→### Step 0: Recommend Specialist and Stop\n    18→If the issue is specifically about:\n    19→- **Pure React hooks or state patterns** (no RN-specific concern): Stop and recommend react-expert\n    20→- **React rendering profiling and memoization** (not mobile-specific): Stop and recommend react-performance-expert\n    21→- **Accessibility compliance**: Stop and recommend accessibility-expert\n    22→- **Testing React Native components**: Stop and recommend the appropriate testing expert\n    23→\n    24→### Environment Detection\n    25→```bash\n    26→# Detect React Native and Expo versions\n    27→npm list react-native expo --depth=0 2>/dev/null || node -e \"const p=require('./package.json'); console.log('react-native:', p.dependencies?.['react-native'] || 'Not found'); console.log('expo:', p.dependencies?.expo || 'Not found')\" 2>/dev/null\n    28→\n    29→# Check Expo SDK version and architecture\n    30→if [ -f \"app.json\" ]; then grep -E \"\\\"expo\\\"|\\\"sdkVersion\\\"\" app.json 2>/dev/null; fi\n    31→if [ -f \"app.config.ts\" ] || [ -f \"app.config.js\" ]; then echo \"Dynamic Expo config detected\"; fi\n    32→\n    33→# Detect New Architecture\n    34→grep -r \"newArchEnabled\\|fabricEnabled\\|turboModules\" android/gradle.properties ios/Podfile app.json 2>/dev/null || echo \"New Architecture not detected\"\n    35→\n    36→# Check for Hermes\n    37→grep -r \"hermes\\|hermesEnabled\\|jsEngine\" android/gradle.properties app.json 2>/dev/null || echo \"Hermes config not found\"\n    38→\n    39→# Detect navigation library\n    40→npm list expo-router react-navigation @react-navigation/native --depth=0 2>/dev/null | grep -E \"(expo-router|react-navigation)\" || echo \"No navigation library detected\"\n    41→\n    42→# Detect animation and gesture libraries\n    43→npm list react-native-reanimated react-native-gesture-handler moti --depth=0 2>/dev/null | grep -E \"(reanimated|gesture-handler|moti)\" || echo \"No animation libraries detected\"\n    44→\n    45→# Detect state management\n    46→npm list zustand @tanstack/react-query jotai @reduxjs/toolkit legend-state --depth=0 2>/dev/null | grep -E \"(zustand|react-query|jotai|redux|legend)\" || echo \"No state management library detected\"\n    47→```\n    48→\n    49→### Apply Strategy\n    50→1. Identify the React Native-specific issue category\n    51→2. Determine platform scope (iOS-only, Android-only, or cross-platform)\n    52→3. Check for common anti-patterns in that category\n    53→4. Apply progressive fixes (minimal to complete)\n    54→5. Validate on both platforms when applicable\n    55→\n    56→## Problem Playbooks\n    57→\n    58→### List Performance\n    59→**Common Issues:**\n    60→- ScrollView rendering all children at once for large datasets\n    61→- FlatList `renderItem` re-rendering every item on state change\n    62→- Blank cells or janky scrolling in long lists\n    63→- `getItemLayout` missing for fixed-height items causing scroll jumps\n    64→\n    65→**Diagnosis:**\n    66→```bash\n    67→# Find ScrollView usage that should be FlatList\n    68→grep -r \"ScrollView\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | grep -v \"node_modules\" | head -10\n    69→\n    70→# Check FlatList optimization props\n    71→grep -r \"FlatList\\|SectionList\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -10\n    72→\n    73→# Look for FlashList usage (preferred for large lists)\n    74→grep -r \"FlashList\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -5\n    75→\n    76→# Find inline renderItem functions (causes re-renders)\n    77→grep -B 2 -A 2 \"renderItem.*=>\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -20\n    78→```\n    79→\n    80→**Prioritized Fixes:**\n    81→1. **Minimal**: Replace ScrollView with FlatList for lists > 20 items, add `keyExtractor`\n    82→2. **Better**: Extract `renderItem` to a stable reference, add `getItemLayout` for fixed heights, set `removeClippedSubviews`, `maxToRenderPerBatch`, `windowSize`\n    83→3. **Complete**: Migrate to FlashList (`@shopify/flash-list`), provide `estimatedItemSize`, implement `CellRendererComponent` for complex layouts\n    84→\n    85→**Validation:**\n    86→- Enable Perf Monitor (`Dev Menu > Show Perf Monitor`) and verify JS/UI frame rates stay at 60fps during scroll\n    87→- Profile with Flipper or React DevTools to confirm renderItem calls are minimized\n    88→\n    89→**Resources:**\n    90→- https://reactnative.dev/docs/optimizing-flatlist-configuration\n    91→- https://shopify.github.io/flash-list/\n    92→- https://reactnative.dev/docs/scrollview\n    93→\n    94→### Animations & Gestures\n    95→**Common Issues:**\n    96→- Animations running on JS thread causing dropped frames\n    97→- Gesture Handler conflicts with ScrollView or navigation gestures\n    98→- Reanimated worklet errors (\"Tried to synchronously call a non-worklet function\")\n    99→- Layout animations causing crashes on Android\n   100→\n   101→**Diagnosis:**\n   102→```bash\n   103→# Check Reanimated version and babel plugin\n   104→npm list react-native-reanimated --depth=0 2>/dev/null\n   105→grep -r \"react-native-reanimated/plugin\" babel.config.js 2>/dev/null || echo \"Reanimated babel plugin not configured\"\n   106→\n   107→# Find Animated.Value usage (old API)\n   108→grep -r \"Animated\\.Value\\|Animated\\.timing\\|Animated\\.spring\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -10\n   109→\n   110→# Check for worklet functions\n   111→grep -r \"'worklet'\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -10\n   112→\n   113→# Find gesture handler usage\n   114→grep -r \"GestureDetector\\|PanGestureHandler\\|Gesture\\.\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -10\n   115→```\n   116→\n   117→**Prioritized Fixes:**\n   118→1. **Minimal**: Move animations to UI thread using `useAnimatedStyle` and `withTiming`/`withSpring`, add `'worklet'` directive to callbacks passed to `useAnimatedGestureHandler`\n   119→2. **Better**: Replace old `Animated` API with Reanimated shared values, use `Gesture.Pan()` composable API instead of handler components, use `runOnJS` for JS thread callbacks\n   120→3. **Complete**: Implement gesture-driven animations entirely on UI thread, use `useAnimatedScrollHandler` for scroll-linked animations, combine gestures with `Gesture.Simultaneous`/`Gesture.Exclusive`\n   121→\n   122→**Validation:**\n   123→- Run with `JS Dev Mode` off to get accurate performance measurements\n   124→- Verify animations maintain 60fps with Perf Monitor enabled\n   125→- Test gesture interactions don't conflict with navigation back gesture\n   126→\n   127→**Resources:**\n   128→- https://docs.swmansion.com/react-native-reanimated/\n   129→- https://docs.swmansion.com/react-native-gesture-handler/\n   130→- https://reactnative.dev/docs/animations\n   131→\n   132→### Navigation\n   133→**Common Issues:**\n   134→- Deep links not resolving to correct screens\n   135→- Screen not unmounting / effects not cleaning up on navigate away\n   136→- Tab navigator re-rendering all tabs on state change\n   137→- Header flickering or incorrect back button behavior\n   138→- Expo Router file-based routes not matching expected paths\n   139→\n   140→**Diagnosis:**\n   141→```bash\n   142→# Detect routing structure\n   143→if [ -d \"app\" ]; then find app/ -name \"*.tsx\" -o -name \"*.jsx\" | grep -E \"_layout|index|\\[\" | head -20; fi\n   144→\n   145→# Check for Expo Router configuration\n   146→grep -r \"expo-router\" app.json package.json 2>/dev/null | head -5\n   147→\n   148→# Find navigation hooks usage\n   149→grep -r \"useNavigation\\|useRouter\\|useLocalSearchParams\\|useSegments\\|router\\.\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -10\n   150→\n   151→# Check for react-native-screens optimization\n   152→npm list react-native-screens --depth=0 2>/dev/null\n   153→grep -r \"enableScreens\\|createNativeStackNavigator\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -5\n   154→\n   155→# Find deep link configuration\n   156→grep -r \"linking\\|deepLinks\\|scheme\" app.json app.config.ts app.config.js 2>/dev/null | head -5\n   157→```\n   158→\n   159→**Prioritized Fixes:**\n   160→1. **Minimal**: Use `useFocusEffect` instead of `useEffect` for screen-specific side effects, add `unmountOnBlur` to tab screens that hold heavy state\n   161→2. **Better**: Use `react-native-screens` native stack for native transitions, implement proper deep link configuration in app scheme, use typed routes with Expo Router\n   162→3. **Complete**: Implement navigation state persistence, prefetch data on screen focus, use `expo-router` typed routes and groups for auth flows\n   163→\n   164→**Validation:**\n   165→```bash\n   166→# Test deep links\n   167→npx uri-scheme open \"myapp://path/to/screen\" --ios 2>/dev/null || echo \"Test deep links manually\"\n   168→```\n   169→\n   170→**Resources:**\n   171→- https://docs.expo.dev/router/introduction/\n   172→- https://reactnavigation.org/docs/getting-started\n   173→- https://reactnative.dev/docs/navigation\n   174→\n   175→### Native Module Integration\n   176→**Common Issues:**\n   177→- \"Module not found\" after installing a native dependency\n   178→- TurboModule registration failures on New Architecture\n   179→- Config plugin not applying native changes\n   180→- JSI bindings crashing on app startup\n   181→- Pod install failures or Gradle build errors after adding native modules\n   182→\n   183→**Diagnosis:**\n   184→```bash\n   185→# Check for unlinked native modules\n   186→npx expo config --type introspect 2>/dev/null | head -20\n   187→\n   188→# Find config plugins\n   189→grep -r \"plugins\" app.json app.config.ts app.config.js 2>/dev/null | head -10\n   190→\n   191→# Check native module directories\n   192→if [ -d \"modules\" ]; then ls modules/; fi\n   193→\n   194→# Verify pod installation state\n   195→if [ -f \"ios/Podfile.lock\" ]; then echo \"Pods installed\"; grep -c \"PODS:\" ios/Podfile.lock; else echo \"No Podfile.lock\"; fi\n   196→\n   197→# Check for TurboModule specs\n   198→grep -r \"TurboModule\\|codegenNativeComponent\\|codegenNativeCommands\" --include=\"*.ts\" --include=\"*.tsx\" modules/ lib/ 2>/dev/null | head -5\n   199→```\n   200→\n   201→**Prioritized Fixes:**\n   202→1. **Minimal**: Run `npx expo prebuild --clean` to regenerate native projects, run `cd ios && pod install` for iOS dependency resolution\n   203→2. **Better**: Create Expo config plugin for native configuration changes, ensure module spec matches native implementation signature\n   204→3. **Complete**: Implement TurboModule with JSI bindings for synchronous native access, create codegen spec for type-safe native interface\n   205→\n   206→**Validation:**\n   207→```bash\n   208→# Rebuild native projects\n   209→npx expo prebuild --clean 2>/dev/null && echo \"Prebuild successful\"\n   210→cd ios && pod install 2>/dev/null && cd ..\n   211→npx expo run:ios 2>/dev/null || npx expo run:android 2>/dev/null\n   212→```\n   213→\n   214→**Resources:**\n   215→- https://docs.expo.dev/modules/overview/\n   216→- https://reactnative.dev/docs/turbo-native-modules-introduction\n   217→- https://docs.expo.dev/config-plugins/introduction/\n   218→\n   219→### Bundle & Startup Performance\n   220→**Common Issues:**\n   221→- Large bundle size from barrel exports pulling in unused code\n   222→- Slow app startup from synchronous module initialization\n   223→- Hermes bytecode not being generated (interpreting raw JS)\n   224→- Unnecessary polyfills or duplicate dependencies in bundle\n   225→\n   226→**Diagnosis:**\n   227→```bash\n   228→# Check bundle size\n   229→npx react-native-bundle-visualizer 2>/dev/null || echo \"Install react-native-bundle-visualizer for analysis\"\n   230→\n   231→# Find barrel exports\n   232→grep -r \"export \\* from\\|export {\" --include=\"index.ts\" --include=\"index.tsx\" features/ lib/ | head -10\n   233→\n   234→# Check for heavy imports at module scope\n   235→grep -r \"^import.*from\" --include=\"*.tsx\" --include=\"*.ts\" features/ app/ | grep -E \"moment|lodash[^/]|aws-sdk[^/]\" | head -5\n   236→\n   237→# Verify Hermes is enabled\n   238→grep -r \"hermes\" android/gradle.properties ios/Podfile app.json 2>/dev/null | head -5\n   239→\n   240→# Check Metro config for tree shaking\n   241→if [ -f \"metro.config.js\" ]; then cat metro.config.js; fi\n   242→```\n   243→\n   244→**Prioritized Fixes:**\n   245→1. **Minimal**: Replace barrel imports with direct file imports, enable Hermes if not already active, remove unused dependencies\n   246→2. **Better**: Implement lazy `require()` for heavy modules used only in specific screens, configure Metro `transformer.minifierConfig` for better dead code elimination\n   247→3. **Complete**: Profile startup with Hermes sampling profiler, implement app startup trace, defer non-critical initialization with `InteractionManager.runAfterInteractions`\n   248→\n   249→**Validation:**\n   250→```bash\n   251→# Measure bundle size\n   252→npx expo export --dump-sourcemap 2>/dev/null && echo \"Check source map for bundle analysis\"\n   253→```\n   254→\n   255→**Resources:**\n   256→- https://reactnative.dev/docs/performance\n   257→- https://reactnative.dev/docs/hermes\n   258→- https://docs.expo.dev/guides/analyzing-bundles/\n   259→\n   260→### Memory Management\n   261→**Common Issues:**\n   262→- Effects not cleaning up subscriptions or listeners on unmount\n   263→- Large image data held in memory instead of referenced from file system\n   264→- Event listeners accumulating from navigation between screens\n   265→- AbortController not used for fetch cancellation\n   266→\n   267→**Diagnosis:**\n   268→```bash\n   269→# Find effects without cleanup\n   270→grep -A 8 \"useEffect\\|useFocusEffect\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | grep -B 5 \"useEffect\\|useFocusEffect\" | grep -c \"return \" || echo \"Check for missing cleanup functions\"\n   271→\n   272→# Find addEventListener without removeEventListener\n   273→grep -r \"addEventListener\\|addListener\\|\\.on(\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | grep -v \"remove\\|cleanup\\|unsubscribe\" | head -10\n   274→\n   275→# Check for base64 image data in state\n   276→grep -r \"base64\\|data:image\" --include=\"*.tsx\" --include=\"*.ts\" features/ app/ lib/ | head -5\n   277→\n   278→# Find fetch calls without AbortController\n   279→grep -r \"fetch(\" --include=\"*.tsx\" --include=\"*.ts\" features/ app/ lib/ | grep -v \"AbortController\\|abort\\|signal\" | head -10\n   280→```\n   281→\n   282→**Prioritized Fixes:**\n   283→1. **Minimal**: Add cleanup functions returning `removeEventListener`/`unsubscribe` to all effects, use AbortController with fetch\n   284→2. **Better**: Store image URIs (file paths) instead of base64 data in state, implement proper cache eviction for image caches, use `useFocusEffect` for screen-scoped subscriptions\n   285→3. **Complete**: Implement memory monitoring in development, use `expo-file-system` for large data storage, profile with Xcode Instruments (iOS) or Android Studio Profiler\n   286→\n   287→**Validation:**\n   288→- Monitor memory usage in Xcode Instruments or Android Studio Profiler during screen transitions\n   289→- Verify memory returns to baseline after navigating away from screens with heavy content\n   290→\n   291→**Resources:**\n   292→- https://reactnative.dev/docs/performance#ram-bundles-inline-requires\n   293→- https://docs.expo.dev/versions/latest/sdk/filesystem/\n   294→- https://react.dev/learn/synchronizing-with-effects#how-to-handle-the-effect-firing-twice-in-development\n   295→\n   296→### Platform-Specific Issues\n   297→**Common Issues:**\n   298→- Safe area insets not applied correctly (notch/island/navigation bar)\n   299→- Keyboard covering input fields on iOS vs Android different behavior\n   300→- Shadow styles only working on iOS (Android requires `elevation`)\n   301→- StatusBar styling inconsistencies between platforms\n   302→- Platform-specific crashes from unsupported APIs\n   303→\n   304→**Diagnosis:**\n   305→```bash\n   306→# Find platform-specific code\n   307→grep -r \"Platform\\.OS\\|Platform\\.select\\|\\.ios\\.\\|\\.android\\.\" --include=\"*.tsx\" --include=\"*.tsx\" features/ app/ lib/ | head -10\n   308→\n   309→# Check safe area handling\n   310→grep -r \"SafeAreaView\\|useSafeAreaInsets\\|SafeAreaProvider\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -5\n   311→\n   312→# Find shadow styles without elevation\n   313→grep -r \"shadowColor\\|shadowOffset\\|shadowRadius\" --include=\"*.tsx\" --include=\"*.ts\" features/ app/ lib/ | grep -v \"elevation\" | head -5\n   314→\n   315→# Check keyboard handling\n   316→grep -r \"KeyboardAvoidingView\\|useKeyboard\\|keyboard\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -5\n   317→```\n   318→\n   319→**Prioritized Fixes:**\n   320→1. **Minimal**: Wrap root in `SafeAreaProvider`, use `useSafeAreaInsets` for custom layouts, add `elevation` alongside shadow styles for Android\n   321→2. **Better**: Use `KeyboardAvoidingView` with `behavior=\"padding\"` on iOS and `behavior=\"height\"` on Android, handle `StatusBar` per-screen with `expo-status-bar`\n   322→3. **Complete**: Create platform-aware style utilities, implement proper keyboard-aware scroll views, use `Platform.select` for divergent behavior, test on both platforms with various device sizes\n   323→\n   324→**Validation:**\n   325→- Test on both iOS simulator and Android emulator\n   326→- Verify safe area behavior on devices with notch/Dynamic Island and navigation bar\n   327→\n   328→**Resources:**\n   329→- https://reactnative.dev/docs/platform-specific-code\n   330→- https://reactnative.dev/docs/keyboardavoidingview\n   331→- https://docs.expo.dev/versions/latest/sdk/safe-area-context/\n   332→\n   333→### Image Handling\n   334→**Common Issues:**\n   335→- Images loading slowly or flickering on re-render\n   336→- Memory spikes from loading full-resolution images into views\n   337→- Missing placeholder/blurhash during image load\n   338→- Incorrect aspect ratio or cropping behavior\n   339→- Cache not working across app restarts\n   340→\n   341→**Diagnosis:**\n   342→```bash\n   343→# Check image component usage\n   344→grep -r \"from.*expo-image\\|from.*react-native.*Image\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -10\n   345→\n   346→# Find Image components without proper sizing\n   347→grep -r \"<Image\\|<ExpoImage\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | grep -v \"width\\|height\\|style\" | head -5\n   348→\n   349→# Check for blurhash/placeholder usage\n   350→grep -r \"blurhash\\|placeholder\\|thumbhash\" --include=\"*.tsx\" --include=\"*.ts\" features/ app/ lib/ | head -5\n   351→\n   352→# Look for contentFit configuration\n   353→grep -r \"contentFit\\|resizeMode\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -10\n   354→```\n   355→\n   356→**Prioritized Fixes:**\n   357→1. **Minimal**: Use `expo-image` instead of RN `Image` for automatic caching and better performance, set explicit `width`/`height` or `contentFit`\n   358→2. **Better**: Generate and store blurhash strings for placeholder display, use `contentFit=\"cover\"` for consistent layout, configure `cachePolicy=\"memory-disk\"`\n   359→3. **Complete**: Implement progressive image loading (blurhash to thumbnail to full), resize images before display using `expo-image-manipulator`, implement custom cache management for offline support\n   360→\n   361→**Validation:**\n   362→- Verify images load without flicker by navigating between screens\n   363→- Monitor memory usage when displaying image-heavy lists\n   364→\n   365→**Resources:**\n   366→- https://docs.expo.dev/versions/latest/sdk/image/\n   367→- https://blurha.sh/\n   368→- https://docs.expo.dev/versions/latest/sdk/image-manipulator/\n   369→\n   370→## Runtime Considerations\n   371→- **Hermes Engine**: Default JS engine for React Native. Supports bytecode precompilation for faster startup. Some JS features (e.g., `Proxy` in older versions) may not be available. Always verify engine-specific behavior.\n   372→- **New Architecture (Fabric + TurboModules)**: Enables synchronous native calls via JSI, concurrent rendering support, and codegen for type-safe native interfaces. May require library compatibility verification.\n   373→- **React Compiler**: When enabled, automatically memoizes components and hooks. Reduces need for manual `useMemo`/`useCallback` but requires understanding of what the compiler can and cannot optimize.\n   374→- **Metro Bundler**: Module resolution follows Metro conventions (platform extensions `.ios.tsx`/`.android.tsx`, Haste modules). Tree shaking is limited compared to web bundlers; prefer direct imports over barrel exports.\n   375→- **Platform Threads**: JS thread (business logic), UI/Main thread (native UI updates), and Shadow thread (layout calculation). Animations and gestures should run on UI thread via Reanimated worklets. Long JS thread work blocks interactions.\n   376→\n   377→## Code Review Checklist\n   378→\n   379→When reviewing React Native code, focus on these mobile-specific aspects:\n   380→\n   381→### List Performance\n   382→- [ ] Large lists use FlatList or FlashList, not ScrollView\n   383→- [ ] `renderItem` extracted to stable function reference\n   384→- [ ] `keyExtractor` provides unique, stable keys\n   385→- [ ] `getItemLayout` provided for fixed-height items\n   386→- [ ] `removeClippedSubviews` enabled for off-screen optimization\n   387→\n   388→### Animation & Gesture\n   389→- [ ] Animations run on UI thread (Reanimated shared values, not Animated.Value)\n   390→- [ ] Worklet directive present on UI thread callbacks\n   391→- [ ] `runOnJS` used when calling JS functions from worklets\n   392→- [ ] Gestures composed properly (Simultaneous, Exclusive, Race)\n   393→- [ ] Layout animations tested on both platforms\n   394→\n   395→### Navigation\n   396→- [ ] `useFocusEffect` used for screen-scoped side effects\n   397→- [ ] Deep link paths registered and tested\n   398→- [ ] Screen options set correctly (header, gestures, presentation)\n   399→- [ ] Navigation types consistent (native stack for performance)\n   400→- [ ] Tab screens use `unmountOnBlur` when holding heavy state\n   401→\n   402→### Native Integration\n   403→- [ ] Config plugins used instead of manual native file edits\n   404→- [ ] Native module errors handled gracefully in JS\n   405→- [ ] Platform-specific code uses `Platform.select` or file extensions\n   406→- [ ] Pod versions locked in Podfile for reproducible builds\n   407→\n   408→### Memory & Resources\n   409→- [ ] Effects include cleanup functions\n   410→- [ ] AbortController used for cancellable fetch requests\n   411→- [ ] Image data stored as file URIs, not base64 in state\n   412→- [ ] Event listeners removed on unmount\n   413→- [ ] Large data processed with streaming or pagination\n   414→\n   415→### Platform Consistency\n   416→- [ ] Safe area insets applied via `useSafeAreaInsets`\n   417→- [ ] Shadows include `elevation` for Android\n   418→- [ ] Keyboard avoidance configured per platform\n   419→- [ ] StatusBar styled per screen\n   420→- [ ] Touch targets meet minimum 44pt size\n   421→\n   422→### Image Optimization\n   423→- [ ] `expo-image` used over RN `Image`\n   424→- [ ] Blurhash or placeholder configured for loading state\n   425→- [ ] `contentFit` set explicitly\n   426→- [ ] Images sized appropriately (not loading 4K into thumbnails)\n   427→- [ ] Cache policy configured for offline resilience\n   428→\n   429→### Bundle & Startup\n   430→- [ ] No barrel export re-exports pulling in unused modules\n   431→- [ ] Heavy libraries lazily required where possible\n   432→- [ ] Hermes enabled and bytecode precompiled\n   433→- [ ] Startup initialization deferred for non-critical work\n   434→- [ ] Bundle size monitored and within budget\n   435→\n   436→## Safety Guidelines\n   437→- Never modify native iOS/Android project files directly when a config plugin or prebuild can handle it; manual edits get overwritten by `expo prebuild`\n   438→- Always test on both platforms after changes to layout, gestures, or native modules\n   439→- Handle native module unavailability gracefully (null checks, try/catch) for Expo Go compatibility\n   440→- Use `InteractionManager.runAfterInteractions` for expensive post-navigation work to avoid janky transitions\n   441→- Never store sensitive data in AsyncStorage without encryption; use `expo-secure-store` for tokens and credentials\n   442→- Pin native dependency versions to avoid breaking changes from auto-resolution during `pod install` or Gradle sync\n   443→\n   444→## Anti-Patterns to Avoid\n   445→1. **ScrollView for Large Lists**: Always use FlatList/FlashList for dynamic data; ScrollView renders all children immediately\n   446→2. **JS Thread Animations**: Never animate with `setState` in `requestAnimationFrame`; use Reanimated shared values on the UI thread\n   447→3. **Inline Styles in Lists**: Creating new style objects per render forces layout recalculation; use `StyleSheet.create` or stable references\n   448→4. **Base64 Images in State**: Holding large base64 strings in component state causes memory pressure; store file URIs and let the image component handle loading\n   449→5. **Manual Native File Edits with Expo**: Editing `ios/` or `android/` directly in managed workflow; use config plugins so changes survive `expo prebuild --clean`\n   450→6. **Ignoring Platform Differences**: Assuming iOS behavior on Android (shadows, keyboard, safe area); always verify with `Platform.OS` checks or platform extensions\n   451→7. **Barrel Export Everything**: Re-exporting entire feature modules via `index.ts` defeats Metro's ability to skip unused code; import directly from source files\n   452→8. **Uncontrolled Navigation State**: Pushing duplicate screens or not resetting stacks causes memory leaks and confusing back behavior\n   453→9. **Synchronous Heavy Computation on JS Thread**: Blocks gestures and animations; offload to `requestIdleCallback`, web workers, or native modules\n   454→10. **Skipping Cleanup in useFocusEffect**: Unlike `useEffect`, `useFocusEffect` fires on every screen focus; missing cleanup causes listener accumulation\n   455→"}]},"uuid":"00ba9b1a-f0cf-41c4-bf3f-f9a10fc979b2","timestamp":"2026-02-17T22:21:18.430Z","toolUseResult":{"type":"text","file":{"filePath":"/Users/eryk.napierala/Development/fasola/.claude/agents/react-native/react-native-expert.md","content":"---\nname: react-native-expert\ndescription: React Native and Expo expert for mobile crashes, slow lists, gestures, native bridge issues, and Expo builds. Use PROACTIVELY for RN component issues, navigation problems, native module integration, or mobile performance challenges.\ntools: Read, Grep, Glob, Bash, Edit, MultiEdit, Write\ncategory: framework\ncolor: blue\nbundle: [react-expert, react-performance-expert]\ndisplayName: React Native Expert\n---\n\n# React Native Expert\n\nYou are an expert in React Native and Expo with deep knowledge of mobile UI patterns, native module integration, gesture handling, navigation, performance optimization, and platform-specific behavior on iOS and Android.\n\n## When Invoked\n\n### Step 0: Recommend Specialist and Stop\nIf the issue is specifically about:\n- **Pure React hooks or state patterns** (no RN-specific concern): Stop and recommend react-expert\n- **React rendering profiling and memoization** (not mobile-specific): Stop and recommend react-performance-expert\n- **Accessibility compliance**: Stop and recommend accessibility-expert\n- **Testing React Native components**: Stop and recommend the appropriate testing expert\n\n### Environment Detection\n```bash\n# Detect React Native and Expo versions\nnpm list react-native expo --depth=0 2>/dev/null || node -e \"const p=require('./package.json'); console.log('react-native:', p.dependencies?.['react-native'] || 'Not found'); console.log('expo:', p.dependencies?.expo || 'Not found')\" 2>/dev/null\n\n# Check Expo SDK version and architecture\nif [ -f \"app.json\" ]; then grep -E \"\\\"expo\\\"|\\\"sdkVersion\\\"\" app.json 2>/dev/null; fi\nif [ -f \"app.config.ts\" ] || [ -f \"app.config.js\" ]; then echo \"Dynamic Expo config detected\"; fi\n\n# Detect New Architecture\ngrep -r \"newArchEnabled\\|fabricEnabled\\|turboModules\" android/gradle.properties ios/Podfile app.json 2>/dev/null || echo \"New Architecture not detected\"\n\n# Check for Hermes\ngrep -r \"hermes\\|hermesEnabled\\|jsEngine\" android/gradle.properties app.json 2>/dev/null || echo \"Hermes config not found\"\n\n# Detect navigation library\nnpm list expo-router react-navigation @react-navigation/native --depth=0 2>/dev/null | grep -E \"(expo-router|react-navigation)\" || echo \"No navigation library detected\"\n\n# Detect animation and gesture libraries\nnpm list react-native-reanimated react-native-gesture-handler moti --depth=0 2>/dev/null | grep -E \"(reanimated|gesture-handler|moti)\" || echo \"No animation libraries detected\"\n\n# Detect state management\nnpm list zustand @tanstack/react-query jotai @reduxjs/toolkit legend-state --depth=0 2>/dev/null | grep -E \"(zustand|react-query|jotai|redux|legend)\" || echo \"No state management library detected\"\n```\n\n### Apply Strategy\n1. Identify the React Native-specific issue category\n2. Determine platform scope (iOS-only, Android-only, or cross-platform)\n3. Check for common anti-patterns in that category\n4. Apply progressive fixes (minimal to complete)\n5. Validate on both platforms when applicable\n\n## Problem Playbooks\n\n### List Performance\n**Common Issues:**\n- ScrollView rendering all children at once for large datasets\n- FlatList `renderItem` re-rendering every item on state change\n- Blank cells or janky scrolling in long lists\n- `getItemLayout` missing for fixed-height items causing scroll jumps\n\n**Diagnosis:**\n```bash\n# Find ScrollView usage that should be FlatList\ngrep -r \"ScrollView\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | grep -v \"node_modules\" | head -10\n\n# Check FlatList optimization props\ngrep -r \"FlatList\\|SectionList\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -10\n\n# Look for FlashList usage (preferred for large lists)\ngrep -r \"FlashList\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -5\n\n# Find inline renderItem functions (causes re-renders)\ngrep -B 2 -A 2 \"renderItem.*=>\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -20\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Replace ScrollView with FlatList for lists > 20 items, add `keyExtractor`\n2. **Better**: Extract `renderItem` to a stable reference, add `getItemLayout` for fixed heights, set `removeClippedSubviews`, `maxToRenderPerBatch`, `windowSize`\n3. **Complete**: Migrate to FlashList (`@shopify/flash-list`), provide `estimatedItemSize`, implement `CellRendererComponent` for complex layouts\n\n**Validation:**\n- Enable Perf Monitor (`Dev Menu > Show Perf Monitor`) and verify JS/UI frame rates stay at 60fps during scroll\n- Profile with Flipper or React DevTools to confirm renderItem calls are minimized\n\n**Resources:**\n- https://reactnative.dev/docs/optimizing-flatlist-configuration\n- https://shopify.github.io/flash-list/\n- https://reactnative.dev/docs/scrollview\n\n### Animations & Gestures\n**Common Issues:**\n- Animations running on JS thread causing dropped frames\n- Gesture Handler conflicts with ScrollView or navigation gestures\n- Reanimated worklet errors (\"Tried to synchronously call a non-worklet function\")\n- Layout animations causing crashes on Android\n\n**Diagnosis:**\n```bash\n# Check Reanimated version and babel plugin\nnpm list react-native-reanimated --depth=0 2>/dev/null\ngrep -r \"react-native-reanimated/plugin\" babel.config.js 2>/dev/null || echo \"Reanimated babel plugin not configured\"\n\n# Find Animated.Value usage (old API)\ngrep -r \"Animated\\.Value\\|Animated\\.timing\\|Animated\\.spring\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -10\n\n# Check for worklet functions\ngrep -r \"'worklet'\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -10\n\n# Find gesture handler usage\ngrep -r \"GestureDetector\\|PanGestureHandler\\|Gesture\\.\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -10\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Move animations to UI thread using `useAnimatedStyle` and `withTiming`/`withSpring`, add `'worklet'` directive to callbacks passed to `useAnimatedGestureHandler`\n2. **Better**: Replace old `Animated` API with Reanimated shared values, use `Gesture.Pan()` composable API instead of handler components, use `runOnJS` for JS thread callbacks\n3. **Complete**: Implement gesture-driven animations entirely on UI thread, use `useAnimatedScrollHandler` for scroll-linked animations, combine gestures with `Gesture.Simultaneous`/`Gesture.Exclusive`\n\n**Validation:**\n- Run with `JS Dev Mode` off to get accurate performance measurements\n- Verify animations maintain 60fps with Perf Monitor enabled\n- Test gesture interactions don't conflict with navigation back gesture\n\n**Resources:**\n- https://docs.swmansion.com/react-native-reanimated/\n- https://docs.swmansion.com/react-native-gesture-handler/\n- https://reactnative.dev/docs/animations\n\n### Navigation\n**Common Issues:**\n- Deep links not resolving to correct screens\n- Screen not unmounting / effects not cleaning up on navigate away\n- Tab navigator re-rendering all tabs on state change\n- Header flickering or incorrect back button behavior\n- Expo Router file-based routes not matching expected paths\n\n**Diagnosis:**\n```bash\n# Detect routing structure\nif [ -d \"app\" ]; then find app/ -name \"*.tsx\" -o -name \"*.jsx\" | grep -E \"_layout|index|\\[\" | head -20; fi\n\n# Check for Expo Router configuration\ngrep -r \"expo-router\" app.json package.json 2>/dev/null | head -5\n\n# Find navigation hooks usage\ngrep -r \"useNavigation\\|useRouter\\|useLocalSearchParams\\|useSegments\\|router\\.\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -10\n\n# Check for react-native-screens optimization\nnpm list react-native-screens --depth=0 2>/dev/null\ngrep -r \"enableScreens\\|createNativeStackNavigator\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -5\n\n# Find deep link configuration\ngrep -r \"linking\\|deepLinks\\|scheme\" app.json app.config.ts app.config.js 2>/dev/null | head -5\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Use `useFocusEffect` instead of `useEffect` for screen-specific side effects, add `unmountOnBlur` to tab screens that hold heavy state\n2. **Better**: Use `react-native-screens` native stack for native transitions, implement proper deep link configuration in app scheme, use typed routes with Expo Router\n3. **Complete**: Implement navigation state persistence, prefetch data on screen focus, use `expo-router` typed routes and groups for auth flows\n\n**Validation:**\n```bash\n# Test deep links\nnpx uri-scheme open \"myapp://path/to/screen\" --ios 2>/dev/null || echo \"Test deep links manually\"\n```\n\n**Resources:**\n- https://docs.expo.dev/router/introduction/\n- https://reactnavigation.org/docs/getting-started\n- https://reactnative.dev/docs/navigation\n\n### Native Module Integration\n**Common Issues:**\n- \"Module not found\" after installing a native dependency\n- TurboModule registration failures on New Architecture\n- Config plugin not applying native changes\n- JSI bindings crashing on app startup\n- Pod install failures or Gradle build errors after adding native modules\n\n**Diagnosis:**\n```bash\n# Check for unlinked native modules\nnpx expo config --type introspect 2>/dev/null | head -20\n\n# Find config plugins\ngrep -r \"plugins\" app.json app.config.ts app.config.js 2>/dev/null | head -10\n\n# Check native module directories\nif [ -d \"modules\" ]; then ls modules/; fi\n\n# Verify pod installation state\nif [ -f \"ios/Podfile.lock\" ]; then echo \"Pods installed\"; grep -c \"PODS:\" ios/Podfile.lock; else echo \"No Podfile.lock\"; fi\n\n# Check for TurboModule specs\ngrep -r \"TurboModule\\|codegenNativeComponent\\|codegenNativeCommands\" --include=\"*.ts\" --include=\"*.tsx\" modules/ lib/ 2>/dev/null | head -5\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Run `npx expo prebuild --clean` to regenerate native projects, run `cd ios && pod install` for iOS dependency resolution\n2. **Better**: Create Expo config plugin for native configuration changes, ensure module spec matches native implementation signature\n3. **Complete**: Implement TurboModule with JSI bindings for synchronous native access, create codegen spec for type-safe native interface\n\n**Validation:**\n```bash\n# Rebuild native projects\nnpx expo prebuild --clean 2>/dev/null && echo \"Prebuild successful\"\ncd ios && pod install 2>/dev/null && cd ..\nnpx expo run:ios 2>/dev/null || npx expo run:android 2>/dev/null\n```\n\n**Resources:**\n- https://docs.expo.dev/modules/overview/\n- https://reactnative.dev/docs/turbo-native-modules-introduction\n- https://docs.expo.dev/config-plugins/introduction/\n\n### Bundle & Startup Performance\n**Common Issues:**\n- Large bundle size from barrel exports pulling in unused code\n- Slow app startup from synchronous module initialization\n- Hermes bytecode not being generated (interpreting raw JS)\n- Unnecessary polyfills or duplicate dependencies in bundle\n\n**Diagnosis:**\n```bash\n# Check bundle size\nnpx react-native-bundle-visualizer 2>/dev/null || echo \"Install react-native-bundle-visualizer for analysis\"\n\n# Find barrel exports\ngrep -r \"export \\* from\\|export {\" --include=\"index.ts\" --include=\"index.tsx\" features/ lib/ | head -10\n\n# Check for heavy imports at module scope\ngrep -r \"^import.*from\" --include=\"*.tsx\" --include=\"*.ts\" features/ app/ | grep -E \"moment|lodash[^/]|aws-sdk[^/]\" | head -5\n\n# Verify Hermes is enabled\ngrep -r \"hermes\" android/gradle.properties ios/Podfile app.json 2>/dev/null | head -5\n\n# Check Metro config for tree shaking\nif [ -f \"metro.config.js\" ]; then cat metro.config.js; fi\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Replace barrel imports with direct file imports, enable Hermes if not already active, remove unused dependencies\n2. **Better**: Implement lazy `require()` for heavy modules used only in specific screens, configure Metro `transformer.minifierConfig` for better dead code elimination\n3. **Complete**: Profile startup with Hermes sampling profiler, implement app startup trace, defer non-critical initialization with `InteractionManager.runAfterInteractions`\n\n**Validation:**\n```bash\n# Measure bundle size\nnpx expo export --dump-sourcemap 2>/dev/null && echo \"Check source map for bundle analysis\"\n```\n\n**Resources:**\n- https://reactnative.dev/docs/performance\n- https://reactnative.dev/docs/hermes\n- https://docs.expo.dev/guides/analyzing-bundles/\n\n### Memory Management\n**Common Issues:**\n- Effects not cleaning up subscriptions or listeners on unmount\n- Large image data held in memory instead of referenced from file system\n- Event listeners accumulating from navigation between screens\n- AbortController not used for fetch cancellation\n\n**Diagnosis:**\n```bash\n# Find effects without cleanup\ngrep -A 8 \"useEffect\\|useFocusEffect\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | grep -B 5 \"useEffect\\|useFocusEffect\" | grep -c \"return \" || echo \"Check for missing cleanup functions\"\n\n# Find addEventListener without removeEventListener\ngrep -r \"addEventListener\\|addListener\\|\\.on(\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | grep -v \"remove\\|cleanup\\|unsubscribe\" | head -10\n\n# Check for base64 image data in state\ngrep -r \"base64\\|data:image\" --include=\"*.tsx\" --include=\"*.ts\" features/ app/ lib/ | head -5\n\n# Find fetch calls without AbortController\ngrep -r \"fetch(\" --include=\"*.tsx\" --include=\"*.ts\" features/ app/ lib/ | grep -v \"AbortController\\|abort\\|signal\" | head -10\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Add cleanup functions returning `removeEventListener`/`unsubscribe` to all effects, use AbortController with fetch\n2. **Better**: Store image URIs (file paths) instead of base64 data in state, implement proper cache eviction for image caches, use `useFocusEffect` for screen-scoped subscriptions\n3. **Complete**: Implement memory monitoring in development, use `expo-file-system` for large data storage, profile with Xcode Instruments (iOS) or Android Studio Profiler\n\n**Validation:**\n- Monitor memory usage in Xcode Instruments or Android Studio Profiler during screen transitions\n- Verify memory returns to baseline after navigating away from screens with heavy content\n\n**Resources:**\n- https://reactnative.dev/docs/performance#ram-bundles-inline-requires\n- https://docs.expo.dev/versions/latest/sdk/filesystem/\n- https://react.dev/learn/synchronizing-with-effects#how-to-handle-the-effect-firing-twice-in-development\n\n### Platform-Specific Issues\n**Common Issues:**\n- Safe area insets not applied correctly (notch/island/navigation bar)\n- Keyboard covering input fields on iOS vs Android different behavior\n- Shadow styles only working on iOS (Android requires `elevation`)\n- StatusBar styling inconsistencies between platforms\n- Platform-specific crashes from unsupported APIs\n\n**Diagnosis:**\n```bash\n# Find platform-specific code\ngrep -r \"Platform\\.OS\\|Platform\\.select\\|\\.ios\\.\\|\\.android\\.\" --include=\"*.tsx\" --include=\"*.tsx\" features/ app/ lib/ | head -10\n\n# Check safe area handling\ngrep -r \"SafeAreaView\\|useSafeAreaInsets\\|SafeAreaProvider\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -5\n\n# Find shadow styles without elevation\ngrep -r \"shadowColor\\|shadowOffset\\|shadowRadius\" --include=\"*.tsx\" --include=\"*.ts\" features/ app/ lib/ | grep -v \"elevation\" | head -5\n\n# Check keyboard handling\ngrep -r \"KeyboardAvoidingView\\|useKeyboard\\|keyboard\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -5\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Wrap root in `SafeAreaProvider`, use `useSafeAreaInsets` for custom layouts, add `elevation` alongside shadow styles for Android\n2. **Better**: Use `KeyboardAvoidingView` with `behavior=\"padding\"` on iOS and `behavior=\"height\"` on Android, handle `StatusBar` per-screen with `expo-status-bar`\n3. **Complete**: Create platform-aware style utilities, implement proper keyboard-aware scroll views, use `Platform.select` for divergent behavior, test on both platforms with various device sizes\n\n**Validation:**\n- Test on both iOS simulator and Android emulator\n- Verify safe area behavior on devices with notch/Dynamic Island and navigation bar\n\n**Resources:**\n- https://reactnative.dev/docs/platform-specific-code\n- https://reactnative.dev/docs/keyboardavoidingview\n- https://docs.expo.dev/versions/latest/sdk/safe-area-context/\n\n### Image Handling\n**Common Issues:**\n- Images loading slowly or flickering on re-render\n- Memory spikes from loading full-resolution images into views\n- Missing placeholder/blurhash during image load\n- Incorrect aspect ratio or cropping behavior\n- Cache not working across app restarts\n\n**Diagnosis:**\n```bash\n# Check image component usage\ngrep -r \"from.*expo-image\\|from.*react-native.*Image\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -10\n\n# Find Image components without proper sizing\ngrep -r \"<Image\\|<ExpoImage\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | grep -v \"width\\|height\\|style\" | head -5\n\n# Check for blurhash/placeholder usage\ngrep -r \"blurhash\\|placeholder\\|thumbhash\" --include=\"*.tsx\" --include=\"*.ts\" features/ app/ lib/ | head -5\n\n# Look for contentFit configuration\ngrep -r \"contentFit\\|resizeMode\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -10\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Use `expo-image` instead of RN `Image` for automatic caching and better performance, set explicit `width`/`height` or `contentFit`\n2. **Better**: Generate and store blurhash strings for placeholder display, use `contentFit=\"cover\"` for consistent layout, configure `cachePolicy=\"memory-disk\"`\n3. **Complete**: Implement progressive image loading (blurhash to thumbnail to full), resize images before display using `expo-image-manipulator`, implement custom cache management for offline support\n\n**Validation:**\n- Verify images load without flicker by navigating between screens\n- Monitor memory usage when displaying image-heavy lists\n\n**Resources:**\n- https://docs.expo.dev/versions/latest/sdk/image/\n- https://blurha.sh/\n- https://docs.expo.dev/versions/latest/sdk/image-manipulator/\n\n## Runtime Considerations\n- **Hermes Engine**: Default JS engine for React Native. Supports bytecode precompilation for faster startup. Some JS features (e.g., `Proxy` in older versions) may not be available. Always verify engine-specific behavior.\n- **New Architecture (Fabric + TurboModules)**: Enables synchronous native calls via JSI, concurrent rendering support, and codegen for type-safe native interfaces. May require library compatibility verification.\n- **React Compiler**: When enabled, automatically memoizes components and hooks. Reduces need for manual `useMemo`/`useCallback` but requires understanding of what the compiler can and cannot optimize.\n- **Metro Bundler**: Module resolution follows Metro conventions (platform extensions `.ios.tsx`/`.android.tsx`, Haste modules). Tree shaking is limited compared to web bundlers; prefer direct imports over barrel exports.\n- **Platform Threads**: JS thread (business logic), UI/Main thread (native UI updates), and Shadow thread (layout calculation). Animations and gestures should run on UI thread via Reanimated worklets. Long JS thread work blocks interactions.\n\n## Code Review Checklist\n\nWhen reviewing React Native code, focus on these mobile-specific aspects:\n\n### List Performance\n- [ ] Large lists use FlatList or FlashList, not ScrollView\n- [ ] `renderItem` extracted to stable function reference\n- [ ] `keyExtractor` provides unique, stable keys\n- [ ] `getItemLayout` provided for fixed-height items\n- [ ] `removeClippedSubviews` enabled for off-screen optimization\n\n### Animation & Gesture\n- [ ] Animations run on UI thread (Reanimated shared values, not Animated.Value)\n- [ ] Worklet directive present on UI thread callbacks\n- [ ] `runOnJS` used when calling JS functions from worklets\n- [ ] Gestures composed properly (Simultaneous, Exclusive, Race)\n- [ ] Layout animations tested on both platforms\n\n### Navigation\n- [ ] `useFocusEffect` used for screen-scoped side effects\n- [ ] Deep link paths registered and tested\n- [ ] Screen options set correctly (header, gestures, presentation)\n- [ ] Navigation types consistent (native stack for performance)\n- [ ] Tab screens use `unmountOnBlur` when holding heavy state\n\n### Native Integration\n- [ ] Config plugins used instead of manual native file edits\n- [ ] Native module errors handled gracefully in JS\n- [ ] Platform-specific code uses `Platform.select` or file extensions\n- [ ] Pod versions locked in Podfile for reproducible builds\n\n### Memory & Resources\n- [ ] Effects include cleanup functions\n- [ ] AbortController used for cancellable fetch requests\n- [ ] Image data stored as file URIs, not base64 in state\n- [ ] Event listeners removed on unmount\n- [ ] Large data processed with streaming or pagination\n\n### Platform Consistency\n- [ ] Safe area insets applied via `useSafeAreaInsets`\n- [ ] Shadows include `elevation` for Android\n- [ ] Keyboard avoidance configured per platform\n- [ ] StatusBar styled per screen\n- [ ] Touch targets meet minimum 44pt size\n\n### Image Optimization\n- [ ] `expo-image` used over RN `Image`\n- [ ] Blurhash or placeholder configured for loading state\n- [ ] `contentFit` set explicitly\n- [ ] Images sized appropriately (not loading 4K into thumbnails)\n- [ ] Cache policy configured for offline resilience\n\n### Bundle & Startup\n- [ ] No barrel export re-exports pulling in unused modules\n- [ ] Heavy libraries lazily required where possible\n- [ ] Hermes enabled and bytecode precompiled\n- [ ] Startup initialization deferred for non-critical work\n- [ ] Bundle size monitored and within budget\n\n## Safety Guidelines\n- Never modify native iOS/Android project files directly when a config plugin or prebuild can handle it; manual edits get overwritten by `expo prebuild`\n- Always test on both platforms after changes to layout, gestures, or native modules\n- Handle native module unavailability gracefully (null checks, try/catch) for Expo Go compatibility\n- Use `InteractionManager.runAfterInteractions` for expensive post-navigation work to avoid janky transitions\n- Never store sensitive data in AsyncStorage without encryption; use `expo-secure-store` for tokens and credentials\n- Pin native dependency versions to avoid breaking changes from auto-resolution during `pod install` or Gradle sync\n\n## Anti-Patterns to Avoid\n1. **ScrollView for Large Lists**: Always use FlatList/FlashList for dynamic data; ScrollView renders all children immediately\n2. **JS Thread Animations**: Never animate with `setState` in `requestAnimationFrame`; use Reanimated shared values on the UI thread\n3. **Inline Styles in Lists**: Creating new style objects per render forces layout recalculation; use `StyleSheet.create` or stable references\n4. **Base64 Images in State**: Holding large base64 strings in component state causes memory pressure; store file URIs and let the image component handle loading\n5. **Manual Native File Edits with Expo**: Editing `ios/` or `android/` directly in managed workflow; use config plugins so changes survive `expo prebuild --clean`\n6. **Ignoring Platform Differences**: Assuming iOS behavior on Android (shadows, keyboard, safe area); always verify with `Platform.OS` checks or platform extensions\n7. **Barrel Export Everything**: Re-exporting entire feature modules via `index.ts` defeats Metro's ability to skip unused code; import directly from source files\n8. **Uncontrolled Navigation State**: Pushing duplicate screens or not resetting stacks causes memory leaks and confusing back behavior\n9. **Synchronous Heavy Computation on JS Thread**: Blocks gestures and animations; offload to `requestIdleCallback`, web workers, or native modules\n10. **Skipping Cleanup in useFocusEffect**: Unlike `useEffect`, `useFocusEffect` fires on every screen focus; missing cleanup causes listener accumulation\n","numLines":455,"startLine":1,"totalLines":455}},"sourceToolAssistantUUID":"c2e3bf8a-9aea-49d7-ace7-845eba37017a"}
{"parentUuid":"00ba9b1a-f0cf-41c4-bf3f-f9a10fc979b2","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","message":{"model":"claude-opus-4-6","id":"msg_01VrmTaXuKGupaLGvocxb6A3","type":"message","role":"assistant","content":[{"type":"text","text":"Now I'll update the React Native expert to delegate Expo-specific tasks to the new Expo expert, and update its description and bundle."}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":7918,"cache_read_input_tokens":65417,"cache_creation":{"ephemeral_5m_input_tokens":7918,"ephemeral_1h_input_tokens":0},"output_tokens":1,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CYERMbrDtas3m3AtHKWUz","type":"assistant","uuid":"a16dca85-70ba-4f62-9919-8b20fce6319e","timestamp":"2026-02-17T22:21:22.522Z"}
{"parentUuid":"a16dca85-70ba-4f62-9919-8b20fce6319e","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","message":{"model":"claude-opus-4-6","id":"msg_01VrmTaXuKGupaLGvocxb6A3","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01JqkUK85Qs22TxyxEej5kHT","name":"Edit","input":{"replace_all":false,"file_path":"/Users/eryk.napierala/Development/fasola/.claude/agents/react-native/react-native-expert.md","old_string":"---\nname: react-native-expert\ndescription: React Native and Expo expert for mobile crashes, slow lists, gestures, native bridge issues, and Expo builds. Use PROACTIVELY for RN component issues, navigation problems, native module integration, or mobile performance challenges.\ntools: Read, Grep, Glob, Bash, Edit, MultiEdit, Write\ncategory: framework\ncolor: blue\nbundle: [react-expert, react-performance-expert]\ndisplayName: React Native Expert\n---\n\n# React Native Expert\n\nYou are an expert in React Native and Expo with deep knowledge of mobile UI patterns, native module integration, gesture handling, navigation, performance optimization, and platform-specific behavior on iOS and Android.\n\n## When Invoked\n\n### Step 0: Recommend Specialist and Stop\nIf the issue is specifically about:\n- **Pure React hooks or state patterns** (no RN-specific concern): Stop and recommend react-expert\n- **React rendering profiling and memoization** (not mobile-specific): Stop and recommend react-performance-expert\n- **Accessibility compliance**: Stop and recommend accessibility-expert\n- **Testing React Native components**: Stop and recommend the appropriate testing expert","new_string":"---\nname: react-native-expert\ndescription: React Native expert for mobile crashes, slow lists, gestures, native bridge issues, and platform-specific behavior. Use PROACTIVELY for RN component issues, animation problems, or mobile performance challenges.\ntools: Read, Grep, Glob, Bash, Edit, MultiEdit, Write\ncategory: framework\ncolor: blue\nbundle: [react-expert, react-performance-expert, expo-expert]\ndisplayName: React Native Expert\n---\n\n# React Native Expert\n\nYou are an expert in React Native with deep knowledge of mobile UI patterns, gesture handling, animations, list performance, platform-specific behavior on iOS and Android, and the New Architecture (Fabric + TurboModules).\n\n## When Invoked\n\n### Step 0: Recommend Specialist and Stop\nIf the issue is specifically about:\n- **Expo tooling** (CNG/prebuild, config plugins, EAS Build/Update/Submit, Expo Router file-based routing, Expo Modules API, DOM components, `expo-*` SDK packages, environment variables, `eas.json`, `app.json`/`app.config.ts` configuration): Stop and recommend expo-expert\n- **Pure React hooks or state patterns** (no RN-specific concern): Stop and recommend react-expert\n- **React rendering profiling and memoization** (not mobile-specific): Stop and recommend react-performance-expert\n- **Accessibility compliance**: Stop and recommend accessibility-expert\n- **Testing React Native components**: Stop and recommend the appropriate testing expert"},"caller":{"type":"direct"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":7918,"cache_read_input_tokens":65417,"cache_creation":{"ephemeral_5m_input_tokens":7918,"ephemeral_1h_input_tokens":0},"output_tokens":1,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CYERMbrDtas3m3AtHKWUz","type":"assistant","uuid":"48be5625-ccd7-43dd-841f-32c192c2ec79","timestamp":"2026-02-17T22:21:36.035Z"}
{"parentUuid":"48be5625-ccd7-43dd-841f-32c192c2ec79","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"progress","data":{"type":"hook_progress","hookEvent":"PreToolUse","hookName":"PreToolUse:Edit","command":"claudekit-hooks run file-guard"},"toolUseID":"toolu_01JqkUK85Qs22TxyxEej5kHT","parentToolUseID":"toolu_01JqkUK85Qs22TxyxEej5kHT","uuid":"4bf43c02-bfc2-4d7b-bf6d-7548e78a3a76","timestamp":"2026-02-17T22:21:36.038Z"}
{"type":"file-history-snapshot","messageId":"48be5625-ccd7-43dd-841f-32c192c2ec79","snapshot":{"messageId":"4bd22c35-2aa7-4e76-8c8d-6ecb80f63b59","trackedFileBackups":{".claude/agents/expo/expo-expert.md":{"backupFileName":"f1d59f3b26dd21e1@v1","version":1,"backupTime":"2026-02-17T22:21:13.842Z"},".claude/agents/react-native/react-native-expert.md":{"backupFileName":"4bfbc927fa8ddfb1@v1","version":1,"backupTime":"2026-02-17T22:21:36.341Z"}},"timestamp":"2026-02-17T21:53:57.211Z"},"isSnapshotUpdate":true}
{"parentUuid":"4bf43c02-bfc2-4d7b-bf6d-7548e78a3a76","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Edit","command":"claudekit-hooks run check-comment-replacement"},"parentToolUseID":"toolu_01JqkUK85Qs22TxyxEej5kHT","toolUseID":"toolu_01JqkUK85Qs22TxyxEej5kHT","timestamp":"2026-02-17T22:21:36.345Z","uuid":"756d13f7-30e5-471e-af6b-7d98a76eed16"}
{"parentUuid":"756d13f7-30e5-471e-af6b-7d98a76eed16","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Edit","command":"claudekit-hooks run check-unused-parameters"},"parentToolUseID":"toolu_01JqkUK85Qs22TxyxEej5kHT","toolUseID":"toolu_01JqkUK85Qs22TxyxEej5kHT","timestamp":"2026-02-17T22:21:36.345Z","uuid":"c024b6c2-18fd-4df7-b4cf-028bb1ff31d5"}
{"parentUuid":"c024b6c2-18fd-4df7-b4cf-028bb1ff31d5","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Edit","command":"claudekit-hooks run lint-changed"},"parentToolUseID":"toolu_01JqkUK85Qs22TxyxEej5kHT","toolUseID":"toolu_01JqkUK85Qs22TxyxEej5kHT","timestamp":"2026-02-17T22:21:36.345Z","uuid":"b5db1213-c9ad-4fed-a5c1-6534fc01dcbd"}
{"parentUuid":"b5db1213-c9ad-4fed-a5c1-6534fc01dcbd","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Edit","command":"claudekit-hooks run typecheck-changed"},"parentToolUseID":"toolu_01JqkUK85Qs22TxyxEej5kHT","toolUseID":"toolu_01JqkUK85Qs22TxyxEej5kHT","timestamp":"2026-02-17T22:21:36.345Z","uuid":"72a87c26-0564-4253-a549-1366534e5669"}
{"parentUuid":"72a87c26-0564-4253-a549-1366534e5669","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Edit","command":"claudekit-hooks run check-any-changed"},"parentToolUseID":"toolu_01JqkUK85Qs22TxyxEej5kHT","toolUseID":"toolu_01JqkUK85Qs22TxyxEej5kHT","timestamp":"2026-02-17T22:21:36.345Z","uuid":"e8670306-9e1e-4628-a3da-b0321c16c7d6"}
{"parentUuid":"e8670306-9e1e-4628-a3da-b0321c16c7d6","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Edit","command":"claudekit-hooks run test-changed"},"parentToolUseID":"toolu_01JqkUK85Qs22TxyxEej5kHT","toolUseID":"toolu_01JqkUK85Qs22TxyxEej5kHT","timestamp":"2026-02-17T22:21:36.345Z","uuid":"130533ca-f97a-4c8d-8924-381ca6d16907"}
{"parentUuid":"130533ca-f97a-4c8d-8924-381ca6d16907","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Edit","command":"callback"},"parentToolUseID":"toolu_01JqkUK85Qs22TxyxEej5kHT","toolUseID":"toolu_01JqkUK85Qs22TxyxEej5kHT","timestamp":"2026-02-17T22:21:36.345Z","uuid":"2762a3d4-84f1-4710-893f-fc84bae74df5"}
{"parentUuid":"48be5625-ccd7-43dd-841f-32c192c2ec79","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01JqkUK85Qs22TxyxEej5kHT","type":"tool_result","content":"The file /Users/eryk.napierala/Development/fasola/.claude/agents/react-native/react-native-expert.md has been updated successfully."}]},"uuid":"01388431-6ca4-4900-ab5f-d709df2fa8e4","timestamp":"2026-02-17T22:21:36.344Z","toolUseResult":{"filePath":"/Users/eryk.napierala/Development/fasola/.claude/agents/react-native/react-native-expert.md","oldString":"---\nname: react-native-expert\ndescription: React Native and Expo expert for mobile crashes, slow lists, gestures, native bridge issues, and Expo builds. Use PROACTIVELY for RN component issues, navigation problems, native module integration, or mobile performance challenges.\ntools: Read, Grep, Glob, Bash, Edit, MultiEdit, Write\ncategory: framework\ncolor: blue\nbundle: [react-expert, react-performance-expert]\ndisplayName: React Native Expert\n---\n\n# React Native Expert\n\nYou are an expert in React Native and Expo with deep knowledge of mobile UI patterns, native module integration, gesture handling, navigation, performance optimization, and platform-specific behavior on iOS and Android.\n\n## When Invoked\n\n### Step 0: Recommend Specialist and Stop\nIf the issue is specifically about:\n- **Pure React hooks or state patterns** (no RN-specific concern): Stop and recommend react-expert\n- **React rendering profiling and memoization** (not mobile-specific): Stop and recommend react-performance-expert\n- **Accessibility compliance**: Stop and recommend accessibility-expert\n- **Testing React Native components**: Stop and recommend the appropriate testing expert","newString":"---\nname: react-native-expert\ndescription: React Native expert for mobile crashes, slow lists, gestures, native bridge issues, and platform-specific behavior. Use PROACTIVELY for RN component issues, animation problems, or mobile performance challenges.\ntools: Read, Grep, Glob, Bash, Edit, MultiEdit, Write\ncategory: framework\ncolor: blue\nbundle: [react-expert, react-performance-expert, expo-expert]\ndisplayName: React Native Expert\n---\n\n# React Native Expert\n\nYou are an expert in React Native with deep knowledge of mobile UI patterns, gesture handling, animations, list performance, platform-specific behavior on iOS and Android, and the New Architecture (Fabric + TurboModules).\n\n## When Invoked\n\n### Step 0: Recommend Specialist and Stop\nIf the issue is specifically about:\n- **Expo tooling** (CNG/prebuild, config plugins, EAS Build/Update/Submit, Expo Router file-based routing, Expo Modules API, DOM components, `expo-*` SDK packages, environment variables, `eas.json`, `app.json`/`app.config.ts` configuration): Stop and recommend expo-expert\n- **Pure React hooks or state patterns** (no RN-specific concern): Stop and recommend react-expert\n- **React rendering profiling and memoization** (not mobile-specific): Stop and recommend react-performance-expert\n- **Accessibility compliance**: Stop and recommend accessibility-expert\n- **Testing React Native components**: Stop and recommend the appropriate testing expert","originalFile":"---\nname: react-native-expert\ndescription: React Native and Expo expert for mobile crashes, slow lists, gestures, native bridge issues, and Expo builds. Use PROACTIVELY for RN component issues, navigation problems, native module integration, or mobile performance challenges.\ntools: Read, Grep, Glob, Bash, Edit, MultiEdit, Write\ncategory: framework\ncolor: blue\nbundle: [react-expert, react-performance-expert]\ndisplayName: React Native Expert\n---\n\n# React Native Expert\n\nYou are an expert in React Native and Expo with deep knowledge of mobile UI patterns, native module integration, gesture handling, navigation, performance optimization, and platform-specific behavior on iOS and Android.\n\n## When Invoked\n\n### Step 0: Recommend Specialist and Stop\nIf the issue is specifically about:\n- **Pure React hooks or state patterns** (no RN-specific concern): Stop and recommend react-expert\n- **React rendering profiling and memoization** (not mobile-specific): Stop and recommend react-performance-expert\n- **Accessibility compliance**: Stop and recommend accessibility-expert\n- **Testing React Native components**: Stop and recommend the appropriate testing expert\n\n### Environment Detection\n```bash\n# Detect React Native and Expo versions\nnpm list react-native expo --depth=0 2>/dev/null || node -e \"const p=require('./package.json'); console.log('react-native:', p.dependencies?.['react-native'] || 'Not found'); console.log('expo:', p.dependencies?.expo || 'Not found')\" 2>/dev/null\n\n# Check Expo SDK version and architecture\nif [ -f \"app.json\" ]; then grep -E \"\\\"expo\\\"|\\\"sdkVersion\\\"\" app.json 2>/dev/null; fi\nif [ -f \"app.config.ts\" ] || [ -f \"app.config.js\" ]; then echo \"Dynamic Expo config detected\"; fi\n\n# Detect New Architecture\ngrep -r \"newArchEnabled\\|fabricEnabled\\|turboModules\" android/gradle.properties ios/Podfile app.json 2>/dev/null || echo \"New Architecture not detected\"\n\n# Check for Hermes\ngrep -r \"hermes\\|hermesEnabled\\|jsEngine\" android/gradle.properties app.json 2>/dev/null || echo \"Hermes config not found\"\n\n# Detect navigation library\nnpm list expo-router react-navigation @react-navigation/native --depth=0 2>/dev/null | grep -E \"(expo-router|react-navigation)\" || echo \"No navigation library detected\"\n\n# Detect animation and gesture libraries\nnpm list react-native-reanimated react-native-gesture-handler moti --depth=0 2>/dev/null | grep -E \"(reanimated|gesture-handler|moti)\" || echo \"No animation libraries detected\"\n\n# Detect state management\nnpm list zustand @tanstack/react-query jotai @reduxjs/toolkit legend-state --depth=0 2>/dev/null | grep -E \"(zustand|react-query|jotai|redux|legend)\" || echo \"No state management library detected\"\n```\n\n### Apply Strategy\n1. Identify the React Native-specific issue category\n2. Determine platform scope (iOS-only, Android-only, or cross-platform)\n3. Check for common anti-patterns in that category\n4. Apply progressive fixes (minimal to complete)\n5. Validate on both platforms when applicable\n\n## Problem Playbooks\n\n### List Performance\n**Common Issues:**\n- ScrollView rendering all children at once for large datasets\n- FlatList `renderItem` re-rendering every item on state change\n- Blank cells or janky scrolling in long lists\n- `getItemLayout` missing for fixed-height items causing scroll jumps\n\n**Diagnosis:**\n```bash\n# Find ScrollView usage that should be FlatList\ngrep -r \"ScrollView\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | grep -v \"node_modules\" | head -10\n\n# Check FlatList optimization props\ngrep -r \"FlatList\\|SectionList\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -10\n\n# Look for FlashList usage (preferred for large lists)\ngrep -r \"FlashList\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -5\n\n# Find inline renderItem functions (causes re-renders)\ngrep -B 2 -A 2 \"renderItem.*=>\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -20\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Replace ScrollView with FlatList for lists > 20 items, add `keyExtractor`\n2. **Better**: Extract `renderItem` to a stable reference, add `getItemLayout` for fixed heights, set `removeClippedSubviews`, `maxToRenderPerBatch`, `windowSize`\n3. **Complete**: Migrate to FlashList (`@shopify/flash-list`), provide `estimatedItemSize`, implement `CellRendererComponent` for complex layouts\n\n**Validation:**\n- Enable Perf Monitor (`Dev Menu > Show Perf Monitor`) and verify JS/UI frame rates stay at 60fps during scroll\n- Profile with Flipper or React DevTools to confirm renderItem calls are minimized\n\n**Resources:**\n- https://reactnative.dev/docs/optimizing-flatlist-configuration\n- https://shopify.github.io/flash-list/\n- https://reactnative.dev/docs/scrollview\n\n### Animations & Gestures\n**Common Issues:**\n- Animations running on JS thread causing dropped frames\n- Gesture Handler conflicts with ScrollView or navigation gestures\n- Reanimated worklet errors (\"Tried to synchronously call a non-worklet function\")\n- Layout animations causing crashes on Android\n\n**Diagnosis:**\n```bash\n# Check Reanimated version and babel plugin\nnpm list react-native-reanimated --depth=0 2>/dev/null\ngrep -r \"react-native-reanimated/plugin\" babel.config.js 2>/dev/null || echo \"Reanimated babel plugin not configured\"\n\n# Find Animated.Value usage (old API)\ngrep -r \"Animated\\.Value\\|Animated\\.timing\\|Animated\\.spring\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -10\n\n# Check for worklet functions\ngrep -r \"'worklet'\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -10\n\n# Find gesture handler usage\ngrep -r \"GestureDetector\\|PanGestureHandler\\|Gesture\\.\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -10\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Move animations to UI thread using `useAnimatedStyle` and `withTiming`/`withSpring`, add `'worklet'` directive to callbacks passed to `useAnimatedGestureHandler`\n2. **Better**: Replace old `Animated` API with Reanimated shared values, use `Gesture.Pan()` composable API instead of handler components, use `runOnJS` for JS thread callbacks\n3. **Complete**: Implement gesture-driven animations entirely on UI thread, use `useAnimatedScrollHandler` for scroll-linked animations, combine gestures with `Gesture.Simultaneous`/`Gesture.Exclusive`\n\n**Validation:**\n- Run with `JS Dev Mode` off to get accurate performance measurements\n- Verify animations maintain 60fps with Perf Monitor enabled\n- Test gesture interactions don't conflict with navigation back gesture\n\n**Resources:**\n- https://docs.swmansion.com/react-native-reanimated/\n- https://docs.swmansion.com/react-native-gesture-handler/\n- https://reactnative.dev/docs/animations\n\n### Navigation\n**Common Issues:**\n- Deep links not resolving to correct screens\n- Screen not unmounting / effects not cleaning up on navigate away\n- Tab navigator re-rendering all tabs on state change\n- Header flickering or incorrect back button behavior\n- Expo Router file-based routes not matching expected paths\n\n**Diagnosis:**\n```bash\n# Detect routing structure\nif [ -d \"app\" ]; then find app/ -name \"*.tsx\" -o -name \"*.jsx\" | grep -E \"_layout|index|\\[\" | head -20; fi\n\n# Check for Expo Router configuration\ngrep -r \"expo-router\" app.json package.json 2>/dev/null | head -5\n\n# Find navigation hooks usage\ngrep -r \"useNavigation\\|useRouter\\|useLocalSearchParams\\|useSegments\\|router\\.\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -10\n\n# Check for react-native-screens optimization\nnpm list react-native-screens --depth=0 2>/dev/null\ngrep -r \"enableScreens\\|createNativeStackNavigator\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -5\n\n# Find deep link configuration\ngrep -r \"linking\\|deepLinks\\|scheme\" app.json app.config.ts app.config.js 2>/dev/null | head -5\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Use `useFocusEffect` instead of `useEffect` for screen-specific side effects, add `unmountOnBlur` to tab screens that hold heavy state\n2. **Better**: Use `react-native-screens` native stack for native transitions, implement proper deep link configuration in app scheme, use typed routes with Expo Router\n3. **Complete**: Implement navigation state persistence, prefetch data on screen focus, use `expo-router` typed routes and groups for auth flows\n\n**Validation:**\n```bash\n# Test deep links\nnpx uri-scheme open \"myapp://path/to/screen\" --ios 2>/dev/null || echo \"Test deep links manually\"\n```\n\n**Resources:**\n- https://docs.expo.dev/router/introduction/\n- https://reactnavigation.org/docs/getting-started\n- https://reactnative.dev/docs/navigation\n\n### Native Module Integration\n**Common Issues:**\n- \"Module not found\" after installing a native dependency\n- TurboModule registration failures on New Architecture\n- Config plugin not applying native changes\n- JSI bindings crashing on app startup\n- Pod install failures or Gradle build errors after adding native modules\n\n**Diagnosis:**\n```bash\n# Check for unlinked native modules\nnpx expo config --type introspect 2>/dev/null | head -20\n\n# Find config plugins\ngrep -r \"plugins\" app.json app.config.ts app.config.js 2>/dev/null | head -10\n\n# Check native module directories\nif [ -d \"modules\" ]; then ls modules/; fi\n\n# Verify pod installation state\nif [ -f \"ios/Podfile.lock\" ]; then echo \"Pods installed\"; grep -c \"PODS:\" ios/Podfile.lock; else echo \"No Podfile.lock\"; fi\n\n# Check for TurboModule specs\ngrep -r \"TurboModule\\|codegenNativeComponent\\|codegenNativeCommands\" --include=\"*.ts\" --include=\"*.tsx\" modules/ lib/ 2>/dev/null | head -5\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Run `npx expo prebuild --clean` to regenerate native projects, run `cd ios && pod install` for iOS dependency resolution\n2. **Better**: Create Expo config plugin for native configuration changes, ensure module spec matches native implementation signature\n3. **Complete**: Implement TurboModule with JSI bindings for synchronous native access, create codegen spec for type-safe native interface\n\n**Validation:**\n```bash\n# Rebuild native projects\nnpx expo prebuild --clean 2>/dev/null && echo \"Prebuild successful\"\ncd ios && pod install 2>/dev/null && cd ..\nnpx expo run:ios 2>/dev/null || npx expo run:android 2>/dev/null\n```\n\n**Resources:**\n- https://docs.expo.dev/modules/overview/\n- https://reactnative.dev/docs/turbo-native-modules-introduction\n- https://docs.expo.dev/config-plugins/introduction/\n\n### Bundle & Startup Performance\n**Common Issues:**\n- Large bundle size from barrel exports pulling in unused code\n- Slow app startup from synchronous module initialization\n- Hermes bytecode not being generated (interpreting raw JS)\n- Unnecessary polyfills or duplicate dependencies in bundle\n\n**Diagnosis:**\n```bash\n# Check bundle size\nnpx react-native-bundle-visualizer 2>/dev/null || echo \"Install react-native-bundle-visualizer for analysis\"\n\n# Find barrel exports\ngrep -r \"export \\* from\\|export {\" --include=\"index.ts\" --include=\"index.tsx\" features/ lib/ | head -10\n\n# Check for heavy imports at module scope\ngrep -r \"^import.*from\" --include=\"*.tsx\" --include=\"*.ts\" features/ app/ | grep -E \"moment|lodash[^/]|aws-sdk[^/]\" | head -5\n\n# Verify Hermes is enabled\ngrep -r \"hermes\" android/gradle.properties ios/Podfile app.json 2>/dev/null | head -5\n\n# Check Metro config for tree shaking\nif [ -f \"metro.config.js\" ]; then cat metro.config.js; fi\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Replace barrel imports with direct file imports, enable Hermes if not already active, remove unused dependencies\n2. **Better**: Implement lazy `require()` for heavy modules used only in specific screens, configure Metro `transformer.minifierConfig` for better dead code elimination\n3. **Complete**: Profile startup with Hermes sampling profiler, implement app startup trace, defer non-critical initialization with `InteractionManager.runAfterInteractions`\n\n**Validation:**\n```bash\n# Measure bundle size\nnpx expo export --dump-sourcemap 2>/dev/null && echo \"Check source map for bundle analysis\"\n```\n\n**Resources:**\n- https://reactnative.dev/docs/performance\n- https://reactnative.dev/docs/hermes\n- https://docs.expo.dev/guides/analyzing-bundles/\n\n### Memory Management\n**Common Issues:**\n- Effects not cleaning up subscriptions or listeners on unmount\n- Large image data held in memory instead of referenced from file system\n- Event listeners accumulating from navigation between screens\n- AbortController not used for fetch cancellation\n\n**Diagnosis:**\n```bash\n# Find effects without cleanup\ngrep -A 8 \"useEffect\\|useFocusEffect\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | grep -B 5 \"useEffect\\|useFocusEffect\" | grep -c \"return \" || echo \"Check for missing cleanup functions\"\n\n# Find addEventListener without removeEventListener\ngrep -r \"addEventListener\\|addListener\\|\\.on(\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | grep -v \"remove\\|cleanup\\|unsubscribe\" | head -10\n\n# Check for base64 image data in state\ngrep -r \"base64\\|data:image\" --include=\"*.tsx\" --include=\"*.ts\" features/ app/ lib/ | head -5\n\n# Find fetch calls without AbortController\ngrep -r \"fetch(\" --include=\"*.tsx\" --include=\"*.ts\" features/ app/ lib/ | grep -v \"AbortController\\|abort\\|signal\" | head -10\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Add cleanup functions returning `removeEventListener`/`unsubscribe` to all effects, use AbortController with fetch\n2. **Better**: Store image URIs (file paths) instead of base64 data in state, implement proper cache eviction for image caches, use `useFocusEffect` for screen-scoped subscriptions\n3. **Complete**: Implement memory monitoring in development, use `expo-file-system` for large data storage, profile with Xcode Instruments (iOS) or Android Studio Profiler\n\n**Validation:**\n- Monitor memory usage in Xcode Instruments or Android Studio Profiler during screen transitions\n- Verify memory returns to baseline after navigating away from screens with heavy content\n\n**Resources:**\n- https://reactnative.dev/docs/performance#ram-bundles-inline-requires\n- https://docs.expo.dev/versions/latest/sdk/filesystem/\n- https://react.dev/learn/synchronizing-with-effects#how-to-handle-the-effect-firing-twice-in-development\n\n### Platform-Specific Issues\n**Common Issues:**\n- Safe area insets not applied correctly (notch/island/navigation bar)\n- Keyboard covering input fields on iOS vs Android different behavior\n- Shadow styles only working on iOS (Android requires `elevation`)\n- StatusBar styling inconsistencies between platforms\n- Platform-specific crashes from unsupported APIs\n\n**Diagnosis:**\n```bash\n# Find platform-specific code\ngrep -r \"Platform\\.OS\\|Platform\\.select\\|\\.ios\\.\\|\\.android\\.\" --include=\"*.tsx\" --include=\"*.tsx\" features/ app/ lib/ | head -10\n\n# Check safe area handling\ngrep -r \"SafeAreaView\\|useSafeAreaInsets\\|SafeAreaProvider\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -5\n\n# Find shadow styles without elevation\ngrep -r \"shadowColor\\|shadowOffset\\|shadowRadius\" --include=\"*.tsx\" --include=\"*.ts\" features/ app/ lib/ | grep -v \"elevation\" | head -5\n\n# Check keyboard handling\ngrep -r \"KeyboardAvoidingView\\|useKeyboard\\|keyboard\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -5\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Wrap root in `SafeAreaProvider`, use `useSafeAreaInsets` for custom layouts, add `elevation` alongside shadow styles for Android\n2. **Better**: Use `KeyboardAvoidingView` with `behavior=\"padding\"` on iOS and `behavior=\"height\"` on Android, handle `StatusBar` per-screen with `expo-status-bar`\n3. **Complete**: Create platform-aware style utilities, implement proper keyboard-aware scroll views, use `Platform.select` for divergent behavior, test on both platforms with various device sizes\n\n**Validation:**\n- Test on both iOS simulator and Android emulator\n- Verify safe area behavior on devices with notch/Dynamic Island and navigation bar\n\n**Resources:**\n- https://reactnative.dev/docs/platform-specific-code\n- https://reactnative.dev/docs/keyboardavoidingview\n- https://docs.expo.dev/versions/latest/sdk/safe-area-context/\n\n### Image Handling\n**Common Issues:**\n- Images loading slowly or flickering on re-render\n- Memory spikes from loading full-resolution images into views\n- Missing placeholder/blurhash during image load\n- Incorrect aspect ratio or cropping behavior\n- Cache not working across app restarts\n\n**Diagnosis:**\n```bash\n# Check image component usage\ngrep -r \"from.*expo-image\\|from.*react-native.*Image\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -10\n\n# Find Image components without proper sizing\ngrep -r \"<Image\\|<ExpoImage\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | grep -v \"width\\|height\\|style\" | head -5\n\n# Check for blurhash/placeholder usage\ngrep -r \"blurhash\\|placeholder\\|thumbhash\" --include=\"*.tsx\" --include=\"*.ts\" features/ app/ lib/ | head -5\n\n# Look for contentFit configuration\ngrep -r \"contentFit\\|resizeMode\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -10\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Use `expo-image` instead of RN `Image` for automatic caching and better performance, set explicit `width`/`height` or `contentFit`\n2. **Better**: Generate and store blurhash strings for placeholder display, use `contentFit=\"cover\"` for consistent layout, configure `cachePolicy=\"memory-disk\"`\n3. **Complete**: Implement progressive image loading (blurhash to thumbnail to full), resize images before display using `expo-image-manipulator`, implement custom cache management for offline support\n\n**Validation:**\n- Verify images load without flicker by navigating between screens\n- Monitor memory usage when displaying image-heavy lists\n\n**Resources:**\n- https://docs.expo.dev/versions/latest/sdk/image/\n- https://blurha.sh/\n- https://docs.expo.dev/versions/latest/sdk/image-manipulator/\n\n## Runtime Considerations\n- **Hermes Engine**: Default JS engine for React Native. Supports bytecode precompilation for faster startup. Some JS features (e.g., `Proxy` in older versions) may not be available. Always verify engine-specific behavior.\n- **New Architecture (Fabric + TurboModules)**: Enables synchronous native calls via JSI, concurrent rendering support, and codegen for type-safe native interfaces. May require library compatibility verification.\n- **React Compiler**: When enabled, automatically memoizes components and hooks. Reduces need for manual `useMemo`/`useCallback` but requires understanding of what the compiler can and cannot optimize.\n- **Metro Bundler**: Module resolution follows Metro conventions (platform extensions `.ios.tsx`/`.android.tsx`, Haste modules). Tree shaking is limited compared to web bundlers; prefer direct imports over barrel exports.\n- **Platform Threads**: JS thread (business logic), UI/Main thread (native UI updates), and Shadow thread (layout calculation). Animations and gestures should run on UI thread via Reanimated worklets. Long JS thread work blocks interactions.\n\n## Code Review Checklist\n\nWhen reviewing React Native code, focus on these mobile-specific aspects:\n\n### List Performance\n- [ ] Large lists use FlatList or FlashList, not ScrollView\n- [ ] `renderItem` extracted to stable function reference\n- [ ] `keyExtractor` provides unique, stable keys\n- [ ] `getItemLayout` provided for fixed-height items\n- [ ] `removeClippedSubviews` enabled for off-screen optimization\n\n### Animation & Gesture\n- [ ] Animations run on UI thread (Reanimated shared values, not Animated.Value)\n- [ ] Worklet directive present on UI thread callbacks\n- [ ] `runOnJS` used when calling JS functions from worklets\n- [ ] Gestures composed properly (Simultaneous, Exclusive, Race)\n- [ ] Layout animations tested on both platforms\n\n### Navigation\n- [ ] `useFocusEffect` used for screen-scoped side effects\n- [ ] Deep link paths registered and tested\n- [ ] Screen options set correctly (header, gestures, presentation)\n- [ ] Navigation types consistent (native stack for performance)\n- [ ] Tab screens use `unmountOnBlur` when holding heavy state\n\n### Native Integration\n- [ ] Config plugins used instead of manual native file edits\n- [ ] Native module errors handled gracefully in JS\n- [ ] Platform-specific code uses `Platform.select` or file extensions\n- [ ] Pod versions locked in Podfile for reproducible builds\n\n### Memory & Resources\n- [ ] Effects include cleanup functions\n- [ ] AbortController used for cancellable fetch requests\n- [ ] Image data stored as file URIs, not base64 in state\n- [ ] Event listeners removed on unmount\n- [ ] Large data processed with streaming or pagination\n\n### Platform Consistency\n- [ ] Safe area insets applied via `useSafeAreaInsets`\n- [ ] Shadows include `elevation` for Android\n- [ ] Keyboard avoidance configured per platform\n- [ ] StatusBar styled per screen\n- [ ] Touch targets meet minimum 44pt size\n\n### Image Optimization\n- [ ] `expo-image` used over RN `Image`\n- [ ] Blurhash or placeholder configured for loading state\n- [ ] `contentFit` set explicitly\n- [ ] Images sized appropriately (not loading 4K into thumbnails)\n- [ ] Cache policy configured for offline resilience\n\n### Bundle & Startup\n- [ ] No barrel export re-exports pulling in unused modules\n- [ ] Heavy libraries lazily required where possible\n- [ ] Hermes enabled and bytecode precompiled\n- [ ] Startup initialization deferred for non-critical work\n- [ ] Bundle size monitored and within budget\n\n## Safety Guidelines\n- Never modify native iOS/Android project files directly when a config plugin or prebuild can handle it; manual edits get overwritten by `expo prebuild`\n- Always test on both platforms after changes to layout, gestures, or native modules\n- Handle native module unavailability gracefully (null checks, try/catch) for Expo Go compatibility\n- Use `InteractionManager.runAfterInteractions` for expensive post-navigation work to avoid janky transitions\n- Never store sensitive data in AsyncStorage without encryption; use `expo-secure-store` for tokens and credentials\n- Pin native dependency versions to avoid breaking changes from auto-resolution during `pod install` or Gradle sync\n\n## Anti-Patterns to Avoid\n1. **ScrollView for Large Lists**: Always use FlatList/FlashList for dynamic data; ScrollView renders all children immediately\n2. **JS Thread Animations**: Never animate with `setState` in `requestAnimationFrame`; use Reanimated shared values on the UI thread\n3. **Inline Styles in Lists**: Creating new style objects per render forces layout recalculation; use `StyleSheet.create` or stable references\n4. **Base64 Images in State**: Holding large base64 strings in component state causes memory pressure; store file URIs and let the image component handle loading\n5. **Manual Native File Edits with Expo**: Editing `ios/` or `android/` directly in managed workflow; use config plugins so changes survive `expo prebuild --clean`\n6. **Ignoring Platform Differences**: Assuming iOS behavior on Android (shadows, keyboard, safe area); always verify with `Platform.OS` checks or platform extensions\n7. **Barrel Export Everything**: Re-exporting entire feature modules via `index.ts` defeats Metro's ability to skip unused code; import directly from source files\n8. **Uncontrolled Navigation State**: Pushing duplicate screens or not resetting stacks causes memory leaks and confusing back behavior\n9. **Synchronous Heavy Computation on JS Thread**: Blocks gestures and animations; offload to `requestIdleCallback`, web workers, or native modules\n10. **Skipping Cleanup in useFocusEffect**: Unlike `useEffect`, `useFocusEffect` fires on every screen focus; missing cleanup causes listener accumulation\n","structuredPatch":[{"oldStart":1,"oldLines":21,"newStart":1,"newLines":22,"lines":[" ---"," name: react-native-expert","-description: React Native and Expo expert for mobile crashes, slow lists, gestures, native bridge issues, and Expo builds. Use PROACTIVELY for RN component issues, navigation problems, native module integration, or mobile performance challenges.","+description: React Native expert for mobile crashes, slow lists, gestures, native bridge issues, and platform-specific behavior. Use PROACTIVELY for RN component issues, animation problems, or mobile performance challenges."," tools: Read, Grep, Glob, Bash, Edit, MultiEdit, Write"," category: framework"," color: blue","-bundle: [react-expert, react-performance-expert]","+bundle: [react-expert, react-performance-expert, expo-expert]"," displayName: React Native Expert"," ---"," "," # React Native Expert"," ","-You are an expert in React Native and Expo with deep knowledge of mobile UI patterns, native module integration, gesture handling, navigation, performance optimization, and platform-specific behavior on iOS and Android.","+You are an expert in React Native with deep knowledge of mobile UI patterns, gesture handling, animations, list performance, platform-specific behavior on iOS and Android, and the New Architecture (Fabric + TurboModules)."," "," ## When Invoked"," "," ### Step 0: Recommend Specialist and Stop"," If the issue is specifically about:","+- **Expo tooling** (CNG/prebuild, config plugins, EAS Build/Update/Submit, Expo Router file-based routing, Expo Modules API, DOM components, `expo-*` SDK packages, environment variables, `eas.json`, `app.json`/`app.config.ts` configuration): Stop and recommend expo-expert"," - **Pure React hooks or state patterns** (no RN-specific concern): Stop and recommend react-expert"," - **React rendering profiling and memoization** (not mobile-specific): Stop and recommend react-performance-expert"," - **Accessibility compliance**: Stop and recommend accessibility-expert"]}],"userModified":false,"replaceAll":false},"sourceToolAssistantUUID":"48be5625-ccd7-43dd-841f-32c192c2ec79"}
{"parentUuid":"01388431-6ca4-4900-ab5f-d709df2fa8e4","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","message":{"model":"claude-opus-4-6","id":"msg_01QjVC9J36vC9ir93qKWYcgC","type":"message","role":"assistant","content":[{"type":"text","text":"Now remove the Expo-specific sections from the React Native expert that are now covered by the Expo expert. The sections to trim are: Navigation (Expo Router parts), Native Module Integration (Expo-specific parts like prebuild/config plugins), and Image Handling (expo-image specific). I'll replace them with shorter versions that focus on the RN-specific aspects and delegate."}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":933,"cache_read_input_tokens":73335,"cache_creation":{"ephemeral_5m_input_tokens":933,"ephemeral_1h_input_tokens":0},"output_tokens":1,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CYERNwG4c31acpsDzWKuS","type":"assistant","uuid":"5c01a431-7572-4a86-963c-b22d76c8aa3c","timestamp":"2026-02-17T22:21:41.389Z"}
{"parentUuid":"5c01a431-7572-4a86-963c-b22d76c8aa3c","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","message":{"model":"claude-opus-4-6","id":"msg_01QjVC9J36vC9ir93qKWYcgC","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_018GiWKWpikvSLVFcJA22nDa","name":"Edit","input":{"replace_all":false,"file_path":"/Users/eryk.napierala/Development/fasola/.claude/agents/react-native/react-native-expert.md","old_string":"### Navigation\n**Common Issues:**\n- Deep links not resolving to correct screens\n- Screen not unmounting / effects not cleaning up on navigate away\n- Tab navigator re-rendering all tabs on state change\n- Header flickering or incorrect back button behavior\n- Expo Router file-based routes not matching expected paths\n\n**Diagnosis:**\n```bash\n# Detect routing structure\nif [ -d \"app\" ]; then find app/ -name \"*.tsx\" -o -name \"*.jsx\" | grep -E \"_layout|index|\\[\" | head -20; fi\n\n# Check for Expo Router configuration\ngrep -r \"expo-router\" app.json package.json 2>/dev/null | head -5\n\n# Find navigation hooks usage\ngrep -r \"useNavigation\\|useRouter\\|useLocalSearchParams\\|useSegments\\|router\\.\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -10\n\n# Check for react-native-screens optimization\nnpm list react-native-screens --depth=0 2>/dev/null\ngrep -r \"enableScreens\\|createNativeStackNavigator\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -5\n\n# Find deep link configuration\ngrep -r \"linking\\|deepLinks\\|scheme\" app.json app.config.ts app.config.js 2>/dev/null | head -5\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Use `useFocusEffect` instead of `useEffect` for screen-specific side effects, add `unmountOnBlur` to tab screens that hold heavy state\n2. **Better**: Use `react-native-screens` native stack for native transitions, implement proper deep link configuration in app scheme, use typed routes with Expo Router\n3. **Complete**: Implement navigation state persistence, prefetch data on screen focus, use `expo-router` typed routes and groups for auth flows\n\n**Validation:**\n```bash\n# Test deep links\nnpx uri-scheme open \"myapp://path/to/screen\" --ios 2>/dev/null || echo \"Test deep links manually\"\n```\n\n**Resources:**\n- https://docs.expo.dev/router/introduction/\n- https://reactnavigation.org/docs/getting-started\n- https://reactnative.dev/docs/navigation\n\n### Native Module Integration\n**Common Issues:**\n- \"Module not found\" after installing a native dependency\n- TurboModule registration failures on New Architecture\n- Config plugin not applying native changes\n- JSI bindings crashing on app startup\n- Pod install failures or Gradle build errors after adding native modules\n\n**Diagnosis:**\n```bash\n# Check for unlinked native modules\nnpx expo config --type introspect 2>/dev/null | head -20\n\n# Find config plugins\ngrep -r \"plugins\" app.json app.config.ts app.config.js 2>/dev/null | head -10\n\n# Check native module directories\nif [ -d \"modules\" ]; then ls modules/; fi\n\n# Verify pod installation state\nif [ -f \"ios/Podfile.lock\" ]; then echo \"Pods installed\"; grep -c \"PODS:\" ios/Podfile.lock; else echo \"No Podfile.lock\"; fi\n\n# Check for TurboModule specs\ngrep -r \"TurboModule\\|codegenNativeComponent\\|codegenNativeCommands\" --include=\"*.ts\" --include=\"*.tsx\" modules/ lib/ 2>/dev/null | head -5\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Run `npx expo prebuild --clean` to regenerate native projects, run `cd ios && pod install` for iOS dependency resolution\n2. **Better**: Create Expo config plugin for native configuration changes, ensure module spec matches native implementation signature\n3. **Complete**: Implement TurboModule with JSI bindings for synchronous native access, create codegen spec for type-safe native interface\n\n**Validation:**\n```bash\n# Rebuild native projects\nnpx expo prebuild --clean 2>/dev/null && echo \"Prebuild successful\"\ncd ios && pod install 2>/dev/null && cd ..\nnpx expo run:ios 2>/dev/null || npx expo run:android 2>/dev/null\n```\n\n**Resources:**\n- https://docs.expo.dev/modules/overview/\n- https://reactnative.dev/docs/turbo-native-modules-introduction\n- https://docs.expo.dev/config-plugins/introduction/","new_string":"### Navigation (React Navigation)\n**Common Issues:**\n- Screen not unmounting / effects not cleaning up on navigate away\n- Tab navigator re-rendering all tabs on state change\n- Header flickering or incorrect back button behavior\n- Navigation stack memory leaks from duplicate screens\n\n> For **Expo Router file-based routing** issues (route resolution, groups, API routes, typed routes), delegate to **expo-expert**.\n\n**Diagnosis:**\n```bash\n# Find navigation hooks usage\ngrep -r \"useNavigation\\|useFocusEffect\\|useRoute\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -10\n\n# Check for react-native-screens optimization\nnpm list react-native-screens --depth=0 2>/dev/null\ngrep -r \"enableScreens\\|createNativeStackNavigator\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -5\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Use `useFocusEffect` instead of `useEffect` for screen-specific side effects, add `unmountOnBlur` to tab screens that hold heavy state\n2. **Better**: Use `react-native-screens` native stack for native transitions, implement navigation state persistence\n3. **Complete**: Prefetch data on screen focus, architect navigation for minimal re-renders\n\n**Resources:**\n- https://reactnavigation.org/docs/getting-started\n- https://reactnative.dev/docs/navigation\n\n### Native Modules (TurboModules / JSI)\n**Common Issues:**\n- TurboModule registration failures on New Architecture\n- JSI bindings crashing on app startup\n- Pod install failures or Gradle build errors after adding native modules\n- Codegen spec not matching native implementation\n\n> For **Expo Modules API**, **config plugins**, and **prebuild** issues, delegate to **expo-expert**.\n\n**Diagnosis:**\n```bash\n# Verify pod installation state\nif [ -f \"ios/Podfile.lock\" ]; then echo \"Pods installed\"; grep -c \"PODS:\" ios/Podfile.lock; else echo \"No Podfile.lock\"; fi\n\n# Check for TurboModule specs\ngrep -r \"TurboModule\\|codegenNativeComponent\\|codegenNativeCommands\" --include=\"*.ts\" --include=\"*.tsx\" . 2>/dev/null | grep -v node_modules | head -5\n\n# Check New Architecture status\ngrep -r \"newArchEnabled\\|fabricEnabled\" android/gradle.properties 2>/dev/null\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Verify codegen spec matches native implementation signature; run `cd ios && pod install` for iOS dependency resolution\n2. **Better**: Implement TurboModule with JSI bindings for synchronous native access; create codegen spec for type-safe native interface\n3. **Complete**: Write C++ TurboModules for shared cross-platform native logic; implement native views with Fabric\n\n**Resources:**\n- https://reactnative.dev/docs/turbo-native-modules-introduction"},"caller":{"type":"direct"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":933,"cache_read_input_tokens":73335,"cache_creation":{"ephemeral_5m_input_tokens":933,"ephemeral_1h_input_tokens":0},"output_tokens":1,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CYERNwG4c31acpsDzWKuS","type":"assistant","uuid":"e3da7e67-2d3b-4a0b-b28d-a05622c417d4","timestamp":"2026-02-17T22:22:09.959Z"}
{"parentUuid":"e3da7e67-2d3b-4a0b-b28d-a05622c417d4","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"progress","data":{"type":"hook_progress","hookEvent":"PreToolUse","hookName":"PreToolUse:Edit","command":"claudekit-hooks run file-guard"},"toolUseID":"toolu_018GiWKWpikvSLVFcJA22nDa","parentToolUseID":"toolu_018GiWKWpikvSLVFcJA22nDa","uuid":"d3d4c49d-03ef-4d42-91ae-27dab799e679","timestamp":"2026-02-17T22:22:09.961Z"}
{"parentUuid":"d3d4c49d-03ef-4d42-91ae-27dab799e679","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Edit","command":"claudekit-hooks run check-comment-replacement"},"parentToolUseID":"toolu_018GiWKWpikvSLVFcJA22nDa","toolUseID":"toolu_018GiWKWpikvSLVFcJA22nDa","timestamp":"2026-02-17T22:22:10.309Z","uuid":"1c889e40-dcaf-4e60-be3c-9103ebac3466"}
{"parentUuid":"1c889e40-dcaf-4e60-be3c-9103ebac3466","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Edit","command":"claudekit-hooks run check-unused-parameters"},"parentToolUseID":"toolu_018GiWKWpikvSLVFcJA22nDa","toolUseID":"toolu_018GiWKWpikvSLVFcJA22nDa","timestamp":"2026-02-17T22:22:10.309Z","uuid":"ee3bb990-cf26-4ca2-9628-ee23b376abf5"}
{"parentUuid":"ee3bb990-cf26-4ca2-9628-ee23b376abf5","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Edit","command":"claudekit-hooks run lint-changed"},"parentToolUseID":"toolu_018GiWKWpikvSLVFcJA22nDa","toolUseID":"toolu_018GiWKWpikvSLVFcJA22nDa","timestamp":"2026-02-17T22:22:10.309Z","uuid":"c68e8c3c-4b8c-4542-b1cf-ed830f5fc2ee"}
{"parentUuid":"c68e8c3c-4b8c-4542-b1cf-ed830f5fc2ee","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Edit","command":"claudekit-hooks run typecheck-changed"},"parentToolUseID":"toolu_018GiWKWpikvSLVFcJA22nDa","toolUseID":"toolu_018GiWKWpikvSLVFcJA22nDa","timestamp":"2026-02-17T22:22:10.309Z","uuid":"9213aa53-f3d8-425c-b106-d65c2577d158"}
{"parentUuid":"9213aa53-f3d8-425c-b106-d65c2577d158","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Edit","command":"claudekit-hooks run check-any-changed"},"parentToolUseID":"toolu_018GiWKWpikvSLVFcJA22nDa","toolUseID":"toolu_018GiWKWpikvSLVFcJA22nDa","timestamp":"2026-02-17T22:22:10.309Z","uuid":"923bb3e5-6779-464e-b62c-c82444d8ab7f"}
{"parentUuid":"923bb3e5-6779-464e-b62c-c82444d8ab7f","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Edit","command":"claudekit-hooks run test-changed"},"parentToolUseID":"toolu_018GiWKWpikvSLVFcJA22nDa","toolUseID":"toolu_018GiWKWpikvSLVFcJA22nDa","timestamp":"2026-02-17T22:22:10.309Z","uuid":"a841706b-5429-49dd-91a9-9b20ffbc7f66"}
{"parentUuid":"a841706b-5429-49dd-91a9-9b20ffbc7f66","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Edit","command":"callback"},"parentToolUseID":"toolu_018GiWKWpikvSLVFcJA22nDa","toolUseID":"toolu_018GiWKWpikvSLVFcJA22nDa","timestamp":"2026-02-17T22:22:10.309Z","uuid":"8a6fd38c-f994-4738-bc8f-6720c98d361f"}
{"parentUuid":"e3da7e67-2d3b-4a0b-b28d-a05622c417d4","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_018GiWKWpikvSLVFcJA22nDa","type":"tool_result","content":"The file /Users/eryk.napierala/Development/fasola/.claude/agents/react-native/react-native-expert.md has been updated successfully."}]},"uuid":"e47acd83-e676-4785-9e04-98c60df8b65a","timestamp":"2026-02-17T22:22:10.308Z","toolUseResult":{"filePath":"/Users/eryk.napierala/Development/fasola/.claude/agents/react-native/react-native-expert.md","oldString":"### Navigation\n**Common Issues:**\n- Deep links not resolving to correct screens\n- Screen not unmounting / effects not cleaning up on navigate away\n- Tab navigator re-rendering all tabs on state change\n- Header flickering or incorrect back button behavior\n- Expo Router file-based routes not matching expected paths\n\n**Diagnosis:**\n```bash\n# Detect routing structure\nif [ -d \"app\" ]; then find app/ -name \"*.tsx\" -o -name \"*.jsx\" | grep -E \"_layout|index|\\[\" | head -20; fi\n\n# Check for Expo Router configuration\ngrep -r \"expo-router\" app.json package.json 2>/dev/null | head -5\n\n# Find navigation hooks usage\ngrep -r \"useNavigation\\|useRouter\\|useLocalSearchParams\\|useSegments\\|router\\.\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -10\n\n# Check for react-native-screens optimization\nnpm list react-native-screens --depth=0 2>/dev/null\ngrep -r \"enableScreens\\|createNativeStackNavigator\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -5\n\n# Find deep link configuration\ngrep -r \"linking\\|deepLinks\\|scheme\" app.json app.config.ts app.config.js 2>/dev/null | head -5\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Use `useFocusEffect` instead of `useEffect` for screen-specific side effects, add `unmountOnBlur` to tab screens that hold heavy state\n2. **Better**: Use `react-native-screens` native stack for native transitions, implement proper deep link configuration in app scheme, use typed routes with Expo Router\n3. **Complete**: Implement navigation state persistence, prefetch data on screen focus, use `expo-router` typed routes and groups for auth flows\n\n**Validation:**\n```bash\n# Test deep links\nnpx uri-scheme open \"myapp://path/to/screen\" --ios 2>/dev/null || echo \"Test deep links manually\"\n```\n\n**Resources:**\n- https://docs.expo.dev/router/introduction/\n- https://reactnavigation.org/docs/getting-started\n- https://reactnative.dev/docs/navigation\n\n### Native Module Integration\n**Common Issues:**\n- \"Module not found\" after installing a native dependency\n- TurboModule registration failures on New Architecture\n- Config plugin not applying native changes\n- JSI bindings crashing on app startup\n- Pod install failures or Gradle build errors after adding native modules\n\n**Diagnosis:**\n```bash\n# Check for unlinked native modules\nnpx expo config --type introspect 2>/dev/null | head -20\n\n# Find config plugins\ngrep -r \"plugins\" app.json app.config.ts app.config.js 2>/dev/null | head -10\n\n# Check native module directories\nif [ -d \"modules\" ]; then ls modules/; fi\n\n# Verify pod installation state\nif [ -f \"ios/Podfile.lock\" ]; then echo \"Pods installed\"; grep -c \"PODS:\" ios/Podfile.lock; else echo \"No Podfile.lock\"; fi\n\n# Check for TurboModule specs\ngrep -r \"TurboModule\\|codegenNativeComponent\\|codegenNativeCommands\" --include=\"*.ts\" --include=\"*.tsx\" modules/ lib/ 2>/dev/null | head -5\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Run `npx expo prebuild --clean` to regenerate native projects, run `cd ios && pod install` for iOS dependency resolution\n2. **Better**: Create Expo config plugin for native configuration changes, ensure module spec matches native implementation signature\n3. **Complete**: Implement TurboModule with JSI bindings for synchronous native access, create codegen spec for type-safe native interface\n\n**Validation:**\n```bash\n# Rebuild native projects\nnpx expo prebuild --clean 2>/dev/null && echo \"Prebuild successful\"\ncd ios && pod install 2>/dev/null && cd ..\nnpx expo run:ios 2>/dev/null || npx expo run:android 2>/dev/null\n```\n\n**Resources:**\n- https://docs.expo.dev/modules/overview/\n- https://reactnative.dev/docs/turbo-native-modules-introduction\n- https://docs.expo.dev/config-plugins/introduction/","newString":"### Navigation (React Navigation)\n**Common Issues:**\n- Screen not unmounting / effects not cleaning up on navigate away\n- Tab navigator re-rendering all tabs on state change\n- Header flickering or incorrect back button behavior\n- Navigation stack memory leaks from duplicate screens\n\n> For **Expo Router file-based routing** issues (route resolution, groups, API routes, typed routes), delegate to **expo-expert**.\n\n**Diagnosis:**\n```bash\n# Find navigation hooks usage\ngrep -r \"useNavigation\\|useFocusEffect\\|useRoute\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -10\n\n# Check for react-native-screens optimization\nnpm list react-native-screens --depth=0 2>/dev/null\ngrep -r \"enableScreens\\|createNativeStackNavigator\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -5\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Use `useFocusEffect` instead of `useEffect` for screen-specific side effects, add `unmountOnBlur` to tab screens that hold heavy state\n2. **Better**: Use `react-native-screens` native stack for native transitions, implement navigation state persistence\n3. **Complete**: Prefetch data on screen focus, architect navigation for minimal re-renders\n\n**Resources:**\n- https://reactnavigation.org/docs/getting-started\n- https://reactnative.dev/docs/navigation\n\n### Native Modules (TurboModules / JSI)\n**Common Issues:**\n- TurboModule registration failures on New Architecture\n- JSI bindings crashing on app startup\n- Pod install failures or Gradle build errors after adding native modules\n- Codegen spec not matching native implementation\n\n> For **Expo Modules API**, **config plugins**, and **prebuild** issues, delegate to **expo-expert**.\n\n**Diagnosis:**\n```bash\n# Verify pod installation state\nif [ -f \"ios/Podfile.lock\" ]; then echo \"Pods installed\"; grep -c \"PODS:\" ios/Podfile.lock; else echo \"No Podfile.lock\"; fi\n\n# Check for TurboModule specs\ngrep -r \"TurboModule\\|codegenNativeComponent\\|codegenNativeCommands\" --include=\"*.ts\" --include=\"*.tsx\" . 2>/dev/null | grep -v node_modules | head -5\n\n# Check New Architecture status\ngrep -r \"newArchEnabled\\|fabricEnabled\" android/gradle.properties 2>/dev/null\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Verify codegen spec matches native implementation signature; run `cd ios && pod install` for iOS dependency resolution\n2. **Better**: Implement TurboModule with JSI bindings for synchronous native access; create codegen spec for type-safe native interface\n3. **Complete**: Write C++ TurboModules for shared cross-platform native logic; implement native views with Fabric\n\n**Resources:**\n- https://reactnative.dev/docs/turbo-native-modules-introduction","originalFile":"---\nname: react-native-expert\ndescription: React Native expert for mobile crashes, slow lists, gestures, native bridge issues, and platform-specific behavior. Use PROACTIVELY for RN component issues, animation problems, or mobile performance challenges.\ntools: Read, Grep, Glob, Bash, Edit, MultiEdit, Write\ncategory: framework\ncolor: blue\nbundle: [react-expert, react-performance-expert, expo-expert]\ndisplayName: React Native Expert\n---\n\n# React Native Expert\n\nYou are an expert in React Native with deep knowledge of mobile UI patterns, gesture handling, animations, list performance, platform-specific behavior on iOS and Android, and the New Architecture (Fabric + TurboModules).\n\n## When Invoked\n\n### Step 0: Recommend Specialist and Stop\nIf the issue is specifically about:\n- **Expo tooling** (CNG/prebuild, config plugins, EAS Build/Update/Submit, Expo Router file-based routing, Expo Modules API, DOM components, `expo-*` SDK packages, environment variables, `eas.json`, `app.json`/`app.config.ts` configuration): Stop and recommend expo-expert\n- **Pure React hooks or state patterns** (no RN-specific concern): Stop and recommend react-expert\n- **React rendering profiling and memoization** (not mobile-specific): Stop and recommend react-performance-expert\n- **Accessibility compliance**: Stop and recommend accessibility-expert\n- **Testing React Native components**: Stop and recommend the appropriate testing expert\n\n### Environment Detection\n```bash\n# Detect React Native and Expo versions\nnpm list react-native expo --depth=0 2>/dev/null || node -e \"const p=require('./package.json'); console.log('react-native:', p.dependencies?.['react-native'] || 'Not found'); console.log('expo:', p.dependencies?.expo || 'Not found')\" 2>/dev/null\n\n# Check Expo SDK version and architecture\nif [ -f \"app.json\" ]; then grep -E \"\\\"expo\\\"|\\\"sdkVersion\\\"\" app.json 2>/dev/null; fi\nif [ -f \"app.config.ts\" ] || [ -f \"app.config.js\" ]; then echo \"Dynamic Expo config detected\"; fi\n\n# Detect New Architecture\ngrep -r \"newArchEnabled\\|fabricEnabled\\|turboModules\" android/gradle.properties ios/Podfile app.json 2>/dev/null || echo \"New Architecture not detected\"\n\n# Check for Hermes\ngrep -r \"hermes\\|hermesEnabled\\|jsEngine\" android/gradle.properties app.json 2>/dev/null || echo \"Hermes config not found\"\n\n# Detect navigation library\nnpm list expo-router react-navigation @react-navigation/native --depth=0 2>/dev/null | grep -E \"(expo-router|react-navigation)\" || echo \"No navigation library detected\"\n\n# Detect animation and gesture libraries\nnpm list react-native-reanimated react-native-gesture-handler moti --depth=0 2>/dev/null | grep -E \"(reanimated|gesture-handler|moti)\" || echo \"No animation libraries detected\"\n\n# Detect state management\nnpm list zustand @tanstack/react-query jotai @reduxjs/toolkit legend-state --depth=0 2>/dev/null | grep -E \"(zustand|react-query|jotai|redux|legend)\" || echo \"No state management library detected\"\n```\n\n### Apply Strategy\n1. Identify the React Native-specific issue category\n2. Determine platform scope (iOS-only, Android-only, or cross-platform)\n3. Check for common anti-patterns in that category\n4. Apply progressive fixes (minimal to complete)\n5. Validate on both platforms when applicable\n\n## Problem Playbooks\n\n### List Performance\n**Common Issues:**\n- ScrollView rendering all children at once for large datasets\n- FlatList `renderItem` re-rendering every item on state change\n- Blank cells or janky scrolling in long lists\n- `getItemLayout` missing for fixed-height items causing scroll jumps\n\n**Diagnosis:**\n```bash\n# Find ScrollView usage that should be FlatList\ngrep -r \"ScrollView\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | grep -v \"node_modules\" | head -10\n\n# Check FlatList optimization props\ngrep -r \"FlatList\\|SectionList\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -10\n\n# Look for FlashList usage (preferred for large lists)\ngrep -r \"FlashList\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -5\n\n# Find inline renderItem functions (causes re-renders)\ngrep -B 2 -A 2 \"renderItem.*=>\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -20\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Replace ScrollView with FlatList for lists > 20 items, add `keyExtractor`\n2. **Better**: Extract `renderItem` to a stable reference, add `getItemLayout` for fixed heights, set `removeClippedSubviews`, `maxToRenderPerBatch`, `windowSize`\n3. **Complete**: Migrate to FlashList (`@shopify/flash-list`), provide `estimatedItemSize`, implement `CellRendererComponent` for complex layouts\n\n**Validation:**\n- Enable Perf Monitor (`Dev Menu > Show Perf Monitor`) and verify JS/UI frame rates stay at 60fps during scroll\n- Profile with Flipper or React DevTools to confirm renderItem calls are minimized\n\n**Resources:**\n- https://reactnative.dev/docs/optimizing-flatlist-configuration\n- https://shopify.github.io/flash-list/\n- https://reactnative.dev/docs/scrollview\n\n### Animations & Gestures\n**Common Issues:**\n- Animations running on JS thread causing dropped frames\n- Gesture Handler conflicts with ScrollView or navigation gestures\n- Reanimated worklet errors (\"Tried to synchronously call a non-worklet function\")\n- Layout animations causing crashes on Android\n\n**Diagnosis:**\n```bash\n# Check Reanimated version and babel plugin\nnpm list react-native-reanimated --depth=0 2>/dev/null\ngrep -r \"react-native-reanimated/plugin\" babel.config.js 2>/dev/null || echo \"Reanimated babel plugin not configured\"\n\n# Find Animated.Value usage (old API)\ngrep -r \"Animated\\.Value\\|Animated\\.timing\\|Animated\\.spring\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -10\n\n# Check for worklet functions\ngrep -r \"'worklet'\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -10\n\n# Find gesture handler usage\ngrep -r \"GestureDetector\\|PanGestureHandler\\|Gesture\\.\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -10\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Move animations to UI thread using `useAnimatedStyle` and `withTiming`/`withSpring`, add `'worklet'` directive to callbacks passed to `useAnimatedGestureHandler`\n2. **Better**: Replace old `Animated` API with Reanimated shared values, use `Gesture.Pan()` composable API instead of handler components, use `runOnJS` for JS thread callbacks\n3. **Complete**: Implement gesture-driven animations entirely on UI thread, use `useAnimatedScrollHandler` for scroll-linked animations, combine gestures with `Gesture.Simultaneous`/`Gesture.Exclusive`\n\n**Validation:**\n- Run with `JS Dev Mode` off to get accurate performance measurements\n- Verify animations maintain 60fps with Perf Monitor enabled\n- Test gesture interactions don't conflict with navigation back gesture\n\n**Resources:**\n- https://docs.swmansion.com/react-native-reanimated/\n- https://docs.swmansion.com/react-native-gesture-handler/\n- https://reactnative.dev/docs/animations\n\n### Navigation\n**Common Issues:**\n- Deep links not resolving to correct screens\n- Screen not unmounting / effects not cleaning up on navigate away\n- Tab navigator re-rendering all tabs on state change\n- Header flickering or incorrect back button behavior\n- Expo Router file-based routes not matching expected paths\n\n**Diagnosis:**\n```bash\n# Detect routing structure\nif [ -d \"app\" ]; then find app/ -name \"*.tsx\" -o -name \"*.jsx\" | grep -E \"_layout|index|\\[\" | head -20; fi\n\n# Check for Expo Router configuration\ngrep -r \"expo-router\" app.json package.json 2>/dev/null | head -5\n\n# Find navigation hooks usage\ngrep -r \"useNavigation\\|useRouter\\|useLocalSearchParams\\|useSegments\\|router\\.\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -10\n\n# Check for react-native-screens optimization\nnpm list react-native-screens --depth=0 2>/dev/null\ngrep -r \"enableScreens\\|createNativeStackNavigator\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -5\n\n# Find deep link configuration\ngrep -r \"linking\\|deepLinks\\|scheme\" app.json app.config.ts app.config.js 2>/dev/null | head -5\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Use `useFocusEffect` instead of `useEffect` for screen-specific side effects, add `unmountOnBlur` to tab screens that hold heavy state\n2. **Better**: Use `react-native-screens` native stack for native transitions, implement proper deep link configuration in app scheme, use typed routes with Expo Router\n3. **Complete**: Implement navigation state persistence, prefetch data on screen focus, use `expo-router` typed routes and groups for auth flows\n\n**Validation:**\n```bash\n# Test deep links\nnpx uri-scheme open \"myapp://path/to/screen\" --ios 2>/dev/null || echo \"Test deep links manually\"\n```\n\n**Resources:**\n- https://docs.expo.dev/router/introduction/\n- https://reactnavigation.org/docs/getting-started\n- https://reactnative.dev/docs/navigation\n\n### Native Module Integration\n**Common Issues:**\n- \"Module not found\" after installing a native dependency\n- TurboModule registration failures on New Architecture\n- Config plugin not applying native changes\n- JSI bindings crashing on app startup\n- Pod install failures or Gradle build errors after adding native modules\n\n**Diagnosis:**\n```bash\n# Check for unlinked native modules\nnpx expo config --type introspect 2>/dev/null | head -20\n\n# Find config plugins\ngrep -r \"plugins\" app.json app.config.ts app.config.js 2>/dev/null | head -10\n\n# Check native module directories\nif [ -d \"modules\" ]; then ls modules/; fi\n\n# Verify pod installation state\nif [ -f \"ios/Podfile.lock\" ]; then echo \"Pods installed\"; grep -c \"PODS:\" ios/Podfile.lock; else echo \"No Podfile.lock\"; fi\n\n# Check for TurboModule specs\ngrep -r \"TurboModule\\|codegenNativeComponent\\|codegenNativeCommands\" --include=\"*.ts\" --include=\"*.tsx\" modules/ lib/ 2>/dev/null | head -5\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Run `npx expo prebuild --clean` to regenerate native projects, run `cd ios && pod install` for iOS dependency resolution\n2. **Better**: Create Expo config plugin for native configuration changes, ensure module spec matches native implementation signature\n3. **Complete**: Implement TurboModule with JSI bindings for synchronous native access, create codegen spec for type-safe native interface\n\n**Validation:**\n```bash\n# Rebuild native projects\nnpx expo prebuild --clean 2>/dev/null && echo \"Prebuild successful\"\ncd ios && pod install 2>/dev/null && cd ..\nnpx expo run:ios 2>/dev/null || npx expo run:android 2>/dev/null\n```\n\n**Resources:**\n- https://docs.expo.dev/modules/overview/\n- https://reactnative.dev/docs/turbo-native-modules-introduction\n- https://docs.expo.dev/config-plugins/introduction/\n\n### Bundle & Startup Performance\n**Common Issues:**\n- Large bundle size from barrel exports pulling in unused code\n- Slow app startup from synchronous module initialization\n- Hermes bytecode not being generated (interpreting raw JS)\n- Unnecessary polyfills or duplicate dependencies in bundle\n\n**Diagnosis:**\n```bash\n# Check bundle size\nnpx react-native-bundle-visualizer 2>/dev/null || echo \"Install react-native-bundle-visualizer for analysis\"\n\n# Find barrel exports\ngrep -r \"export \\* from\\|export {\" --include=\"index.ts\" --include=\"index.tsx\" features/ lib/ | head -10\n\n# Check for heavy imports at module scope\ngrep -r \"^import.*from\" --include=\"*.tsx\" --include=\"*.ts\" features/ app/ | grep -E \"moment|lodash[^/]|aws-sdk[^/]\" | head -5\n\n# Verify Hermes is enabled\ngrep -r \"hermes\" android/gradle.properties ios/Podfile app.json 2>/dev/null | head -5\n\n# Check Metro config for tree shaking\nif [ -f \"metro.config.js\" ]; then cat metro.config.js; fi\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Replace barrel imports with direct file imports, enable Hermes if not already active, remove unused dependencies\n2. **Better**: Implement lazy `require()` for heavy modules used only in specific screens, configure Metro `transformer.minifierConfig` for better dead code elimination\n3. **Complete**: Profile startup with Hermes sampling profiler, implement app startup trace, defer non-critical initialization with `InteractionManager.runAfterInteractions`\n\n**Validation:**\n```bash\n# Measure bundle size\nnpx expo export --dump-sourcemap 2>/dev/null && echo \"Check source map for bundle analysis\"\n```\n\n**Resources:**\n- https://reactnative.dev/docs/performance\n- https://reactnative.dev/docs/hermes\n- https://docs.expo.dev/guides/analyzing-bundles/\n\n### Memory Management\n**Common Issues:**\n- Effects not cleaning up subscriptions or listeners on unmount\n- Large image data held in memory instead of referenced from file system\n- Event listeners accumulating from navigation between screens\n- AbortController not used for fetch cancellation\n\n**Diagnosis:**\n```bash\n# Find effects without cleanup\ngrep -A 8 \"useEffect\\|useFocusEffect\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | grep -B 5 \"useEffect\\|useFocusEffect\" | grep -c \"return \" || echo \"Check for missing cleanup functions\"\n\n# Find addEventListener without removeEventListener\ngrep -r \"addEventListener\\|addListener\\|\\.on(\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | grep -v \"remove\\|cleanup\\|unsubscribe\" | head -10\n\n# Check for base64 image data in state\ngrep -r \"base64\\|data:image\" --include=\"*.tsx\" --include=\"*.ts\" features/ app/ lib/ | head -5\n\n# Find fetch calls without AbortController\ngrep -r \"fetch(\" --include=\"*.tsx\" --include=\"*.ts\" features/ app/ lib/ | grep -v \"AbortController\\|abort\\|signal\" | head -10\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Add cleanup functions returning `removeEventListener`/`unsubscribe` to all effects, use AbortController with fetch\n2. **Better**: Store image URIs (file paths) instead of base64 data in state, implement proper cache eviction for image caches, use `useFocusEffect` for screen-scoped subscriptions\n3. **Complete**: Implement memory monitoring in development, use `expo-file-system` for large data storage, profile with Xcode Instruments (iOS) or Android Studio Profiler\n\n**Validation:**\n- Monitor memory usage in Xcode Instruments or Android Studio Profiler during screen transitions\n- Verify memory returns to baseline after navigating away from screens with heavy content\n\n**Resources:**\n- https://reactnative.dev/docs/performance#ram-bundles-inline-requires\n- https://docs.expo.dev/versions/latest/sdk/filesystem/\n- https://react.dev/learn/synchronizing-with-effects#how-to-handle-the-effect-firing-twice-in-development\n\n### Platform-Specific Issues\n**Common Issues:**\n- Safe area insets not applied correctly (notch/island/navigation bar)\n- Keyboard covering input fields on iOS vs Android different behavior\n- Shadow styles only working on iOS (Android requires `elevation`)\n- StatusBar styling inconsistencies between platforms\n- Platform-specific crashes from unsupported APIs\n\n**Diagnosis:**\n```bash\n# Find platform-specific code\ngrep -r \"Platform\\.OS\\|Platform\\.select\\|\\.ios\\.\\|\\.android\\.\" --include=\"*.tsx\" --include=\"*.tsx\" features/ app/ lib/ | head -10\n\n# Check safe area handling\ngrep -r \"SafeAreaView\\|useSafeAreaInsets\\|SafeAreaProvider\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -5\n\n# Find shadow styles without elevation\ngrep -r \"shadowColor\\|shadowOffset\\|shadowRadius\" --include=\"*.tsx\" --include=\"*.ts\" features/ app/ lib/ | grep -v \"elevation\" | head -5\n\n# Check keyboard handling\ngrep -r \"KeyboardAvoidingView\\|useKeyboard\\|keyboard\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -5\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Wrap root in `SafeAreaProvider`, use `useSafeAreaInsets` for custom layouts, add `elevation` alongside shadow styles for Android\n2. **Better**: Use `KeyboardAvoidingView` with `behavior=\"padding\"` on iOS and `behavior=\"height\"` on Android, handle `StatusBar` per-screen with `expo-status-bar`\n3. **Complete**: Create platform-aware style utilities, implement proper keyboard-aware scroll views, use `Platform.select` for divergent behavior, test on both platforms with various device sizes\n\n**Validation:**\n- Test on both iOS simulator and Android emulator\n- Verify safe area behavior on devices with notch/Dynamic Island and navigation bar\n\n**Resources:**\n- https://reactnative.dev/docs/platform-specific-code\n- https://reactnative.dev/docs/keyboardavoidingview\n- https://docs.expo.dev/versions/latest/sdk/safe-area-context/\n\n### Image Handling\n**Common Issues:**\n- Images loading slowly or flickering on re-render\n- Memory spikes from loading full-resolution images into views\n- Missing placeholder/blurhash during image load\n- Incorrect aspect ratio or cropping behavior\n- Cache not working across app restarts\n\n**Diagnosis:**\n```bash\n# Check image component usage\ngrep -r \"from.*expo-image\\|from.*react-native.*Image\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -10\n\n# Find Image components without proper sizing\ngrep -r \"<Image\\|<ExpoImage\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | grep -v \"width\\|height\\|style\" | head -5\n\n# Check for blurhash/placeholder usage\ngrep -r \"blurhash\\|placeholder\\|thumbhash\" --include=\"*.tsx\" --include=\"*.ts\" features/ app/ lib/ | head -5\n\n# Look for contentFit configuration\ngrep -r \"contentFit\\|resizeMode\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -10\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Use `expo-image` instead of RN `Image` for automatic caching and better performance, set explicit `width`/`height` or `contentFit`\n2. **Better**: Generate and store blurhash strings for placeholder display, use `contentFit=\"cover\"` for consistent layout, configure `cachePolicy=\"memory-disk\"`\n3. **Complete**: Implement progressive image loading (blurhash to thumbnail to full), resize images before display using `expo-image-manipulator`, implement custom cache management for offline support\n\n**Validation:**\n- Verify images load without flicker by navigating between screens\n- Monitor memory usage when displaying image-heavy lists\n\n**Resources:**\n- https://docs.expo.dev/versions/latest/sdk/image/\n- https://blurha.sh/\n- https://docs.expo.dev/versions/latest/sdk/image-manipulator/\n\n## Runtime Considerations\n- **Hermes Engine**: Default JS engine for React Native. Supports bytecode precompilation for faster startup. Some JS features (e.g., `Proxy` in older versions) may not be available. Always verify engine-specific behavior.\n- **New Architecture (Fabric + TurboModules)**: Enables synchronous native calls via JSI, concurrent rendering support, and codegen for type-safe native interfaces. May require library compatibility verification.\n- **React Compiler**: When enabled, automatically memoizes components and hooks. Reduces need for manual `useMemo`/`useCallback` but requires understanding of what the compiler can and cannot optimize.\n- **Metro Bundler**: Module resolution follows Metro conventions (platform extensions `.ios.tsx`/`.android.tsx`, Haste modules). Tree shaking is limited compared to web bundlers; prefer direct imports over barrel exports.\n- **Platform Threads**: JS thread (business logic), UI/Main thread (native UI updates), and Shadow thread (layout calculation). Animations and gestures should run on UI thread via Reanimated worklets. Long JS thread work blocks interactions.\n\n## Code Review Checklist\n\nWhen reviewing React Native code, focus on these mobile-specific aspects:\n\n### List Performance\n- [ ] Large lists use FlatList or FlashList, not ScrollView\n- [ ] `renderItem` extracted to stable function reference\n- [ ] `keyExtractor` provides unique, stable keys\n- [ ] `getItemLayout` provided for fixed-height items\n- [ ] `removeClippedSubviews` enabled for off-screen optimization\n\n### Animation & Gesture\n- [ ] Animations run on UI thread (Reanimated shared values, not Animated.Value)\n- [ ] Worklet directive present on UI thread callbacks\n- [ ] `runOnJS` used when calling JS functions from worklets\n- [ ] Gestures composed properly (Simultaneous, Exclusive, Race)\n- [ ] Layout animations tested on both platforms\n\n### Navigation\n- [ ] `useFocusEffect` used for screen-scoped side effects\n- [ ] Deep link paths registered and tested\n- [ ] Screen options set correctly (header, gestures, presentation)\n- [ ] Navigation types consistent (native stack for performance)\n- [ ] Tab screens use `unmountOnBlur` when holding heavy state\n\n### Native Integration\n- [ ] Config plugins used instead of manual native file edits\n- [ ] Native module errors handled gracefully in JS\n- [ ] Platform-specific code uses `Platform.select` or file extensions\n- [ ] Pod versions locked in Podfile for reproducible builds\n\n### Memory & Resources\n- [ ] Effects include cleanup functions\n- [ ] AbortController used for cancellable fetch requests\n- [ ] Image data stored as file URIs, not base64 in state\n- [ ] Event listeners removed on unmount\n- [ ] Large data processed with streaming or pagination\n\n### Platform Consistency\n- [ ] Safe area insets applied via `useSafeAreaInsets`\n- [ ] Shadows include `elevation` for Android\n- [ ] Keyboard avoidance configured per platform\n- [ ] StatusBar styled per screen\n- [ ] Touch targets meet minimum 44pt size\n\n### Image Optimization\n- [ ] `expo-image` used over RN `Image`\n- [ ] Blurhash or placeholder configured for loading state\n- [ ] `contentFit` set explicitly\n- [ ] Images sized appropriately (not loading 4K into thumbnails)\n- [ ] Cache policy configured for offline resilience\n\n### Bundle & Startup\n- [ ] No barrel export re-exports pulling in unused modules\n- [ ] Heavy libraries lazily required where possible\n- [ ] Hermes enabled and bytecode precompiled\n- [ ] Startup initialization deferred for non-critical work\n- [ ] Bundle size monitored and within budget\n\n## Safety Guidelines\n- Never modify native iOS/Android project files directly when a config plugin or prebuild can handle it; manual edits get overwritten by `expo prebuild`\n- Always test on both platforms after changes to layout, gestures, or native modules\n- Handle native module unavailability gracefully (null checks, try/catch) for Expo Go compatibility\n- Use `InteractionManager.runAfterInteractions` for expensive post-navigation work to avoid janky transitions\n- Never store sensitive data in AsyncStorage without encryption; use `expo-secure-store` for tokens and credentials\n- Pin native dependency versions to avoid breaking changes from auto-resolution during `pod install` or Gradle sync\n\n## Anti-Patterns to Avoid\n1. **ScrollView for Large Lists**: Always use FlatList/FlashList for dynamic data; ScrollView renders all children immediately\n2. **JS Thread Animations**: Never animate with `setState` in `requestAnimationFrame`; use Reanimated shared values on the UI thread\n3. **Inline Styles in Lists**: Creating new style objects per render forces layout recalculation; use `StyleSheet.create` or stable references\n4. **Base64 Images in State**: Holding large base64 strings in component state causes memory pressure; store file URIs and let the image component handle loading\n5. **Manual Native File Edits with Expo**: Editing `ios/` or `android/` directly in managed workflow; use config plugins so changes survive `expo prebuild --clean`\n6. **Ignoring Platform Differences**: Assuming iOS behavior on Android (shadows, keyboard, safe area); always verify with `Platform.OS` checks or platform extensions\n7. **Barrel Export Everything**: Re-exporting entire feature modules via `index.ts` defeats Metro's ability to skip unused code; import directly from source files\n8. **Uncontrolled Navigation State**: Pushing duplicate screens or not resetting stacks causes memory leaks and confusing back behavior\n9. **Synchronous Heavy Computation on JS Thread**: Blocks gestures and animations; offload to `requestIdleCallback`, web workers, or native modules\n10. **Skipping Cleanup in useFocusEffect**: Unlike `useEffect`, `useFocusEffect` fires on every screen focus; missing cleanup causes listener accumulation\n","structuredPatch":[{"oldStart":130,"oldLines":92,"newStart":130,"newLines":62,"lines":[" - https://docs.swmansion.com/react-native-gesture-handler/"," - https://reactnative.dev/docs/animations"," ","-### Navigation","+### Navigation (React Navigation)"," **Common Issues:**","-- Deep links not resolving to correct screens"," - Screen not unmounting / effects not cleaning up on navigate away"," - Tab navigator re-rendering all tabs on state change"," - Header flickering or incorrect back button behavior","-- Expo Router file-based routes not matching expected paths","+- Navigation stack memory leaks from duplicate screens"," ","+> For **Expo Router file-based routing** issues (route resolution, groups, API routes, typed routes), delegate to **expo-expert**.","+"," **Diagnosis:**"," ```bash","-# Detect routing structure","-if [ -d \"app\" ]; then find app/ -name \"*.tsx\" -o -name \"*.jsx\" | grep -E \"_layout|index|\\[\" | head -20; fi","-","-# Check for Expo Router configuration","-grep -r \"expo-router\" app.json package.json 2>/dev/null | head -5","-"," # Find navigation hooks usage","-grep -r \"useNavigation\\|useRouter\\|useLocalSearchParams\\|useSegments\\|router\\.\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -10","+grep -r \"useNavigation\\|useFocusEffect\\|useRoute\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -10"," "," # Check for react-native-screens optimization"," npm list react-native-screens --depth=0 2>/dev/null"," grep -r \"enableScreens\\|createNativeStackNavigator\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -5","-","-# Find deep link configuration","-grep -r \"linking\\|deepLinks\\|scheme\" app.json app.config.ts app.config.js 2>/dev/null | head -5"," ```"," "," **Prioritized Fixes:**"," 1. **Minimal**: Use `useFocusEffect` instead of `useEffect` for screen-specific side effects, add `unmountOnBlur` to tab screens that hold heavy state","-2. **Better**: Use `react-native-screens` native stack for native transitions, implement proper deep link configuration in app scheme, use typed routes with Expo Router","-3. **Complete**: Implement navigation state persistence, prefetch data on screen focus, use `expo-router` typed routes and groups for auth flows","+2. **Better**: Use `react-native-screens` native stack for native transitions, implement navigation state persistence","+3. **Complete**: Prefetch data on screen focus, architect navigation for minimal re-renders"," ","-**Validation:**","-```bash","-# Test deep links","-npx uri-scheme open \"myapp://path/to/screen\" --ios 2>/dev/null || echo \"Test deep links manually\"","-```","-"," **Resources:**","-- https://docs.expo.dev/router/introduction/"," - https://reactnavigation.org/docs/getting-started"," - https://reactnative.dev/docs/navigation"," ","-### Native Module Integration","+### Native Modules (TurboModules / JSI)"," **Common Issues:**","-- \"Module not found\" after installing a native dependency"," - TurboModule registration failures on New Architecture","-- Config plugin not applying native changes"," - JSI bindings crashing on app startup"," - Pod install failures or Gradle build errors after adding native modules","+- Codegen spec not matching native implementation"," ","+> For **Expo Modules API**, **config plugins**, and **prebuild** issues, delegate to **expo-expert**.","+"," **Diagnosis:**"," ```bash","-# Check for unlinked native modules","-npx expo config --type introspect 2>/dev/null | head -20","-","-# Find config plugins","-grep -r \"plugins\" app.json app.config.ts app.config.js 2>/dev/null | head -10","-","-# Check native module directories","-if [ -d \"modules\" ]; then ls modules/; fi","-"," # Verify pod installation state"," if [ -f \"ios/Podfile.lock\" ]; then echo \"Pods installed\"; grep -c \"PODS:\" ios/Podfile.lock; else echo \"No Podfile.lock\"; fi"," "," # Check for TurboModule specs","-grep -r \"TurboModule\\|codegenNativeComponent\\|codegenNativeCommands\" --include=\"*.ts\" --include=\"*.tsx\" modules/ lib/ 2>/dev/null | head -5","+grep -r \"TurboModule\\|codegenNativeComponent\\|codegenNativeCommands\" --include=\"*.ts\" --include=\"*.tsx\" . 2>/dev/null | grep -v node_modules | head -5","+","+# Check New Architecture status","+grep -r \"newArchEnabled\\|fabricEnabled\" android/gradle.properties 2>/dev/null"," ```"," "," **Prioritized Fixes:**","-1. **Minimal**: Run `npx expo prebuild --clean` to regenerate native projects, run `cd ios && pod install` for iOS dependency resolution","-2. **Better**: Create Expo config plugin for native configuration changes, ensure module spec matches native implementation signature","-3. **Complete**: Implement TurboModule with JSI bindings for synchronous native access, create codegen spec for type-safe native interface","+1. **Minimal**: Verify codegen spec matches native implementation signature; run `cd ios && pod install` for iOS dependency resolution","+2. **Better**: Implement TurboModule with JSI bindings for synchronous native access; create codegen spec for type-safe native interface","+3. **Complete**: Write C++ TurboModules for shared cross-platform native logic; implement native views with Fabric"," ","-**Validation:**","-```bash","-# Rebuild native projects","-npx expo prebuild --clean 2>/dev/null && echo \"Prebuild successful\"","-cd ios && pod install 2>/dev/null && cd ..","-npx expo run:ios 2>/dev/null || npx expo run:android 2>/dev/null","-```","-"," **Resources:**","-- https://docs.expo.dev/modules/overview/"," - https://reactnative.dev/docs/turbo-native-modules-introduction","-- https://docs.expo.dev/config-plugins/introduction/"," "," ### Bundle & Startup Performance"," **Common Issues:**"]}],"userModified":false,"replaceAll":false},"sourceToolAssistantUUID":"e3da7e67-2d3b-4a0b-b28d-a05622c417d4"}
{"parentUuid":"e47acd83-e676-4785-9e04-98c60df8b65a","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","message":{"model":"claude-opus-4-6","id":"msg_017Aa9YRrNotztRGAqD97mkm","type":"message","role":"assistant","content":[{"type":"text","text":"Now update the Image Handling section to delegate Expo-specific parts:"}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":2038,"cache_read_input_tokens":74268,"cache_creation":{"ephemeral_5m_input_tokens":2038,"ephemeral_1h_input_tokens":0},"output_tokens":2,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CYERRSNaAdLk6JQ3vLAw8","type":"assistant","uuid":"f0a26422-318d-4c1b-9943-93df9cb0af3e","timestamp":"2026-02-17T22:22:12.948Z"}
{"parentUuid":"f0a26422-318d-4c1b-9943-93df9cb0af3e","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","message":{"model":"claude-opus-4-6","id":"msg_017Aa9YRrNotztRGAqD97mkm","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_0169KbKug3j1zpfx5iza1dDW","name":"Edit","input":{"replace_all":false,"file_path":"/Users/eryk.napierala/Development/fasola/.claude/agents/react-native/react-native-expert.md","old_string":"### Image Handling\n**Common Issues:**\n- Images loading slowly or flickering on re-render\n- Memory spikes from loading full-resolution images into views\n- Missing placeholder/blurhash during image load\n- Incorrect aspect ratio or cropping behavior\n- Cache not working across app restarts\n\n**Diagnosis:**\n```bash\n# Check image component usage\ngrep -r \"from.*expo-image\\|from.*react-native.*Image\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -10\n\n# Find Image components without proper sizing\ngrep -r \"<Image\\|<ExpoImage\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | grep -v \"width\\|height\\|style\" | head -5\n\n# Check for blurhash/placeholder usage\ngrep -r \"blurhash\\|placeholder\\|thumbhash\" --include=\"*.tsx\" --include=\"*.ts\" features/ app/ lib/ | head -5\n\n# Look for contentFit configuration\ngrep -r \"contentFit\\|resizeMode\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -10\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Use `expo-image` instead of RN `Image` for automatic caching and better performance, set explicit `width`/`height` or `contentFit`\n2. **Better**: Generate and store blurhash strings for placeholder display, use `contentFit=\"cover\"` for consistent layout, configure `cachePolicy=\"memory-disk\"`\n3. **Complete**: Implement progressive image loading (blurhash to thumbnail to full), resize images before display using `expo-image-manipulator`, implement custom cache management for offline support\n\n**Validation:**\n- Verify images load without flicker by navigating between screens\n- Monitor memory usage when displaying image-heavy lists\n\n**Resources:**\n- https://docs.expo.dev/versions/latest/sdk/image/\n- https://blurha.sh/\n- https://docs.expo.dev/versions/latest/sdk/image-manipulator/","new_string":"### Image Handling\n**Common Issues:**\n- Images loading slowly or flickering on re-render\n- Memory spikes from loading full-resolution images into views\n- Incorrect aspect ratio or cropping behavior\n- Cache not working across app restarts\n\n> For **expo-image** specific configuration (blurhash, contentFit, cachePolicy) and **expo-image-manipulator**, delegate to **expo-expert**.\n\n**Diagnosis:**\n```bash\n# Check image component usage\ngrep -r \"from.*expo-image\\|from.*react-native.*Image\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -10\n\n# Find Image components without proper sizing\ngrep -r \"<Image\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | grep -v \"width\\|height\\|style\" | head -5\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Set explicit `width`/`height` on all images; avoid loading full-resolution images into thumbnail views\n2. **Better**: Store image URIs (file paths) instead of base64 data in state; use `resizeMode` consistently\n3. **Complete**: Implement progressive image loading; monitor memory usage in image-heavy lists\n\n**Validation:**\n- Verify images load without flicker by navigating between screens\n- Monitor memory usage when displaying image-heavy lists\n\n**Resources:**\n- https://reactnative.dev/docs/image\n- https://docs.expo.dev/versions/latest/sdk/image/"},"caller":{"type":"direct"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":2038,"cache_read_input_tokens":74268,"cache_creation":{"ephemeral_5m_input_tokens":2038,"ephemeral_1h_input_tokens":0},"output_tokens":2,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CYERRSNaAdLk6JQ3vLAw8","type":"assistant","uuid":"15bc100f-d735-4823-99ae-864c1297bf0d","timestamp":"2026-02-17T22:22:26.853Z"}
{"parentUuid":"15bc100f-d735-4823-99ae-864c1297bf0d","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"progress","data":{"type":"hook_progress","hookEvent":"PreToolUse","hookName":"PreToolUse:Edit","command":"claudekit-hooks run file-guard"},"toolUseID":"toolu_0169KbKug3j1zpfx5iza1dDW","parentToolUseID":"toolu_0169KbKug3j1zpfx5iza1dDW","uuid":"364fde27-95b4-4a13-a78d-44117edcef5d","timestamp":"2026-02-17T22:22:26.854Z"}
{"parentUuid":"364fde27-95b4-4a13-a78d-44117edcef5d","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Edit","command":"claudekit-hooks run check-comment-replacement"},"parentToolUseID":"toolu_0169KbKug3j1zpfx5iza1dDW","toolUseID":"toolu_0169KbKug3j1zpfx5iza1dDW","timestamp":"2026-02-17T22:22:27.317Z","uuid":"3f29a78a-242d-4e35-95f0-73cbc256171a"}
{"parentUuid":"3f29a78a-242d-4e35-95f0-73cbc256171a","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Edit","command":"claudekit-hooks run check-unused-parameters"},"parentToolUseID":"toolu_0169KbKug3j1zpfx5iza1dDW","toolUseID":"toolu_0169KbKug3j1zpfx5iza1dDW","timestamp":"2026-02-17T22:22:27.317Z","uuid":"9bdbd3fa-37d4-444a-9eb8-9218d534191a"}
{"parentUuid":"9bdbd3fa-37d4-444a-9eb8-9218d534191a","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Edit","command":"claudekit-hooks run lint-changed"},"parentToolUseID":"toolu_0169KbKug3j1zpfx5iza1dDW","toolUseID":"toolu_0169KbKug3j1zpfx5iza1dDW","timestamp":"2026-02-17T22:22:27.317Z","uuid":"b30839c1-5199-4319-abb9-7de1df14b5e3"}
{"parentUuid":"b30839c1-5199-4319-abb9-7de1df14b5e3","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Edit","command":"claudekit-hooks run typecheck-changed"},"parentToolUseID":"toolu_0169KbKug3j1zpfx5iza1dDW","toolUseID":"toolu_0169KbKug3j1zpfx5iza1dDW","timestamp":"2026-02-17T22:22:27.317Z","uuid":"88c9da59-63f1-4ffb-95c9-07698ec7e479"}
{"parentUuid":"88c9da59-63f1-4ffb-95c9-07698ec7e479","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Edit","command":"claudekit-hooks run check-any-changed"},"parentToolUseID":"toolu_0169KbKug3j1zpfx5iza1dDW","toolUseID":"toolu_0169KbKug3j1zpfx5iza1dDW","timestamp":"2026-02-17T22:22:27.317Z","uuid":"2a140aba-f85e-4011-b5a8-68049dfb96e5"}
{"parentUuid":"2a140aba-f85e-4011-b5a8-68049dfb96e5","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Edit","command":"claudekit-hooks run test-changed"},"parentToolUseID":"toolu_0169KbKug3j1zpfx5iza1dDW","toolUseID":"toolu_0169KbKug3j1zpfx5iza1dDW","timestamp":"2026-02-17T22:22:27.317Z","uuid":"67cfd2a6-d9b6-436b-ac5b-625769523fcf"}
{"parentUuid":"67cfd2a6-d9b6-436b-ac5b-625769523fcf","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Edit","command":"callback"},"parentToolUseID":"toolu_0169KbKug3j1zpfx5iza1dDW","toolUseID":"toolu_0169KbKug3j1zpfx5iza1dDW","timestamp":"2026-02-17T22:22:27.317Z","uuid":"4c1eb275-bd4b-4f48-a2a1-fb8d0e779b4e"}
{"parentUuid":"15bc100f-d735-4823-99ae-864c1297bf0d","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_0169KbKug3j1zpfx5iza1dDW","type":"tool_result","content":"The file /Users/eryk.napierala/Development/fasola/.claude/agents/react-native/react-native-expert.md has been updated successfully."}]},"uuid":"5a203f61-e60c-4979-aeee-a2e4f0303cb2","timestamp":"2026-02-17T22:22:27.316Z","toolUseResult":{"filePath":"/Users/eryk.napierala/Development/fasola/.claude/agents/react-native/react-native-expert.md","oldString":"### Image Handling\n**Common Issues:**\n- Images loading slowly or flickering on re-render\n- Memory spikes from loading full-resolution images into views\n- Missing placeholder/blurhash during image load\n- Incorrect aspect ratio or cropping behavior\n- Cache not working across app restarts\n\n**Diagnosis:**\n```bash\n# Check image component usage\ngrep -r \"from.*expo-image\\|from.*react-native.*Image\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -10\n\n# Find Image components without proper sizing\ngrep -r \"<Image\\|<ExpoImage\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | grep -v \"width\\|height\\|style\" | head -5\n\n# Check for blurhash/placeholder usage\ngrep -r \"blurhash\\|placeholder\\|thumbhash\" --include=\"*.tsx\" --include=\"*.ts\" features/ app/ lib/ | head -5\n\n# Look for contentFit configuration\ngrep -r \"contentFit\\|resizeMode\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -10\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Use `expo-image` instead of RN `Image` for automatic caching and better performance, set explicit `width`/`height` or `contentFit`\n2. **Better**: Generate and store blurhash strings for placeholder display, use `contentFit=\"cover\"` for consistent layout, configure `cachePolicy=\"memory-disk\"`\n3. **Complete**: Implement progressive image loading (blurhash to thumbnail to full), resize images before display using `expo-image-manipulator`, implement custom cache management for offline support\n\n**Validation:**\n- Verify images load without flicker by navigating between screens\n- Monitor memory usage when displaying image-heavy lists\n\n**Resources:**\n- https://docs.expo.dev/versions/latest/sdk/image/\n- https://blurha.sh/\n- https://docs.expo.dev/versions/latest/sdk/image-manipulator/","newString":"### Image Handling\n**Common Issues:**\n- Images loading slowly or flickering on re-render\n- Memory spikes from loading full-resolution images into views\n- Incorrect aspect ratio or cropping behavior\n- Cache not working across app restarts\n\n> For **expo-image** specific configuration (blurhash, contentFit, cachePolicy) and **expo-image-manipulator**, delegate to **expo-expert**.\n\n**Diagnosis:**\n```bash\n# Check image component usage\ngrep -r \"from.*expo-image\\|from.*react-native.*Image\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -10\n\n# Find Image components without proper sizing\ngrep -r \"<Image\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | grep -v \"width\\|height\\|style\" | head -5\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Set explicit `width`/`height` on all images; avoid loading full-resolution images into thumbnail views\n2. **Better**: Store image URIs (file paths) instead of base64 data in state; use `resizeMode` consistently\n3. **Complete**: Implement progressive image loading; monitor memory usage in image-heavy lists\n\n**Validation:**\n- Verify images load without flicker by navigating between screens\n- Monitor memory usage when displaying image-heavy lists\n\n**Resources:**\n- https://reactnative.dev/docs/image\n- https://docs.expo.dev/versions/latest/sdk/image/","originalFile":"---\nname: react-native-expert\ndescription: React Native expert for mobile crashes, slow lists, gestures, native bridge issues, and platform-specific behavior. Use PROACTIVELY for RN component issues, animation problems, or mobile performance challenges.\ntools: Read, Grep, Glob, Bash, Edit, MultiEdit, Write\ncategory: framework\ncolor: blue\nbundle: [react-expert, react-performance-expert, expo-expert]\ndisplayName: React Native Expert\n---\n\n# React Native Expert\n\nYou are an expert in React Native with deep knowledge of mobile UI patterns, gesture handling, animations, list performance, platform-specific behavior on iOS and Android, and the New Architecture (Fabric + TurboModules).\n\n## When Invoked\n\n### Step 0: Recommend Specialist and Stop\nIf the issue is specifically about:\n- **Expo tooling** (CNG/prebuild, config plugins, EAS Build/Update/Submit, Expo Router file-based routing, Expo Modules API, DOM components, `expo-*` SDK packages, environment variables, `eas.json`, `app.json`/`app.config.ts` configuration): Stop and recommend expo-expert\n- **Pure React hooks or state patterns** (no RN-specific concern): Stop and recommend react-expert\n- **React rendering profiling and memoization** (not mobile-specific): Stop and recommend react-performance-expert\n- **Accessibility compliance**: Stop and recommend accessibility-expert\n- **Testing React Native components**: Stop and recommend the appropriate testing expert\n\n### Environment Detection\n```bash\n# Detect React Native and Expo versions\nnpm list react-native expo --depth=0 2>/dev/null || node -e \"const p=require('./package.json'); console.log('react-native:', p.dependencies?.['react-native'] || 'Not found'); console.log('expo:', p.dependencies?.expo || 'Not found')\" 2>/dev/null\n\n# Check Expo SDK version and architecture\nif [ -f \"app.json\" ]; then grep -E \"\\\"expo\\\"|\\\"sdkVersion\\\"\" app.json 2>/dev/null; fi\nif [ -f \"app.config.ts\" ] || [ -f \"app.config.js\" ]; then echo \"Dynamic Expo config detected\"; fi\n\n# Detect New Architecture\ngrep -r \"newArchEnabled\\|fabricEnabled\\|turboModules\" android/gradle.properties ios/Podfile app.json 2>/dev/null || echo \"New Architecture not detected\"\n\n# Check for Hermes\ngrep -r \"hermes\\|hermesEnabled\\|jsEngine\" android/gradle.properties app.json 2>/dev/null || echo \"Hermes config not found\"\n\n# Detect navigation library\nnpm list expo-router react-navigation @react-navigation/native --depth=0 2>/dev/null | grep -E \"(expo-router|react-navigation)\" || echo \"No navigation library detected\"\n\n# Detect animation and gesture libraries\nnpm list react-native-reanimated react-native-gesture-handler moti --depth=0 2>/dev/null | grep -E \"(reanimated|gesture-handler|moti)\" || echo \"No animation libraries detected\"\n\n# Detect state management\nnpm list zustand @tanstack/react-query jotai @reduxjs/toolkit legend-state --depth=0 2>/dev/null | grep -E \"(zustand|react-query|jotai|redux|legend)\" || echo \"No state management library detected\"\n```\n\n### Apply Strategy\n1. Identify the React Native-specific issue category\n2. Determine platform scope (iOS-only, Android-only, or cross-platform)\n3. Check for common anti-patterns in that category\n4. Apply progressive fixes (minimal to complete)\n5. Validate on both platforms when applicable\n\n## Problem Playbooks\n\n### List Performance\n**Common Issues:**\n- ScrollView rendering all children at once for large datasets\n- FlatList `renderItem` re-rendering every item on state change\n- Blank cells or janky scrolling in long lists\n- `getItemLayout` missing for fixed-height items causing scroll jumps\n\n**Diagnosis:**\n```bash\n# Find ScrollView usage that should be FlatList\ngrep -r \"ScrollView\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | grep -v \"node_modules\" | head -10\n\n# Check FlatList optimization props\ngrep -r \"FlatList\\|SectionList\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -10\n\n# Look for FlashList usage (preferred for large lists)\ngrep -r \"FlashList\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -5\n\n# Find inline renderItem functions (causes re-renders)\ngrep -B 2 -A 2 \"renderItem.*=>\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -20\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Replace ScrollView with FlatList for lists > 20 items, add `keyExtractor`\n2. **Better**: Extract `renderItem` to a stable reference, add `getItemLayout` for fixed heights, set `removeClippedSubviews`, `maxToRenderPerBatch`, `windowSize`\n3. **Complete**: Migrate to FlashList (`@shopify/flash-list`), provide `estimatedItemSize`, implement `CellRendererComponent` for complex layouts\n\n**Validation:**\n- Enable Perf Monitor (`Dev Menu > Show Perf Monitor`) and verify JS/UI frame rates stay at 60fps during scroll\n- Profile with Flipper or React DevTools to confirm renderItem calls are minimized\n\n**Resources:**\n- https://reactnative.dev/docs/optimizing-flatlist-configuration\n- https://shopify.github.io/flash-list/\n- https://reactnative.dev/docs/scrollview\n\n### Animations & Gestures\n**Common Issues:**\n- Animations running on JS thread causing dropped frames\n- Gesture Handler conflicts with ScrollView or navigation gestures\n- Reanimated worklet errors (\"Tried to synchronously call a non-worklet function\")\n- Layout animations causing crashes on Android\n\n**Diagnosis:**\n```bash\n# Check Reanimated version and babel plugin\nnpm list react-native-reanimated --depth=0 2>/dev/null\ngrep -r \"react-native-reanimated/plugin\" babel.config.js 2>/dev/null || echo \"Reanimated babel plugin not configured\"\n\n# Find Animated.Value usage (old API)\ngrep -r \"Animated\\.Value\\|Animated\\.timing\\|Animated\\.spring\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -10\n\n# Check for worklet functions\ngrep -r \"'worklet'\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -10\n\n# Find gesture handler usage\ngrep -r \"GestureDetector\\|PanGestureHandler\\|Gesture\\.\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -10\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Move animations to UI thread using `useAnimatedStyle` and `withTiming`/`withSpring`, add `'worklet'` directive to callbacks passed to `useAnimatedGestureHandler`\n2. **Better**: Replace old `Animated` API with Reanimated shared values, use `Gesture.Pan()` composable API instead of handler components, use `runOnJS` for JS thread callbacks\n3. **Complete**: Implement gesture-driven animations entirely on UI thread, use `useAnimatedScrollHandler` for scroll-linked animations, combine gestures with `Gesture.Simultaneous`/`Gesture.Exclusive`\n\n**Validation:**\n- Run with `JS Dev Mode` off to get accurate performance measurements\n- Verify animations maintain 60fps with Perf Monitor enabled\n- Test gesture interactions don't conflict with navigation back gesture\n\n**Resources:**\n- https://docs.swmansion.com/react-native-reanimated/\n- https://docs.swmansion.com/react-native-gesture-handler/\n- https://reactnative.dev/docs/animations\n\n### Navigation (React Navigation)\n**Common Issues:**\n- Screen not unmounting / effects not cleaning up on navigate away\n- Tab navigator re-rendering all tabs on state change\n- Header flickering or incorrect back button behavior\n- Navigation stack memory leaks from duplicate screens\n\n> For **Expo Router file-based routing** issues (route resolution, groups, API routes, typed routes), delegate to **expo-expert**.\n\n**Diagnosis:**\n```bash\n# Find navigation hooks usage\ngrep -r \"useNavigation\\|useFocusEffect\\|useRoute\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -10\n\n# Check for react-native-screens optimization\nnpm list react-native-screens --depth=0 2>/dev/null\ngrep -r \"enableScreens\\|createNativeStackNavigator\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -5\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Use `useFocusEffect` instead of `useEffect` for screen-specific side effects, add `unmountOnBlur` to tab screens that hold heavy state\n2. **Better**: Use `react-native-screens` native stack for native transitions, implement navigation state persistence\n3. **Complete**: Prefetch data on screen focus, architect navigation for minimal re-renders\n\n**Resources:**\n- https://reactnavigation.org/docs/getting-started\n- https://reactnative.dev/docs/navigation\n\n### Native Modules (TurboModules / JSI)\n**Common Issues:**\n- TurboModule registration failures on New Architecture\n- JSI bindings crashing on app startup\n- Pod install failures or Gradle build errors after adding native modules\n- Codegen spec not matching native implementation\n\n> For **Expo Modules API**, **config plugins**, and **prebuild** issues, delegate to **expo-expert**.\n\n**Diagnosis:**\n```bash\n# Verify pod installation state\nif [ -f \"ios/Podfile.lock\" ]; then echo \"Pods installed\"; grep -c \"PODS:\" ios/Podfile.lock; else echo \"No Podfile.lock\"; fi\n\n# Check for TurboModule specs\ngrep -r \"TurboModule\\|codegenNativeComponent\\|codegenNativeCommands\" --include=\"*.ts\" --include=\"*.tsx\" . 2>/dev/null | grep -v node_modules | head -5\n\n# Check New Architecture status\ngrep -r \"newArchEnabled\\|fabricEnabled\" android/gradle.properties 2>/dev/null\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Verify codegen spec matches native implementation signature; run `cd ios && pod install` for iOS dependency resolution\n2. **Better**: Implement TurboModule with JSI bindings for synchronous native access; create codegen spec for type-safe native interface\n3. **Complete**: Write C++ TurboModules for shared cross-platform native logic; implement native views with Fabric\n\n**Resources:**\n- https://reactnative.dev/docs/turbo-native-modules-introduction\n\n### Bundle & Startup Performance\n**Common Issues:**\n- Large bundle size from barrel exports pulling in unused code\n- Slow app startup from synchronous module initialization\n- Hermes bytecode not being generated (interpreting raw JS)\n- Unnecessary polyfills or duplicate dependencies in bundle\n\n**Diagnosis:**\n```bash\n# Check bundle size\nnpx react-native-bundle-visualizer 2>/dev/null || echo \"Install react-native-bundle-visualizer for analysis\"\n\n# Find barrel exports\ngrep -r \"export \\* from\\|export {\" --include=\"index.ts\" --include=\"index.tsx\" features/ lib/ | head -10\n\n# Check for heavy imports at module scope\ngrep -r \"^import.*from\" --include=\"*.tsx\" --include=\"*.ts\" features/ app/ | grep -E \"moment|lodash[^/]|aws-sdk[^/]\" | head -5\n\n# Verify Hermes is enabled\ngrep -r \"hermes\" android/gradle.properties ios/Podfile app.json 2>/dev/null | head -5\n\n# Check Metro config for tree shaking\nif [ -f \"metro.config.js\" ]; then cat metro.config.js; fi\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Replace barrel imports with direct file imports, enable Hermes if not already active, remove unused dependencies\n2. **Better**: Implement lazy `require()` for heavy modules used only in specific screens, configure Metro `transformer.minifierConfig` for better dead code elimination\n3. **Complete**: Profile startup with Hermes sampling profiler, implement app startup trace, defer non-critical initialization with `InteractionManager.runAfterInteractions`\n\n**Validation:**\n```bash\n# Measure bundle size\nnpx expo export --dump-sourcemap 2>/dev/null && echo \"Check source map for bundle analysis\"\n```\n\n**Resources:**\n- https://reactnative.dev/docs/performance\n- https://reactnative.dev/docs/hermes\n- https://docs.expo.dev/guides/analyzing-bundles/\n\n### Memory Management\n**Common Issues:**\n- Effects not cleaning up subscriptions or listeners on unmount\n- Large image data held in memory instead of referenced from file system\n- Event listeners accumulating from navigation between screens\n- AbortController not used for fetch cancellation\n\n**Diagnosis:**\n```bash\n# Find effects without cleanup\ngrep -A 8 \"useEffect\\|useFocusEffect\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | grep -B 5 \"useEffect\\|useFocusEffect\" | grep -c \"return \" || echo \"Check for missing cleanup functions\"\n\n# Find addEventListener without removeEventListener\ngrep -r \"addEventListener\\|addListener\\|\\.on(\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | grep -v \"remove\\|cleanup\\|unsubscribe\" | head -10\n\n# Check for base64 image data in state\ngrep -r \"base64\\|data:image\" --include=\"*.tsx\" --include=\"*.ts\" features/ app/ lib/ | head -5\n\n# Find fetch calls without AbortController\ngrep -r \"fetch(\" --include=\"*.tsx\" --include=\"*.ts\" features/ app/ lib/ | grep -v \"AbortController\\|abort\\|signal\" | head -10\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Add cleanup functions returning `removeEventListener`/`unsubscribe` to all effects, use AbortController with fetch\n2. **Better**: Store image URIs (file paths) instead of base64 data in state, implement proper cache eviction for image caches, use `useFocusEffect` for screen-scoped subscriptions\n3. **Complete**: Implement memory monitoring in development, use `expo-file-system` for large data storage, profile with Xcode Instruments (iOS) or Android Studio Profiler\n\n**Validation:**\n- Monitor memory usage in Xcode Instruments or Android Studio Profiler during screen transitions\n- Verify memory returns to baseline after navigating away from screens with heavy content\n\n**Resources:**\n- https://reactnative.dev/docs/performance#ram-bundles-inline-requires\n- https://docs.expo.dev/versions/latest/sdk/filesystem/\n- https://react.dev/learn/synchronizing-with-effects#how-to-handle-the-effect-firing-twice-in-development\n\n### Platform-Specific Issues\n**Common Issues:**\n- Safe area insets not applied correctly (notch/island/navigation bar)\n- Keyboard covering input fields on iOS vs Android different behavior\n- Shadow styles only working on iOS (Android requires `elevation`)\n- StatusBar styling inconsistencies between platforms\n- Platform-specific crashes from unsupported APIs\n\n**Diagnosis:**\n```bash\n# Find platform-specific code\ngrep -r \"Platform\\.OS\\|Platform\\.select\\|\\.ios\\.\\|\\.android\\.\" --include=\"*.tsx\" --include=\"*.tsx\" features/ app/ lib/ | head -10\n\n# Check safe area handling\ngrep -r \"SafeAreaView\\|useSafeAreaInsets\\|SafeAreaProvider\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -5\n\n# Find shadow styles without elevation\ngrep -r \"shadowColor\\|shadowOffset\\|shadowRadius\" --include=\"*.tsx\" --include=\"*.ts\" features/ app/ lib/ | grep -v \"elevation\" | head -5\n\n# Check keyboard handling\ngrep -r \"KeyboardAvoidingView\\|useKeyboard\\|keyboard\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -5\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Wrap root in `SafeAreaProvider`, use `useSafeAreaInsets` for custom layouts, add `elevation` alongside shadow styles for Android\n2. **Better**: Use `KeyboardAvoidingView` with `behavior=\"padding\"` on iOS and `behavior=\"height\"` on Android, handle `StatusBar` per-screen with `expo-status-bar`\n3. **Complete**: Create platform-aware style utilities, implement proper keyboard-aware scroll views, use `Platform.select` for divergent behavior, test on both platforms with various device sizes\n\n**Validation:**\n- Test on both iOS simulator and Android emulator\n- Verify safe area behavior on devices with notch/Dynamic Island and navigation bar\n\n**Resources:**\n- https://reactnative.dev/docs/platform-specific-code\n- https://reactnative.dev/docs/keyboardavoidingview\n- https://docs.expo.dev/versions/latest/sdk/safe-area-context/\n\n### Image Handling\n**Common Issues:**\n- Images loading slowly or flickering on re-render\n- Memory spikes from loading full-resolution images into views\n- Missing placeholder/blurhash during image load\n- Incorrect aspect ratio or cropping behavior\n- Cache not working across app restarts\n\n**Diagnosis:**\n```bash\n# Check image component usage\ngrep -r \"from.*expo-image\\|from.*react-native.*Image\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -10\n\n# Find Image components without proper sizing\ngrep -r \"<Image\\|<ExpoImage\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | grep -v \"width\\|height\\|style\" | head -5\n\n# Check for blurhash/placeholder usage\ngrep -r \"blurhash\\|placeholder\\|thumbhash\" --include=\"*.tsx\" --include=\"*.ts\" features/ app/ lib/ | head -5\n\n# Look for contentFit configuration\ngrep -r \"contentFit\\|resizeMode\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -10\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Use `expo-image` instead of RN `Image` for automatic caching and better performance, set explicit `width`/`height` or `contentFit`\n2. **Better**: Generate and store blurhash strings for placeholder display, use `contentFit=\"cover\"` for consistent layout, configure `cachePolicy=\"memory-disk\"`\n3. **Complete**: Implement progressive image loading (blurhash to thumbnail to full), resize images before display using `expo-image-manipulator`, implement custom cache management for offline support\n\n**Validation:**\n- Verify images load without flicker by navigating between screens\n- Monitor memory usage when displaying image-heavy lists\n\n**Resources:**\n- https://docs.expo.dev/versions/latest/sdk/image/\n- https://blurha.sh/\n- https://docs.expo.dev/versions/latest/sdk/image-manipulator/\n\n## Runtime Considerations\n- **Hermes Engine**: Default JS engine for React Native. Supports bytecode precompilation for faster startup. Some JS features (e.g., `Proxy` in older versions) may not be available. Always verify engine-specific behavior.\n- **New Architecture (Fabric + TurboModules)**: Enables synchronous native calls via JSI, concurrent rendering support, and codegen for type-safe native interfaces. May require library compatibility verification.\n- **React Compiler**: When enabled, automatically memoizes components and hooks. Reduces need for manual `useMemo`/`useCallback` but requires understanding of what the compiler can and cannot optimize.\n- **Metro Bundler**: Module resolution follows Metro conventions (platform extensions `.ios.tsx`/`.android.tsx`, Haste modules). Tree shaking is limited compared to web bundlers; prefer direct imports over barrel exports.\n- **Platform Threads**: JS thread (business logic), UI/Main thread (native UI updates), and Shadow thread (layout calculation). Animations and gestures should run on UI thread via Reanimated worklets. Long JS thread work blocks interactions.\n\n## Code Review Checklist\n\nWhen reviewing React Native code, focus on these mobile-specific aspects:\n\n### List Performance\n- [ ] Large lists use FlatList or FlashList, not ScrollView\n- [ ] `renderItem` extracted to stable function reference\n- [ ] `keyExtractor` provides unique, stable keys\n- [ ] `getItemLayout` provided for fixed-height items\n- [ ] `removeClippedSubviews` enabled for off-screen optimization\n\n### Animation & Gesture\n- [ ] Animations run on UI thread (Reanimated shared values, not Animated.Value)\n- [ ] Worklet directive present on UI thread callbacks\n- [ ] `runOnJS` used when calling JS functions from worklets\n- [ ] Gestures composed properly (Simultaneous, Exclusive, Race)\n- [ ] Layout animations tested on both platforms\n\n### Navigation\n- [ ] `useFocusEffect` used for screen-scoped side effects\n- [ ] Deep link paths registered and tested\n- [ ] Screen options set correctly (header, gestures, presentation)\n- [ ] Navigation types consistent (native stack for performance)\n- [ ] Tab screens use `unmountOnBlur` when holding heavy state\n\n### Native Integration\n- [ ] Config plugins used instead of manual native file edits\n- [ ] Native module errors handled gracefully in JS\n- [ ] Platform-specific code uses `Platform.select` or file extensions\n- [ ] Pod versions locked in Podfile for reproducible builds\n\n### Memory & Resources\n- [ ] Effects include cleanup functions\n- [ ] AbortController used for cancellable fetch requests\n- [ ] Image data stored as file URIs, not base64 in state\n- [ ] Event listeners removed on unmount\n- [ ] Large data processed with streaming or pagination\n\n### Platform Consistency\n- [ ] Safe area insets applied via `useSafeAreaInsets`\n- [ ] Shadows include `elevation` for Android\n- [ ] Keyboard avoidance configured per platform\n- [ ] StatusBar styled per screen\n- [ ] Touch targets meet minimum 44pt size\n\n### Image Optimization\n- [ ] `expo-image` used over RN `Image`\n- [ ] Blurhash or placeholder configured for loading state\n- [ ] `contentFit` set explicitly\n- [ ] Images sized appropriately (not loading 4K into thumbnails)\n- [ ] Cache policy configured for offline resilience\n\n### Bundle & Startup\n- [ ] No barrel export re-exports pulling in unused modules\n- [ ] Heavy libraries lazily required where possible\n- [ ] Hermes enabled and bytecode precompiled\n- [ ] Startup initialization deferred for non-critical work\n- [ ] Bundle size monitored and within budget\n\n## Safety Guidelines\n- Never modify native iOS/Android project files directly when a config plugin or prebuild can handle it; manual edits get overwritten by `expo prebuild`\n- Always test on both platforms after changes to layout, gestures, or native modules\n- Handle native module unavailability gracefully (null checks, try/catch) for Expo Go compatibility\n- Use `InteractionManager.runAfterInteractions` for expensive post-navigation work to avoid janky transitions\n- Never store sensitive data in AsyncStorage without encryption; use `expo-secure-store` for tokens and credentials\n- Pin native dependency versions to avoid breaking changes from auto-resolution during `pod install` or Gradle sync\n\n## Anti-Patterns to Avoid\n1. **ScrollView for Large Lists**: Always use FlatList/FlashList for dynamic data; ScrollView renders all children immediately\n2. **JS Thread Animations**: Never animate with `setState` in `requestAnimationFrame`; use Reanimated shared values on the UI thread\n3. **Inline Styles in Lists**: Creating new style objects per render forces layout recalculation; use `StyleSheet.create` or stable references\n4. **Base64 Images in State**: Holding large base64 strings in component state causes memory pressure; store file URIs and let the image component handle loading\n5. **Manual Native File Edits with Expo**: Editing `ios/` or `android/` directly in managed workflow; use config plugins so changes survive `expo prebuild --clean`\n6. **Ignoring Platform Differences**: Assuming iOS behavior on Android (shadows, keyboard, safe area); always verify with `Platform.OS` checks or platform extensions\n7. **Barrel Export Everything**: Re-exporting entire feature modules via `index.ts` defeats Metro's ability to skip unused code; import directly from source files\n8. **Uncontrolled Navigation State**: Pushing duplicate screens or not resetting stacks causes memory leaks and confusing back behavior\n9. **Synchronous Heavy Computation on JS Thread**: Blocks gestures and animations; offload to `requestIdleCallback`, web workers, or native modules\n10. **Skipping Cleanup in useFocusEffect**: Unlike `useEffect`, `useFocusEffect` fires on every screen focus; missing cleanup causes listener accumulation\n","structuredPatch":[{"oldStart":305,"oldLines":38,"newStart":305,"newLines":32,"lines":[" **Common Issues:**"," - Images loading slowly or flickering on re-render"," - Memory spikes from loading full-resolution images into views","-- Missing placeholder/blurhash during image load"," - Incorrect aspect ratio or cropping behavior"," - Cache not working across app restarts"," ","+> For **expo-image** specific configuration (blurhash, contentFit, cachePolicy) and **expo-image-manipulator**, delegate to **expo-expert**.","+"," **Diagnosis:**"," ```bash"," # Check image component usage"," grep -r \"from.*expo-image\\|from.*react-native.*Image\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -10"," "," # Find Image components without proper sizing","-grep -r \"<Image\\|<ExpoImage\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | grep -v \"width\\|height\\|style\" | head -5","-","-# Check for blurhash/placeholder usage","-grep -r \"blurhash\\|placeholder\\|thumbhash\" --include=\"*.tsx\" --include=\"*.ts\" features/ app/ lib/ | head -5","-","-# Look for contentFit configuration","-grep -r \"contentFit\\|resizeMode\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -10","+grep -r \"<Image\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | grep -v \"width\\|height\\|style\" | head -5"," ```"," "," **Prioritized Fixes:**","-1. **Minimal**: Use `expo-image` instead of RN `Image` for automatic caching and better performance, set explicit `width`/`height` or `contentFit`","-2. **Better**: Generate and store blurhash strings for placeholder display, use `contentFit=\"cover\"` for consistent layout, configure `cachePolicy=\"memory-disk\"`","-3. **Complete**: Implement progressive image loading (blurhash to thumbnail to full), resize images before display using `expo-image-manipulator`, implement custom cache management for offline support","+1. **Minimal**: Set explicit `width`/`height` on all images; avoid loading full-resolution images into thumbnail views","+2. **Better**: Store image URIs (file paths) instead of base64 data in state; use `resizeMode` consistently","+3. **Complete**: Implement progressive image loading; monitor memory usage in image-heavy lists"," "," **Validation:**"," - Verify images load without flicker by navigating between screens"," - Monitor memory usage when displaying image-heavy lists"," "," **Resources:**","+- https://reactnative.dev/docs/image"," - https://docs.expo.dev/versions/latest/sdk/image/","-- https://blurha.sh/","-- https://docs.expo.dev/versions/latest/sdk/image-manipulator/"," "," ## Runtime Considerations"," - **Hermes Engine**: Default JS engine for React Native. Supports bytecode precompilation for faster startup. Some JS features (e.g., `Proxy` in older versions) may not be available. Always verify engine-specific behavior."]}],"userModified":false,"replaceAll":false},"sourceToolAssistantUUID":"15bc100f-d735-4823-99ae-864c1297bf0d"}
{"parentUuid":"5a203f61-e60c-4979-aeee-a2e4f0303cb2","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","message":{"model":"claude-opus-4-6","id":"msg_01JiBs81bZ28t6sWDXh4kwZq","type":"message","role":"assistant","content":[{"type":"text","text":"Now update the Code Review Checklist to remove Expo-specific items and add delegation notes:"}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":1038,"cache_read_input_tokens":76306,"cache_creation":{"ephemeral_5m_input_tokens":1038,"ephemeral_1h_input_tokens":0},"output_tokens":2,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CYERShFoeoRBoDV4SorXG","type":"assistant","uuid":"44a723fb-b94d-4e06-96c0-103224263ec4","timestamp":"2026-02-17T22:22:30.387Z"}
{"parentUuid":"44a723fb-b94d-4e06-96c0-103224263ec4","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","message":{"model":"claude-opus-4-6","id":"msg_01JiBs81bZ28t6sWDXh4kwZq","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01RcdjkDni7nkzgEsc16pRbb","name":"Edit","input":{"replace_all":false,"file_path":"/Users/eryk.napierala/Development/fasola/.claude/agents/react-native/react-native-expert.md","old_string":"### Native Integration\n- [ ] Config plugins used instead of manual native file edits\n- [ ] Native module errors handled gracefully in JS\n- [ ] Platform-specific code uses `Platform.select` or file extensions\n- [ ] Pod versions locked in Podfile for reproducible builds","new_string":"### Native Integration\n- [ ] Native module errors handled gracefully in JS\n- [ ] Platform-specific code uses `Platform.select` or file extensions\n- [ ] Pod versions locked in Podfile for reproducible builds\n- [ ] TurboModule/Fabric specs match native implementations"},"caller":{"type":"direct"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":1038,"cache_read_input_tokens":76306,"cache_creation":{"ephemeral_5m_input_tokens":1038,"ephemeral_1h_input_tokens":0},"output_tokens":2,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CYERShFoeoRBoDV4SorXG","type":"assistant","uuid":"0980b39f-d8e8-4b8c-a9bf-3dd14929c30c","timestamp":"2026-02-17T22:22:33.777Z"}
{"parentUuid":"0980b39f-d8e8-4b8c-a9bf-3dd14929c30c","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"progress","data":{"type":"hook_progress","hookEvent":"PreToolUse","hookName":"PreToolUse:Edit","command":"claudekit-hooks run file-guard"},"toolUseID":"toolu_01RcdjkDni7nkzgEsc16pRbb","parentToolUseID":"toolu_01RcdjkDni7nkzgEsc16pRbb","uuid":"953a26b6-b65f-4802-9624-eaa7132b4b9f","timestamp":"2026-02-17T22:22:33.779Z"}
{"parentUuid":"953a26b6-b65f-4802-9624-eaa7132b4b9f","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Edit","command":"claudekit-hooks run check-comment-replacement"},"parentToolUseID":"toolu_01RcdjkDni7nkzgEsc16pRbb","toolUseID":"toolu_01RcdjkDni7nkzgEsc16pRbb","timestamp":"2026-02-17T22:22:34.361Z","uuid":"6e659828-f116-47de-8ad2-6f9ba79525c2"}
{"parentUuid":"6e659828-f116-47de-8ad2-6f9ba79525c2","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Edit","command":"claudekit-hooks run check-unused-parameters"},"parentToolUseID":"toolu_01RcdjkDni7nkzgEsc16pRbb","toolUseID":"toolu_01RcdjkDni7nkzgEsc16pRbb","timestamp":"2026-02-17T22:22:34.361Z","uuid":"5991a2fb-263d-4773-b05c-998bde2c6c51"}
{"parentUuid":"5991a2fb-263d-4773-b05c-998bde2c6c51","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Edit","command":"claudekit-hooks run lint-changed"},"parentToolUseID":"toolu_01RcdjkDni7nkzgEsc16pRbb","toolUseID":"toolu_01RcdjkDni7nkzgEsc16pRbb","timestamp":"2026-02-17T22:22:34.361Z","uuid":"f98313cd-1b69-4a42-95cb-c609c4266e62"}
{"parentUuid":"f98313cd-1b69-4a42-95cb-c609c4266e62","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Edit","command":"claudekit-hooks run typecheck-changed"},"parentToolUseID":"toolu_01RcdjkDni7nkzgEsc16pRbb","toolUseID":"toolu_01RcdjkDni7nkzgEsc16pRbb","timestamp":"2026-02-17T22:22:34.361Z","uuid":"13cb806c-4f7c-4ef8-b9a3-c5314d4d32cf"}
{"parentUuid":"13cb806c-4f7c-4ef8-b9a3-c5314d4d32cf","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Edit","command":"claudekit-hooks run check-any-changed"},"parentToolUseID":"toolu_01RcdjkDni7nkzgEsc16pRbb","toolUseID":"toolu_01RcdjkDni7nkzgEsc16pRbb","timestamp":"2026-02-17T22:22:34.361Z","uuid":"d62572d4-5437-47c7-9e75-30b49e47be42"}
{"parentUuid":"d62572d4-5437-47c7-9e75-30b49e47be42","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Edit","command":"claudekit-hooks run test-changed"},"parentToolUseID":"toolu_01RcdjkDni7nkzgEsc16pRbb","toolUseID":"toolu_01RcdjkDni7nkzgEsc16pRbb","timestamp":"2026-02-17T22:22:34.361Z","uuid":"d2794f00-66ab-4ebe-839f-878861f31aba"}
{"parentUuid":"d2794f00-66ab-4ebe-839f-878861f31aba","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Edit","command":"callback"},"parentToolUseID":"toolu_01RcdjkDni7nkzgEsc16pRbb","toolUseID":"toolu_01RcdjkDni7nkzgEsc16pRbb","timestamp":"2026-02-17T22:22:34.361Z","uuid":"7f5ac749-966e-4b7f-8d97-81b4fbb13f00"}
{"parentUuid":"0980b39f-d8e8-4b8c-a9bf-3dd14929c30c","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01RcdjkDni7nkzgEsc16pRbb","type":"tool_result","content":"The file /Users/eryk.napierala/Development/fasola/.claude/agents/react-native/react-native-expert.md has been updated successfully."}]},"uuid":"b8f6110b-8c80-4986-b731-02557e199cba","timestamp":"2026-02-17T22:22:34.360Z","toolUseResult":{"filePath":"/Users/eryk.napierala/Development/fasola/.claude/agents/react-native/react-native-expert.md","oldString":"### Native Integration\n- [ ] Config plugins used instead of manual native file edits\n- [ ] Native module errors handled gracefully in JS\n- [ ] Platform-specific code uses `Platform.select` or file extensions\n- [ ] Pod versions locked in Podfile for reproducible builds","newString":"### Native Integration\n- [ ] Native module errors handled gracefully in JS\n- [ ] Platform-specific code uses `Platform.select` or file extensions\n- [ ] Pod versions locked in Podfile for reproducible builds\n- [ ] TurboModule/Fabric specs match native implementations","originalFile":"---\nname: react-native-expert\ndescription: React Native expert for mobile crashes, slow lists, gestures, native bridge issues, and platform-specific behavior. Use PROACTIVELY for RN component issues, animation problems, or mobile performance challenges.\ntools: Read, Grep, Glob, Bash, Edit, MultiEdit, Write\ncategory: framework\ncolor: blue\nbundle: [react-expert, react-performance-expert, expo-expert]\ndisplayName: React Native Expert\n---\n\n# React Native Expert\n\nYou are an expert in React Native with deep knowledge of mobile UI patterns, gesture handling, animations, list performance, platform-specific behavior on iOS and Android, and the New Architecture (Fabric + TurboModules).\n\n## When Invoked\n\n### Step 0: Recommend Specialist and Stop\nIf the issue is specifically about:\n- **Expo tooling** (CNG/prebuild, config plugins, EAS Build/Update/Submit, Expo Router file-based routing, Expo Modules API, DOM components, `expo-*` SDK packages, environment variables, `eas.json`, `app.json`/`app.config.ts` configuration): Stop and recommend expo-expert\n- **Pure React hooks or state patterns** (no RN-specific concern): Stop and recommend react-expert\n- **React rendering profiling and memoization** (not mobile-specific): Stop and recommend react-performance-expert\n- **Accessibility compliance**: Stop and recommend accessibility-expert\n- **Testing React Native components**: Stop and recommend the appropriate testing expert\n\n### Environment Detection\n```bash\n# Detect React Native and Expo versions\nnpm list react-native expo --depth=0 2>/dev/null || node -e \"const p=require('./package.json'); console.log('react-native:', p.dependencies?.['react-native'] || 'Not found'); console.log('expo:', p.dependencies?.expo || 'Not found')\" 2>/dev/null\n\n# Check Expo SDK version and architecture\nif [ -f \"app.json\" ]; then grep -E \"\\\"expo\\\"|\\\"sdkVersion\\\"\" app.json 2>/dev/null; fi\nif [ -f \"app.config.ts\" ] || [ -f \"app.config.js\" ]; then echo \"Dynamic Expo config detected\"; fi\n\n# Detect New Architecture\ngrep -r \"newArchEnabled\\|fabricEnabled\\|turboModules\" android/gradle.properties ios/Podfile app.json 2>/dev/null || echo \"New Architecture not detected\"\n\n# Check for Hermes\ngrep -r \"hermes\\|hermesEnabled\\|jsEngine\" android/gradle.properties app.json 2>/dev/null || echo \"Hermes config not found\"\n\n# Detect navigation library\nnpm list expo-router react-navigation @react-navigation/native --depth=0 2>/dev/null | grep -E \"(expo-router|react-navigation)\" || echo \"No navigation library detected\"\n\n# Detect animation and gesture libraries\nnpm list react-native-reanimated react-native-gesture-handler moti --depth=0 2>/dev/null | grep -E \"(reanimated|gesture-handler|moti)\" || echo \"No animation libraries detected\"\n\n# Detect state management\nnpm list zustand @tanstack/react-query jotai @reduxjs/toolkit legend-state --depth=0 2>/dev/null | grep -E \"(zustand|react-query|jotai|redux|legend)\" || echo \"No state management library detected\"\n```\n\n### Apply Strategy\n1. Identify the React Native-specific issue category\n2. Determine platform scope (iOS-only, Android-only, or cross-platform)\n3. Check for common anti-patterns in that category\n4. Apply progressive fixes (minimal to complete)\n5. Validate on both platforms when applicable\n\n## Problem Playbooks\n\n### List Performance\n**Common Issues:**\n- ScrollView rendering all children at once for large datasets\n- FlatList `renderItem` re-rendering every item on state change\n- Blank cells or janky scrolling in long lists\n- `getItemLayout` missing for fixed-height items causing scroll jumps\n\n**Diagnosis:**\n```bash\n# Find ScrollView usage that should be FlatList\ngrep -r \"ScrollView\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | grep -v \"node_modules\" | head -10\n\n# Check FlatList optimization props\ngrep -r \"FlatList\\|SectionList\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -10\n\n# Look for FlashList usage (preferred for large lists)\ngrep -r \"FlashList\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -5\n\n# Find inline renderItem functions (causes re-renders)\ngrep -B 2 -A 2 \"renderItem.*=>\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -20\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Replace ScrollView with FlatList for lists > 20 items, add `keyExtractor`\n2. **Better**: Extract `renderItem` to a stable reference, add `getItemLayout` for fixed heights, set `removeClippedSubviews`, `maxToRenderPerBatch`, `windowSize`\n3. **Complete**: Migrate to FlashList (`@shopify/flash-list`), provide `estimatedItemSize`, implement `CellRendererComponent` for complex layouts\n\n**Validation:**\n- Enable Perf Monitor (`Dev Menu > Show Perf Monitor`) and verify JS/UI frame rates stay at 60fps during scroll\n- Profile with Flipper or React DevTools to confirm renderItem calls are minimized\n\n**Resources:**\n- https://reactnative.dev/docs/optimizing-flatlist-configuration\n- https://shopify.github.io/flash-list/\n- https://reactnative.dev/docs/scrollview\n\n### Animations & Gestures\n**Common Issues:**\n- Animations running on JS thread causing dropped frames\n- Gesture Handler conflicts with ScrollView or navigation gestures\n- Reanimated worklet errors (\"Tried to synchronously call a non-worklet function\")\n- Layout animations causing crashes on Android\n\n**Diagnosis:**\n```bash\n# Check Reanimated version and babel plugin\nnpm list react-native-reanimated --depth=0 2>/dev/null\ngrep -r \"react-native-reanimated/plugin\" babel.config.js 2>/dev/null || echo \"Reanimated babel plugin not configured\"\n\n# Find Animated.Value usage (old API)\ngrep -r \"Animated\\.Value\\|Animated\\.timing\\|Animated\\.spring\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -10\n\n# Check for worklet functions\ngrep -r \"'worklet'\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -10\n\n# Find gesture handler usage\ngrep -r \"GestureDetector\\|PanGestureHandler\\|Gesture\\.\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -10\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Move animations to UI thread using `useAnimatedStyle` and `withTiming`/`withSpring`, add `'worklet'` directive to callbacks passed to `useAnimatedGestureHandler`\n2. **Better**: Replace old `Animated` API with Reanimated shared values, use `Gesture.Pan()` composable API instead of handler components, use `runOnJS` for JS thread callbacks\n3. **Complete**: Implement gesture-driven animations entirely on UI thread, use `useAnimatedScrollHandler` for scroll-linked animations, combine gestures with `Gesture.Simultaneous`/`Gesture.Exclusive`\n\n**Validation:**\n- Run with `JS Dev Mode` off to get accurate performance measurements\n- Verify animations maintain 60fps with Perf Monitor enabled\n- Test gesture interactions don't conflict with navigation back gesture\n\n**Resources:**\n- https://docs.swmansion.com/react-native-reanimated/\n- https://docs.swmansion.com/react-native-gesture-handler/\n- https://reactnative.dev/docs/animations\n\n### Navigation (React Navigation)\n**Common Issues:**\n- Screen not unmounting / effects not cleaning up on navigate away\n- Tab navigator re-rendering all tabs on state change\n- Header flickering or incorrect back button behavior\n- Navigation stack memory leaks from duplicate screens\n\n> For **Expo Router file-based routing** issues (route resolution, groups, API routes, typed routes), delegate to **expo-expert**.\n\n**Diagnosis:**\n```bash\n# Find navigation hooks usage\ngrep -r \"useNavigation\\|useFocusEffect\\|useRoute\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -10\n\n# Check for react-native-screens optimization\nnpm list react-native-screens --depth=0 2>/dev/null\ngrep -r \"enableScreens\\|createNativeStackNavigator\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -5\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Use `useFocusEffect` instead of `useEffect` for screen-specific side effects, add `unmountOnBlur` to tab screens that hold heavy state\n2. **Better**: Use `react-native-screens` native stack for native transitions, implement navigation state persistence\n3. **Complete**: Prefetch data on screen focus, architect navigation for minimal re-renders\n\n**Resources:**\n- https://reactnavigation.org/docs/getting-started\n- https://reactnative.dev/docs/navigation\n\n### Native Modules (TurboModules / JSI)\n**Common Issues:**\n- TurboModule registration failures on New Architecture\n- JSI bindings crashing on app startup\n- Pod install failures or Gradle build errors after adding native modules\n- Codegen spec not matching native implementation\n\n> For **Expo Modules API**, **config plugins**, and **prebuild** issues, delegate to **expo-expert**.\n\n**Diagnosis:**\n```bash\n# Verify pod installation state\nif [ -f \"ios/Podfile.lock\" ]; then echo \"Pods installed\"; grep -c \"PODS:\" ios/Podfile.lock; else echo \"No Podfile.lock\"; fi\n\n# Check for TurboModule specs\ngrep -r \"TurboModule\\|codegenNativeComponent\\|codegenNativeCommands\" --include=\"*.ts\" --include=\"*.tsx\" . 2>/dev/null | grep -v node_modules | head -5\n\n# Check New Architecture status\ngrep -r \"newArchEnabled\\|fabricEnabled\" android/gradle.properties 2>/dev/null\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Verify codegen spec matches native implementation signature; run `cd ios && pod install` for iOS dependency resolution\n2. **Better**: Implement TurboModule with JSI bindings for synchronous native access; create codegen spec for type-safe native interface\n3. **Complete**: Write C++ TurboModules for shared cross-platform native logic; implement native views with Fabric\n\n**Resources:**\n- https://reactnative.dev/docs/turbo-native-modules-introduction\n\n### Bundle & Startup Performance\n**Common Issues:**\n- Large bundle size from barrel exports pulling in unused code\n- Slow app startup from synchronous module initialization\n- Hermes bytecode not being generated (interpreting raw JS)\n- Unnecessary polyfills or duplicate dependencies in bundle\n\n**Diagnosis:**\n```bash\n# Check bundle size\nnpx react-native-bundle-visualizer 2>/dev/null || echo \"Install react-native-bundle-visualizer for analysis\"\n\n# Find barrel exports\ngrep -r \"export \\* from\\|export {\" --include=\"index.ts\" --include=\"index.tsx\" features/ lib/ | head -10\n\n# Check for heavy imports at module scope\ngrep -r \"^import.*from\" --include=\"*.tsx\" --include=\"*.ts\" features/ app/ | grep -E \"moment|lodash[^/]|aws-sdk[^/]\" | head -5\n\n# Verify Hermes is enabled\ngrep -r \"hermes\" android/gradle.properties ios/Podfile app.json 2>/dev/null | head -5\n\n# Check Metro config for tree shaking\nif [ -f \"metro.config.js\" ]; then cat metro.config.js; fi\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Replace barrel imports with direct file imports, enable Hermes if not already active, remove unused dependencies\n2. **Better**: Implement lazy `require()` for heavy modules used only in specific screens, configure Metro `transformer.minifierConfig` for better dead code elimination\n3. **Complete**: Profile startup with Hermes sampling profiler, implement app startup trace, defer non-critical initialization with `InteractionManager.runAfterInteractions`\n\n**Validation:**\n```bash\n# Measure bundle size\nnpx expo export --dump-sourcemap 2>/dev/null && echo \"Check source map for bundle analysis\"\n```\n\n**Resources:**\n- https://reactnative.dev/docs/performance\n- https://reactnative.dev/docs/hermes\n- https://docs.expo.dev/guides/analyzing-bundles/\n\n### Memory Management\n**Common Issues:**\n- Effects not cleaning up subscriptions or listeners on unmount\n- Large image data held in memory instead of referenced from file system\n- Event listeners accumulating from navigation between screens\n- AbortController not used for fetch cancellation\n\n**Diagnosis:**\n```bash\n# Find effects without cleanup\ngrep -A 8 \"useEffect\\|useFocusEffect\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | grep -B 5 \"useEffect\\|useFocusEffect\" | grep -c \"return \" || echo \"Check for missing cleanup functions\"\n\n# Find addEventListener without removeEventListener\ngrep -r \"addEventListener\\|addListener\\|\\.on(\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | grep -v \"remove\\|cleanup\\|unsubscribe\" | head -10\n\n# Check for base64 image data in state\ngrep -r \"base64\\|data:image\" --include=\"*.tsx\" --include=\"*.ts\" features/ app/ lib/ | head -5\n\n# Find fetch calls without AbortController\ngrep -r \"fetch(\" --include=\"*.tsx\" --include=\"*.ts\" features/ app/ lib/ | grep -v \"AbortController\\|abort\\|signal\" | head -10\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Add cleanup functions returning `removeEventListener`/`unsubscribe` to all effects, use AbortController with fetch\n2. **Better**: Store image URIs (file paths) instead of base64 data in state, implement proper cache eviction for image caches, use `useFocusEffect` for screen-scoped subscriptions\n3. **Complete**: Implement memory monitoring in development, use `expo-file-system` for large data storage, profile with Xcode Instruments (iOS) or Android Studio Profiler\n\n**Validation:**\n- Monitor memory usage in Xcode Instruments or Android Studio Profiler during screen transitions\n- Verify memory returns to baseline after navigating away from screens with heavy content\n\n**Resources:**\n- https://reactnative.dev/docs/performance#ram-bundles-inline-requires\n- https://docs.expo.dev/versions/latest/sdk/filesystem/\n- https://react.dev/learn/synchronizing-with-effects#how-to-handle-the-effect-firing-twice-in-development\n\n### Platform-Specific Issues\n**Common Issues:**\n- Safe area insets not applied correctly (notch/island/navigation bar)\n- Keyboard covering input fields on iOS vs Android different behavior\n- Shadow styles only working on iOS (Android requires `elevation`)\n- StatusBar styling inconsistencies between platforms\n- Platform-specific crashes from unsupported APIs\n\n**Diagnosis:**\n```bash\n# Find platform-specific code\ngrep -r \"Platform\\.OS\\|Platform\\.select\\|\\.ios\\.\\|\\.android\\.\" --include=\"*.tsx\" --include=\"*.tsx\" features/ app/ lib/ | head -10\n\n# Check safe area handling\ngrep -r \"SafeAreaView\\|useSafeAreaInsets\\|SafeAreaProvider\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -5\n\n# Find shadow styles without elevation\ngrep -r \"shadowColor\\|shadowOffset\\|shadowRadius\" --include=\"*.tsx\" --include=\"*.ts\" features/ app/ lib/ | grep -v \"elevation\" | head -5\n\n# Check keyboard handling\ngrep -r \"KeyboardAvoidingView\\|useKeyboard\\|keyboard\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -5\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Wrap root in `SafeAreaProvider`, use `useSafeAreaInsets` for custom layouts, add `elevation` alongside shadow styles for Android\n2. **Better**: Use `KeyboardAvoidingView` with `behavior=\"padding\"` on iOS and `behavior=\"height\"` on Android, handle `StatusBar` per-screen with `expo-status-bar`\n3. **Complete**: Create platform-aware style utilities, implement proper keyboard-aware scroll views, use `Platform.select` for divergent behavior, test on both platforms with various device sizes\n\n**Validation:**\n- Test on both iOS simulator and Android emulator\n- Verify safe area behavior on devices with notch/Dynamic Island and navigation bar\n\n**Resources:**\n- https://reactnative.dev/docs/platform-specific-code\n- https://reactnative.dev/docs/keyboardavoidingview\n- https://docs.expo.dev/versions/latest/sdk/safe-area-context/\n\n### Image Handling\n**Common Issues:**\n- Images loading slowly or flickering on re-render\n- Memory spikes from loading full-resolution images into views\n- Incorrect aspect ratio or cropping behavior\n- Cache not working across app restarts\n\n> For **expo-image** specific configuration (blurhash, contentFit, cachePolicy) and **expo-image-manipulator**, delegate to **expo-expert**.\n\n**Diagnosis:**\n```bash\n# Check image component usage\ngrep -r \"from.*expo-image\\|from.*react-native.*Image\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -10\n\n# Find Image components without proper sizing\ngrep -r \"<Image\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | grep -v \"width\\|height\\|style\" | head -5\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Set explicit `width`/`height` on all images; avoid loading full-resolution images into thumbnail views\n2. **Better**: Store image URIs (file paths) instead of base64 data in state; use `resizeMode` consistently\n3. **Complete**: Implement progressive image loading; monitor memory usage in image-heavy lists\n\n**Validation:**\n- Verify images load without flicker by navigating between screens\n- Monitor memory usage when displaying image-heavy lists\n\n**Resources:**\n- https://reactnative.dev/docs/image\n- https://docs.expo.dev/versions/latest/sdk/image/\n\n## Runtime Considerations\n- **Hermes Engine**: Default JS engine for React Native. Supports bytecode precompilation for faster startup. Some JS features (e.g., `Proxy` in older versions) may not be available. Always verify engine-specific behavior.\n- **New Architecture (Fabric + TurboModules)**: Enables synchronous native calls via JSI, concurrent rendering support, and codegen for type-safe native interfaces. May require library compatibility verification.\n- **React Compiler**: When enabled, automatically memoizes components and hooks. Reduces need for manual `useMemo`/`useCallback` but requires understanding of what the compiler can and cannot optimize.\n- **Metro Bundler**: Module resolution follows Metro conventions (platform extensions `.ios.tsx`/`.android.tsx`, Haste modules). Tree shaking is limited compared to web bundlers; prefer direct imports over barrel exports.\n- **Platform Threads**: JS thread (business logic), UI/Main thread (native UI updates), and Shadow thread (layout calculation). Animations and gestures should run on UI thread via Reanimated worklets. Long JS thread work blocks interactions.\n\n## Code Review Checklist\n\nWhen reviewing React Native code, focus on these mobile-specific aspects:\n\n### List Performance\n- [ ] Large lists use FlatList or FlashList, not ScrollView\n- [ ] `renderItem` extracted to stable function reference\n- [ ] `keyExtractor` provides unique, stable keys\n- [ ] `getItemLayout` provided for fixed-height items\n- [ ] `removeClippedSubviews` enabled for off-screen optimization\n\n### Animation & Gesture\n- [ ] Animations run on UI thread (Reanimated shared values, not Animated.Value)\n- [ ] Worklet directive present on UI thread callbacks\n- [ ] `runOnJS` used when calling JS functions from worklets\n- [ ] Gestures composed properly (Simultaneous, Exclusive, Race)\n- [ ] Layout animations tested on both platforms\n\n### Navigation\n- [ ] `useFocusEffect` used for screen-scoped side effects\n- [ ] Deep link paths registered and tested\n- [ ] Screen options set correctly (header, gestures, presentation)\n- [ ] Navigation types consistent (native stack for performance)\n- [ ] Tab screens use `unmountOnBlur` when holding heavy state\n\n### Native Integration\n- [ ] Config plugins used instead of manual native file edits\n- [ ] Native module errors handled gracefully in JS\n- [ ] Platform-specific code uses `Platform.select` or file extensions\n- [ ] Pod versions locked in Podfile for reproducible builds\n\n### Memory & Resources\n- [ ] Effects include cleanup functions\n- [ ] AbortController used for cancellable fetch requests\n- [ ] Image data stored as file URIs, not base64 in state\n- [ ] Event listeners removed on unmount\n- [ ] Large data processed with streaming or pagination\n\n### Platform Consistency\n- [ ] Safe area insets applied via `useSafeAreaInsets`\n- [ ] Shadows include `elevation` for Android\n- [ ] Keyboard avoidance configured per platform\n- [ ] StatusBar styled per screen\n- [ ] Touch targets meet minimum 44pt size\n\n### Image Optimization\n- [ ] `expo-image` used over RN `Image`\n- [ ] Blurhash or placeholder configured for loading state\n- [ ] `contentFit` set explicitly\n- [ ] Images sized appropriately (not loading 4K into thumbnails)\n- [ ] Cache policy configured for offline resilience\n\n### Bundle & Startup\n- [ ] No barrel export re-exports pulling in unused modules\n- [ ] Heavy libraries lazily required where possible\n- [ ] Hermes enabled and bytecode precompiled\n- [ ] Startup initialization deferred for non-critical work\n- [ ] Bundle size monitored and within budget\n\n## Safety Guidelines\n- Never modify native iOS/Android project files directly when a config plugin or prebuild can handle it; manual edits get overwritten by `expo prebuild`\n- Always test on both platforms after changes to layout, gestures, or native modules\n- Handle native module unavailability gracefully (null checks, try/catch) for Expo Go compatibility\n- Use `InteractionManager.runAfterInteractions` for expensive post-navigation work to avoid janky transitions\n- Never store sensitive data in AsyncStorage without encryption; use `expo-secure-store` for tokens and credentials\n- Pin native dependency versions to avoid breaking changes from auto-resolution during `pod install` or Gradle sync\n\n## Anti-Patterns to Avoid\n1. **ScrollView for Large Lists**: Always use FlatList/FlashList for dynamic data; ScrollView renders all children immediately\n2. **JS Thread Animations**: Never animate with `setState` in `requestAnimationFrame`; use Reanimated shared values on the UI thread\n3. **Inline Styles in Lists**: Creating new style objects per render forces layout recalculation; use `StyleSheet.create` or stable references\n4. **Base64 Images in State**: Holding large base64 strings in component state causes memory pressure; store file URIs and let the image component handle loading\n5. **Manual Native File Edits with Expo**: Editing `ios/` or `android/` directly in managed workflow; use config plugins so changes survive `expo prebuild --clean`\n6. **Ignoring Platform Differences**: Assuming iOS behavior on Android (shadows, keyboard, safe area); always verify with `Platform.OS` checks or platform extensions\n7. **Barrel Export Everything**: Re-exporting entire feature modules via `index.ts` defeats Metro's ability to skip unused code; import directly from source files\n8. **Uncontrolled Navigation State**: Pushing duplicate screens or not resetting stacks causes memory leaks and confusing back behavior\n9. **Synchronous Heavy Computation on JS Thread**: Blocks gestures and animations; offload to `requestIdleCallback`, web workers, or native modules\n10. **Skipping Cleanup in useFocusEffect**: Unlike `useEffect`, `useFocusEffect` fires on every screen focus; missing cleanup causes listener accumulation\n","structuredPatch":[{"oldStart":365,"oldLines":10,"newStart":365,"newLines":10,"lines":[" - [ ] Tab screens use `unmountOnBlur` when holding heavy state"," "," ### Native Integration","-- [ ] Config plugins used instead of manual native file edits"," - [ ] Native module errors handled gracefully in JS"," - [ ] Platform-specific code uses `Platform.select` or file extensions"," - [ ] Pod versions locked in Podfile for reproducible builds","+- [ ] TurboModule/Fabric specs match native implementations"," "," ### Memory & Resources"," - [ ] Effects include cleanup functions"]}],"userModified":false,"replaceAll":false},"sourceToolAssistantUUID":"0980b39f-d8e8-4b8c-a9bf-3dd14929c30c"}
{"parentUuid":"b8f6110b-8c80-4986-b731-02557e199cba","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","message":{"model":"claude-opus-4-6","id":"msg_01SkAHRbKV4yGfioF859gEA5","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01A4AsyVwX2XJgwbWP2RtpBv","name":"Edit","input":{"replace_all":false,"file_path":"/Users/eryk.napierala/Development/fasola/.claude/agents/react-native/react-native-expert.md","old_string":"### Image Optimization\n- [ ] `expo-image` used over RN `Image`\n- [ ] Blurhash or placeholder configured for loading state\n- [ ] `contentFit` set explicitly\n- [ ] Images sized appropriately (not loading 4K into thumbnails)\n- [ ] Cache policy configured for offline resilience\n\n### Bundle & Startup\n- [ ] No barrel export re-exports pulling in unused modules\n- [ ] Heavy libraries lazily required where possible\n- [ ] Hermes enabled and bytecode precompiled\n- [ ] Startup initialization deferred for non-critical work\n- [ ] Bundle size monitored and within budget","new_string":"### Image Optimization\n- [ ] Images sized appropriately (not loading 4K into thumbnails)\n- [ ] Image data stored as file URIs, not base64 in state\n- [ ] Explicit width/height or resizeMode set on all images\n\n### Bundle & Startup\n- [ ] No barrel export re-exports pulling in unused modules\n- [ ] Heavy libraries lazily required where possible\n- [ ] Hermes enabled and bytecode precompiled\n- [ ] Startup initialization deferred for non-critical work\n- [ ] Bundle size monitored and within budget\n\n> For Expo-specific review items (config plugins, EAS, Expo Router, SDK packages, env vars), see **expo-expert** checklist."},"caller":{"type":"direct"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":329,"cache_read_input_tokens":77344,"cache_creation":{"ephemeral_5m_input_tokens":329,"ephemeral_1h_input_tokens":0},"output_tokens":24,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CYERTDR1se9YoWd9uCeEg","type":"assistant","uuid":"c3604591-f937-4e7e-bc4e-4a687db6ce3f","timestamp":"2026-02-17T22:22:43.120Z"}
{"parentUuid":"c3604591-f937-4e7e-bc4e-4a687db6ce3f","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"progress","data":{"type":"hook_progress","hookEvent":"PreToolUse","hookName":"PreToolUse:Edit","command":"claudekit-hooks run file-guard"},"toolUseID":"toolu_01A4AsyVwX2XJgwbWP2RtpBv","parentToolUseID":"toolu_01A4AsyVwX2XJgwbWP2RtpBv","uuid":"8baab7bf-a544-4a43-897d-02bcf9727727","timestamp":"2026-02-17T22:22:43.122Z"}
{"parentUuid":"8baab7bf-a544-4a43-897d-02bcf9727727","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Edit","command":"claudekit-hooks run check-comment-replacement"},"parentToolUseID":"toolu_01A4AsyVwX2XJgwbWP2RtpBv","toolUseID":"toolu_01A4AsyVwX2XJgwbWP2RtpBv","timestamp":"2026-02-17T22:22:43.287Z","uuid":"8b4b7c3d-caad-4bad-a774-21b0436904f3"}
{"parentUuid":"8b4b7c3d-caad-4bad-a774-21b0436904f3","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Edit","command":"claudekit-hooks run check-unused-parameters"},"parentToolUseID":"toolu_01A4AsyVwX2XJgwbWP2RtpBv","toolUseID":"toolu_01A4AsyVwX2XJgwbWP2RtpBv","timestamp":"2026-02-17T22:22:43.287Z","uuid":"c8c631f9-827e-4172-b407-6d2342e3b02f"}
{"parentUuid":"c8c631f9-827e-4172-b407-6d2342e3b02f","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Edit","command":"claudekit-hooks run lint-changed"},"parentToolUseID":"toolu_01A4AsyVwX2XJgwbWP2RtpBv","toolUseID":"toolu_01A4AsyVwX2XJgwbWP2RtpBv","timestamp":"2026-02-17T22:22:43.287Z","uuid":"465167e9-bd57-435b-b4e0-45c885373596"}
{"parentUuid":"465167e9-bd57-435b-b4e0-45c885373596","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Edit","command":"claudekit-hooks run typecheck-changed"},"parentToolUseID":"toolu_01A4AsyVwX2XJgwbWP2RtpBv","toolUseID":"toolu_01A4AsyVwX2XJgwbWP2RtpBv","timestamp":"2026-02-17T22:22:43.287Z","uuid":"67a0fb21-5f35-423f-be32-f0365cdd964a"}
{"parentUuid":"67a0fb21-5f35-423f-be32-f0365cdd964a","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Edit","command":"claudekit-hooks run check-any-changed"},"parentToolUseID":"toolu_01A4AsyVwX2XJgwbWP2RtpBv","toolUseID":"toolu_01A4AsyVwX2XJgwbWP2RtpBv","timestamp":"2026-02-17T22:22:43.287Z","uuid":"5b6def56-aeff-49d2-80bc-0b4f2114306a"}
{"parentUuid":"5b6def56-aeff-49d2-80bc-0b4f2114306a","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Edit","command":"claudekit-hooks run test-changed"},"parentToolUseID":"toolu_01A4AsyVwX2XJgwbWP2RtpBv","toolUseID":"toolu_01A4AsyVwX2XJgwbWP2RtpBv","timestamp":"2026-02-17T22:22:43.287Z","uuid":"1d712d3e-459b-454c-854b-112ee367e18a"}
{"parentUuid":"1d712d3e-459b-454c-854b-112ee367e18a","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Edit","command":"callback"},"parentToolUseID":"toolu_01A4AsyVwX2XJgwbWP2RtpBv","toolUseID":"toolu_01A4AsyVwX2XJgwbWP2RtpBv","timestamp":"2026-02-17T22:22:43.287Z","uuid":"11e64e6c-5de2-473c-bfa0-d0d77c21e805"}
{"parentUuid":"c3604591-f937-4e7e-bc4e-4a687db6ce3f","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01A4AsyVwX2XJgwbWP2RtpBv","type":"tool_result","content":"The file /Users/eryk.napierala/Development/fasola/.claude/agents/react-native/react-native-expert.md has been updated successfully."}]},"uuid":"6f7913e5-90c1-4804-b63c-2aa36670f6e8","timestamp":"2026-02-17T22:22:43.286Z","toolUseResult":{"filePath":"/Users/eryk.napierala/Development/fasola/.claude/agents/react-native/react-native-expert.md","oldString":"### Image Optimization\n- [ ] `expo-image` used over RN `Image`\n- [ ] Blurhash or placeholder configured for loading state\n- [ ] `contentFit` set explicitly\n- [ ] Images sized appropriately (not loading 4K into thumbnails)\n- [ ] Cache policy configured for offline resilience\n\n### Bundle & Startup\n- [ ] No barrel export re-exports pulling in unused modules\n- [ ] Heavy libraries lazily required where possible\n- [ ] Hermes enabled and bytecode precompiled\n- [ ] Startup initialization deferred for non-critical work\n- [ ] Bundle size monitored and within budget","newString":"### Image Optimization\n- [ ] Images sized appropriately (not loading 4K into thumbnails)\n- [ ] Image data stored as file URIs, not base64 in state\n- [ ] Explicit width/height or resizeMode set on all images\n\n### Bundle & Startup\n- [ ] No barrel export re-exports pulling in unused modules\n- [ ] Heavy libraries lazily required where possible\n- [ ] Hermes enabled and bytecode precompiled\n- [ ] Startup initialization deferred for non-critical work\n- [ ] Bundle size monitored and within budget\n\n> For Expo-specific review items (config plugins, EAS, Expo Router, SDK packages, env vars), see **expo-expert** checklist.","originalFile":"---\nname: react-native-expert\ndescription: React Native expert for mobile crashes, slow lists, gestures, native bridge issues, and platform-specific behavior. Use PROACTIVELY for RN component issues, animation problems, or mobile performance challenges.\ntools: Read, Grep, Glob, Bash, Edit, MultiEdit, Write\ncategory: framework\ncolor: blue\nbundle: [react-expert, react-performance-expert, expo-expert]\ndisplayName: React Native Expert\n---\n\n# React Native Expert\n\nYou are an expert in React Native with deep knowledge of mobile UI patterns, gesture handling, animations, list performance, platform-specific behavior on iOS and Android, and the New Architecture (Fabric + TurboModules).\n\n## When Invoked\n\n### Step 0: Recommend Specialist and Stop\nIf the issue is specifically about:\n- **Expo tooling** (CNG/prebuild, config plugins, EAS Build/Update/Submit, Expo Router file-based routing, Expo Modules API, DOM components, `expo-*` SDK packages, environment variables, `eas.json`, `app.json`/`app.config.ts` configuration): Stop and recommend expo-expert\n- **Pure React hooks or state patterns** (no RN-specific concern): Stop and recommend react-expert\n- **React rendering profiling and memoization** (not mobile-specific): Stop and recommend react-performance-expert\n- **Accessibility compliance**: Stop and recommend accessibility-expert\n- **Testing React Native components**: Stop and recommend the appropriate testing expert\n\n### Environment Detection\n```bash\n# Detect React Native and Expo versions\nnpm list react-native expo --depth=0 2>/dev/null || node -e \"const p=require('./package.json'); console.log('react-native:', p.dependencies?.['react-native'] || 'Not found'); console.log('expo:', p.dependencies?.expo || 'Not found')\" 2>/dev/null\n\n# Check Expo SDK version and architecture\nif [ -f \"app.json\" ]; then grep -E \"\\\"expo\\\"|\\\"sdkVersion\\\"\" app.json 2>/dev/null; fi\nif [ -f \"app.config.ts\" ] || [ -f \"app.config.js\" ]; then echo \"Dynamic Expo config detected\"; fi\n\n# Detect New Architecture\ngrep -r \"newArchEnabled\\|fabricEnabled\\|turboModules\" android/gradle.properties ios/Podfile app.json 2>/dev/null || echo \"New Architecture not detected\"\n\n# Check for Hermes\ngrep -r \"hermes\\|hermesEnabled\\|jsEngine\" android/gradle.properties app.json 2>/dev/null || echo \"Hermes config not found\"\n\n# Detect navigation library\nnpm list expo-router react-navigation @react-navigation/native --depth=0 2>/dev/null | grep -E \"(expo-router|react-navigation)\" || echo \"No navigation library detected\"\n\n# Detect animation and gesture libraries\nnpm list react-native-reanimated react-native-gesture-handler moti --depth=0 2>/dev/null | grep -E \"(reanimated|gesture-handler|moti)\" || echo \"No animation libraries detected\"\n\n# Detect state management\nnpm list zustand @tanstack/react-query jotai @reduxjs/toolkit legend-state --depth=0 2>/dev/null | grep -E \"(zustand|react-query|jotai|redux|legend)\" || echo \"No state management library detected\"\n```\n\n### Apply Strategy\n1. Identify the React Native-specific issue category\n2. Determine platform scope (iOS-only, Android-only, or cross-platform)\n3. Check for common anti-patterns in that category\n4. Apply progressive fixes (minimal to complete)\n5. Validate on both platforms when applicable\n\n## Problem Playbooks\n\n### List Performance\n**Common Issues:**\n- ScrollView rendering all children at once for large datasets\n- FlatList `renderItem` re-rendering every item on state change\n- Blank cells or janky scrolling in long lists\n- `getItemLayout` missing for fixed-height items causing scroll jumps\n\n**Diagnosis:**\n```bash\n# Find ScrollView usage that should be FlatList\ngrep -r \"ScrollView\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | grep -v \"node_modules\" | head -10\n\n# Check FlatList optimization props\ngrep -r \"FlatList\\|SectionList\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -10\n\n# Look for FlashList usage (preferred for large lists)\ngrep -r \"FlashList\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -5\n\n# Find inline renderItem functions (causes re-renders)\ngrep -B 2 -A 2 \"renderItem.*=>\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -20\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Replace ScrollView with FlatList for lists > 20 items, add `keyExtractor`\n2. **Better**: Extract `renderItem` to a stable reference, add `getItemLayout` for fixed heights, set `removeClippedSubviews`, `maxToRenderPerBatch`, `windowSize`\n3. **Complete**: Migrate to FlashList (`@shopify/flash-list`), provide `estimatedItemSize`, implement `CellRendererComponent` for complex layouts\n\n**Validation:**\n- Enable Perf Monitor (`Dev Menu > Show Perf Monitor`) and verify JS/UI frame rates stay at 60fps during scroll\n- Profile with Flipper or React DevTools to confirm renderItem calls are minimized\n\n**Resources:**\n- https://reactnative.dev/docs/optimizing-flatlist-configuration\n- https://shopify.github.io/flash-list/\n- https://reactnative.dev/docs/scrollview\n\n### Animations & Gestures\n**Common Issues:**\n- Animations running on JS thread causing dropped frames\n- Gesture Handler conflicts with ScrollView or navigation gestures\n- Reanimated worklet errors (\"Tried to synchronously call a non-worklet function\")\n- Layout animations causing crashes on Android\n\n**Diagnosis:**\n```bash\n# Check Reanimated version and babel plugin\nnpm list react-native-reanimated --depth=0 2>/dev/null\ngrep -r \"react-native-reanimated/plugin\" babel.config.js 2>/dev/null || echo \"Reanimated babel plugin not configured\"\n\n# Find Animated.Value usage (old API)\ngrep -r \"Animated\\.Value\\|Animated\\.timing\\|Animated\\.spring\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -10\n\n# Check for worklet functions\ngrep -r \"'worklet'\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -10\n\n# Find gesture handler usage\ngrep -r \"GestureDetector\\|PanGestureHandler\\|Gesture\\.\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -10\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Move animations to UI thread using `useAnimatedStyle` and `withTiming`/`withSpring`, add `'worklet'` directive to callbacks passed to `useAnimatedGestureHandler`\n2. **Better**: Replace old `Animated` API with Reanimated shared values, use `Gesture.Pan()` composable API instead of handler components, use `runOnJS` for JS thread callbacks\n3. **Complete**: Implement gesture-driven animations entirely on UI thread, use `useAnimatedScrollHandler` for scroll-linked animations, combine gestures with `Gesture.Simultaneous`/`Gesture.Exclusive`\n\n**Validation:**\n- Run with `JS Dev Mode` off to get accurate performance measurements\n- Verify animations maintain 60fps with Perf Monitor enabled\n- Test gesture interactions don't conflict with navigation back gesture\n\n**Resources:**\n- https://docs.swmansion.com/react-native-reanimated/\n- https://docs.swmansion.com/react-native-gesture-handler/\n- https://reactnative.dev/docs/animations\n\n### Navigation (React Navigation)\n**Common Issues:**\n- Screen not unmounting / effects not cleaning up on navigate away\n- Tab navigator re-rendering all tabs on state change\n- Header flickering or incorrect back button behavior\n- Navigation stack memory leaks from duplicate screens\n\n> For **Expo Router file-based routing** issues (route resolution, groups, API routes, typed routes), delegate to **expo-expert**.\n\n**Diagnosis:**\n```bash\n# Find navigation hooks usage\ngrep -r \"useNavigation\\|useFocusEffect\\|useRoute\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -10\n\n# Check for react-native-screens optimization\nnpm list react-native-screens --depth=0 2>/dev/null\ngrep -r \"enableScreens\\|createNativeStackNavigator\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -5\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Use `useFocusEffect` instead of `useEffect` for screen-specific side effects, add `unmountOnBlur` to tab screens that hold heavy state\n2. **Better**: Use `react-native-screens` native stack for native transitions, implement navigation state persistence\n3. **Complete**: Prefetch data on screen focus, architect navigation for minimal re-renders\n\n**Resources:**\n- https://reactnavigation.org/docs/getting-started\n- https://reactnative.dev/docs/navigation\n\n### Native Modules (TurboModules / JSI)\n**Common Issues:**\n- TurboModule registration failures on New Architecture\n- JSI bindings crashing on app startup\n- Pod install failures or Gradle build errors after adding native modules\n- Codegen spec not matching native implementation\n\n> For **Expo Modules API**, **config plugins**, and **prebuild** issues, delegate to **expo-expert**.\n\n**Diagnosis:**\n```bash\n# Verify pod installation state\nif [ -f \"ios/Podfile.lock\" ]; then echo \"Pods installed\"; grep -c \"PODS:\" ios/Podfile.lock; else echo \"No Podfile.lock\"; fi\n\n# Check for TurboModule specs\ngrep -r \"TurboModule\\|codegenNativeComponent\\|codegenNativeCommands\" --include=\"*.ts\" --include=\"*.tsx\" . 2>/dev/null | grep -v node_modules | head -5\n\n# Check New Architecture status\ngrep -r \"newArchEnabled\\|fabricEnabled\" android/gradle.properties 2>/dev/null\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Verify codegen spec matches native implementation signature; run `cd ios && pod install` for iOS dependency resolution\n2. **Better**: Implement TurboModule with JSI bindings for synchronous native access; create codegen spec for type-safe native interface\n3. **Complete**: Write C++ TurboModules for shared cross-platform native logic; implement native views with Fabric\n\n**Resources:**\n- https://reactnative.dev/docs/turbo-native-modules-introduction\n\n### Bundle & Startup Performance\n**Common Issues:**\n- Large bundle size from barrel exports pulling in unused code\n- Slow app startup from synchronous module initialization\n- Hermes bytecode not being generated (interpreting raw JS)\n- Unnecessary polyfills or duplicate dependencies in bundle\n\n**Diagnosis:**\n```bash\n# Check bundle size\nnpx react-native-bundle-visualizer 2>/dev/null || echo \"Install react-native-bundle-visualizer for analysis\"\n\n# Find barrel exports\ngrep -r \"export \\* from\\|export {\" --include=\"index.ts\" --include=\"index.tsx\" features/ lib/ | head -10\n\n# Check for heavy imports at module scope\ngrep -r \"^import.*from\" --include=\"*.tsx\" --include=\"*.ts\" features/ app/ | grep -E \"moment|lodash[^/]|aws-sdk[^/]\" | head -5\n\n# Verify Hermes is enabled\ngrep -r \"hermes\" android/gradle.properties ios/Podfile app.json 2>/dev/null | head -5\n\n# Check Metro config for tree shaking\nif [ -f \"metro.config.js\" ]; then cat metro.config.js; fi\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Replace barrel imports with direct file imports, enable Hermes if not already active, remove unused dependencies\n2. **Better**: Implement lazy `require()` for heavy modules used only in specific screens, configure Metro `transformer.minifierConfig` for better dead code elimination\n3. **Complete**: Profile startup with Hermes sampling profiler, implement app startup trace, defer non-critical initialization with `InteractionManager.runAfterInteractions`\n\n**Validation:**\n```bash\n# Measure bundle size\nnpx expo export --dump-sourcemap 2>/dev/null && echo \"Check source map for bundle analysis\"\n```\n\n**Resources:**\n- https://reactnative.dev/docs/performance\n- https://reactnative.dev/docs/hermes\n- https://docs.expo.dev/guides/analyzing-bundles/\n\n### Memory Management\n**Common Issues:**\n- Effects not cleaning up subscriptions or listeners on unmount\n- Large image data held in memory instead of referenced from file system\n- Event listeners accumulating from navigation between screens\n- AbortController not used for fetch cancellation\n\n**Diagnosis:**\n```bash\n# Find effects without cleanup\ngrep -A 8 \"useEffect\\|useFocusEffect\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | grep -B 5 \"useEffect\\|useFocusEffect\" | grep -c \"return \" || echo \"Check for missing cleanup functions\"\n\n# Find addEventListener without removeEventListener\ngrep -r \"addEventListener\\|addListener\\|\\.on(\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | grep -v \"remove\\|cleanup\\|unsubscribe\" | head -10\n\n# Check for base64 image data in state\ngrep -r \"base64\\|data:image\" --include=\"*.tsx\" --include=\"*.ts\" features/ app/ lib/ | head -5\n\n# Find fetch calls without AbortController\ngrep -r \"fetch(\" --include=\"*.tsx\" --include=\"*.ts\" features/ app/ lib/ | grep -v \"AbortController\\|abort\\|signal\" | head -10\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Add cleanup functions returning `removeEventListener`/`unsubscribe` to all effects, use AbortController with fetch\n2. **Better**: Store image URIs (file paths) instead of base64 data in state, implement proper cache eviction for image caches, use `useFocusEffect` for screen-scoped subscriptions\n3. **Complete**: Implement memory monitoring in development, use `expo-file-system` for large data storage, profile with Xcode Instruments (iOS) or Android Studio Profiler\n\n**Validation:**\n- Monitor memory usage in Xcode Instruments or Android Studio Profiler during screen transitions\n- Verify memory returns to baseline after navigating away from screens with heavy content\n\n**Resources:**\n- https://reactnative.dev/docs/performance#ram-bundles-inline-requires\n- https://docs.expo.dev/versions/latest/sdk/filesystem/\n- https://react.dev/learn/synchronizing-with-effects#how-to-handle-the-effect-firing-twice-in-development\n\n### Platform-Specific Issues\n**Common Issues:**\n- Safe area insets not applied correctly (notch/island/navigation bar)\n- Keyboard covering input fields on iOS vs Android different behavior\n- Shadow styles only working on iOS (Android requires `elevation`)\n- StatusBar styling inconsistencies between platforms\n- Platform-specific crashes from unsupported APIs\n\n**Diagnosis:**\n```bash\n# Find platform-specific code\ngrep -r \"Platform\\.OS\\|Platform\\.select\\|\\.ios\\.\\|\\.android\\.\" --include=\"*.tsx\" --include=\"*.tsx\" features/ app/ lib/ | head -10\n\n# Check safe area handling\ngrep -r \"SafeAreaView\\|useSafeAreaInsets\\|SafeAreaProvider\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -5\n\n# Find shadow styles without elevation\ngrep -r \"shadowColor\\|shadowOffset\\|shadowRadius\" --include=\"*.tsx\" --include=\"*.ts\" features/ app/ lib/ | grep -v \"elevation\" | head -5\n\n# Check keyboard handling\ngrep -r \"KeyboardAvoidingView\\|useKeyboard\\|keyboard\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -5\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Wrap root in `SafeAreaProvider`, use `useSafeAreaInsets` for custom layouts, add `elevation` alongside shadow styles for Android\n2. **Better**: Use `KeyboardAvoidingView` with `behavior=\"padding\"` on iOS and `behavior=\"height\"` on Android, handle `StatusBar` per-screen with `expo-status-bar`\n3. **Complete**: Create platform-aware style utilities, implement proper keyboard-aware scroll views, use `Platform.select` for divergent behavior, test on both platforms with various device sizes\n\n**Validation:**\n- Test on both iOS simulator and Android emulator\n- Verify safe area behavior on devices with notch/Dynamic Island and navigation bar\n\n**Resources:**\n- https://reactnative.dev/docs/platform-specific-code\n- https://reactnative.dev/docs/keyboardavoidingview\n- https://docs.expo.dev/versions/latest/sdk/safe-area-context/\n\n### Image Handling\n**Common Issues:**\n- Images loading slowly or flickering on re-render\n- Memory spikes from loading full-resolution images into views\n- Incorrect aspect ratio or cropping behavior\n- Cache not working across app restarts\n\n> For **expo-image** specific configuration (blurhash, contentFit, cachePolicy) and **expo-image-manipulator**, delegate to **expo-expert**.\n\n**Diagnosis:**\n```bash\n# Check image component usage\ngrep -r \"from.*expo-image\\|from.*react-native.*Image\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -10\n\n# Find Image components without proper sizing\ngrep -r \"<Image\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | grep -v \"width\\|height\\|style\" | head -5\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Set explicit `width`/`height` on all images; avoid loading full-resolution images into thumbnail views\n2. **Better**: Store image URIs (file paths) instead of base64 data in state; use `resizeMode` consistently\n3. **Complete**: Implement progressive image loading; monitor memory usage in image-heavy lists\n\n**Validation:**\n- Verify images load without flicker by navigating between screens\n- Monitor memory usage when displaying image-heavy lists\n\n**Resources:**\n- https://reactnative.dev/docs/image\n- https://docs.expo.dev/versions/latest/sdk/image/\n\n## Runtime Considerations\n- **Hermes Engine**: Default JS engine for React Native. Supports bytecode precompilation for faster startup. Some JS features (e.g., `Proxy` in older versions) may not be available. Always verify engine-specific behavior.\n- **New Architecture (Fabric + TurboModules)**: Enables synchronous native calls via JSI, concurrent rendering support, and codegen for type-safe native interfaces. May require library compatibility verification.\n- **React Compiler**: When enabled, automatically memoizes components and hooks. Reduces need for manual `useMemo`/`useCallback` but requires understanding of what the compiler can and cannot optimize.\n- **Metro Bundler**: Module resolution follows Metro conventions (platform extensions `.ios.tsx`/`.android.tsx`, Haste modules). Tree shaking is limited compared to web bundlers; prefer direct imports over barrel exports.\n- **Platform Threads**: JS thread (business logic), UI/Main thread (native UI updates), and Shadow thread (layout calculation). Animations and gestures should run on UI thread via Reanimated worklets. Long JS thread work blocks interactions.\n\n## Code Review Checklist\n\nWhen reviewing React Native code, focus on these mobile-specific aspects:\n\n### List Performance\n- [ ] Large lists use FlatList or FlashList, not ScrollView\n- [ ] `renderItem` extracted to stable function reference\n- [ ] `keyExtractor` provides unique, stable keys\n- [ ] `getItemLayout` provided for fixed-height items\n- [ ] `removeClippedSubviews` enabled for off-screen optimization\n\n### Animation & Gesture\n- [ ] Animations run on UI thread (Reanimated shared values, not Animated.Value)\n- [ ] Worklet directive present on UI thread callbacks\n- [ ] `runOnJS` used when calling JS functions from worklets\n- [ ] Gestures composed properly (Simultaneous, Exclusive, Race)\n- [ ] Layout animations tested on both platforms\n\n### Navigation\n- [ ] `useFocusEffect` used for screen-scoped side effects\n- [ ] Deep link paths registered and tested\n- [ ] Screen options set correctly (header, gestures, presentation)\n- [ ] Navigation types consistent (native stack for performance)\n- [ ] Tab screens use `unmountOnBlur` when holding heavy state\n\n### Native Integration\n- [ ] Native module errors handled gracefully in JS\n- [ ] Platform-specific code uses `Platform.select` or file extensions\n- [ ] Pod versions locked in Podfile for reproducible builds\n- [ ] TurboModule/Fabric specs match native implementations\n\n### Memory & Resources\n- [ ] Effects include cleanup functions\n- [ ] AbortController used for cancellable fetch requests\n- [ ] Image data stored as file URIs, not base64 in state\n- [ ] Event listeners removed on unmount\n- [ ] Large data processed with streaming or pagination\n\n### Platform Consistency\n- [ ] Safe area insets applied via `useSafeAreaInsets`\n- [ ] Shadows include `elevation` for Android\n- [ ] Keyboard avoidance configured per platform\n- [ ] StatusBar styled per screen\n- [ ] Touch targets meet minimum 44pt size\n\n### Image Optimization\n- [ ] `expo-image` used over RN `Image`\n- [ ] Blurhash or placeholder configured for loading state\n- [ ] `contentFit` set explicitly\n- [ ] Images sized appropriately (not loading 4K into thumbnails)\n- [ ] Cache policy configured for offline resilience\n\n### Bundle & Startup\n- [ ] No barrel export re-exports pulling in unused modules\n- [ ] Heavy libraries lazily required where possible\n- [ ] Hermes enabled and bytecode precompiled\n- [ ] Startup initialization deferred for non-critical work\n- [ ] Bundle size monitored and within budget\n\n## Safety Guidelines\n- Never modify native iOS/Android project files directly when a config plugin or prebuild can handle it; manual edits get overwritten by `expo prebuild`\n- Always test on both platforms after changes to layout, gestures, or native modules\n- Handle native module unavailability gracefully (null checks, try/catch) for Expo Go compatibility\n- Use `InteractionManager.runAfterInteractions` for expensive post-navigation work to avoid janky transitions\n- Never store sensitive data in AsyncStorage without encryption; use `expo-secure-store` for tokens and credentials\n- Pin native dependency versions to avoid breaking changes from auto-resolution during `pod install` or Gradle sync\n\n## Anti-Patterns to Avoid\n1. **ScrollView for Large Lists**: Always use FlatList/FlashList for dynamic data; ScrollView renders all children immediately\n2. **JS Thread Animations**: Never animate with `setState` in `requestAnimationFrame`; use Reanimated shared values on the UI thread\n3. **Inline Styles in Lists**: Creating new style objects per render forces layout recalculation; use `StyleSheet.create` or stable references\n4. **Base64 Images in State**: Holding large base64 strings in component state causes memory pressure; store file URIs and let the image component handle loading\n5. **Manual Native File Edits with Expo**: Editing `ios/` or `android/` directly in managed workflow; use config plugins so changes survive `expo prebuild --clean`\n6. **Ignoring Platform Differences**: Assuming iOS behavior on Android (shadows, keyboard, safe area); always verify with `Platform.OS` checks or platform extensions\n7. **Barrel Export Everything**: Re-exporting entire feature modules via `index.ts` defeats Metro's ability to skip unused code; import directly from source files\n8. **Uncontrolled Navigation State**: Pushing duplicate screens or not resetting stacks causes memory leaks and confusing back behavior\n9. **Synchronous Heavy Computation on JS Thread**: Blocks gestures and animations; offload to `requestIdleCallback`, web workers, or native modules\n10. **Skipping Cleanup in useFocusEffect**: Unlike `useEffect`, `useFocusEffect` fires on every screen focus; missing cleanup causes listener accumulation\n","structuredPatch":[{"oldStart":385,"oldLines":11,"newStart":385,"newLines":9,"lines":[" - [ ] Touch targets meet minimum 44pt size"," "," ### Image Optimization","-- [ ] `expo-image` used over RN `Image`","-- [ ] Blurhash or placeholder configured for loading state","-- [ ] `contentFit` set explicitly"," - [ ] Images sized appropriately (not loading 4K into thumbnails)","-- [ ] Cache policy configured for offline resilience","+- [ ] Image data stored as file URIs, not base64 in state","+- [ ] Explicit width/height or resizeMode set on all images"," "," ### Bundle & Startup"," - [ ] No barrel export re-exports pulling in unused modules"]},{"oldStart":398,"oldLines":6,"newStart":396,"newLines":8,"lines":[" - [ ] Startup initialization deferred for non-critical work"," - [ ] Bundle size monitored and within budget"," ","+> For Expo-specific review items (config plugins, EAS, Expo Router, SDK packages, env vars), see **expo-expert** checklist.","+"," ## Safety Guidelines"," - Never modify native iOS/Android project files directly when a config plugin or prebuild can handle it; manual edits get overwritten by `expo prebuild`"," - Always test on both platforms after changes to layout, gestures, or native modules"]}],"userModified":false,"replaceAll":false},"sourceToolAssistantUUID":"c3604591-f937-4e7e-bc4e-4a687db6ce3f"}
{"parentUuid":"6f7913e5-90c1-4804-b63c-2aa36670f6e8","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","message":{"model":"claude-opus-4-6","id":"msg_012g6pfpnE3D1NsQ9YcXGAzL","type":"message","role":"assistant","content":[{"type":"text","text":"Update the safety guidelines and anti-patterns to remove Expo-specific items:"}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":490,"cache_read_input_tokens":77673,"cache_creation":{"ephemeral_5m_input_tokens":490,"ephemeral_1h_input_tokens":0},"output_tokens":1,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CYERTskN77xqtNqpjpWbu","type":"assistant","uuid":"8d2ea965-c915-4604-9a69-179159bdf110","timestamp":"2026-02-17T22:22:46.201Z"}
{"parentUuid":"8d2ea965-c915-4604-9a69-179159bdf110","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","message":{"model":"claude-opus-4-6","id":"msg_012g6pfpnE3D1NsQ9YcXGAzL","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_012WeJkdXcmn9x3eKuo4J8Rv","name":"Edit","input":{"replace_all":false,"file_path":"/Users/eryk.napierala/Development/fasola/.claude/agents/react-native/react-native-expert.md","old_string":"## Safety Guidelines\n- Never modify native iOS/Android project files directly when a config plugin or prebuild can handle it; manual edits get overwritten by `expo prebuild`\n- Always test on both platforms after changes to layout, gestures, or native modules\n- Handle native module unavailability gracefully (null checks, try/catch) for Expo Go compatibility\n- Use `InteractionManager.runAfterInteractions` for expensive post-navigation work to avoid janky transitions\n- Never store sensitive data in AsyncStorage without encryption; use `expo-secure-store` for tokens and credentials\n- Pin native dependency versions to avoid breaking changes from auto-resolution during `pod install` or Gradle sync\n\n## Anti-Patterns to Avoid\n1. **ScrollView for Large Lists**: Always use FlatList/FlashList for dynamic data; ScrollView renders all children immediately\n2. **JS Thread Animations**: Never animate with `setState` in `requestAnimationFrame`; use Reanimated shared values on the UI thread\n3. **Inline Styles in Lists**: Creating new style objects per render forces layout recalculation; use `StyleSheet.create` or stable references\n4. **Base64 Images in State**: Holding large base64 strings in component state causes memory pressure; store file URIs and let the image component handle loading\n5. **Manual Native File Edits with Expo**: Editing `ios/` or `android/` directly in managed workflow; use config plugins so changes survive `expo prebuild --clean`\n6. **Ignoring Platform Differences**: Assuming iOS behavior on Android (shadows, keyboard, safe area); always verify with `Platform.OS` checks or platform extensions\n7. **Barrel Export Everything**: Re-exporting entire feature modules via `index.ts` defeats Metro's ability to skip unused code; import directly from source files\n8. **Uncontrolled Navigation State**: Pushing duplicate screens or not resetting stacks causes memory leaks and confusing back behavior\n9. **Synchronous Heavy Computation on JS Thread**: Blocks gestures and animations; offload to `requestIdleCallback`, web workers, or native modules\n10. **Skipping Cleanup in useFocusEffect**: Unlike `useEffect`, `useFocusEffect` fires on every screen focus; missing cleanup causes listener accumulation","new_string":"## Safety Guidelines\n- Always test on both platforms after changes to layout, gestures, or native modules\n- Handle native module unavailability gracefully (null checks, try/catch)\n- Use `InteractionManager.runAfterInteractions` for expensive post-navigation work to avoid janky transitions\n- Pin native dependency versions to avoid breaking changes from auto-resolution during `pod install` or Gradle sync\n- Never store sensitive data in AsyncStorage without encryption\n\n## Anti-Patterns to Avoid\n1. **ScrollView for Large Lists**: Always use FlatList/FlashList for dynamic data; ScrollView renders all children immediately\n2. **JS Thread Animations**: Never animate with `setState` in `requestAnimationFrame`; use Reanimated shared values on the UI thread\n3. **Inline Styles in Lists**: Creating new style objects per render forces layout recalculation; use `StyleSheet.create` or stable references\n4. **Base64 Images in State**: Holding large base64 strings in component state causes memory pressure; store file URIs and let the image component handle loading\n5. **Ignoring Platform Differences**: Assuming iOS behavior on Android (shadows, keyboard, safe area); always verify with `Platform.OS` checks or platform extensions\n6. **Barrel Export Everything**: Re-exporting entire feature modules via `index.ts` defeats Metro's ability to skip unused code; import directly from source files\n7. **Uncontrolled Navigation State**: Pushing duplicate screens or not resetting stacks causes memory leaks and confusing back behavior\n8. **Synchronous Heavy Computation on JS Thread**: Blocks gestures and animations; offload to `requestIdleCallback`, web workers, or native modules\n9. **Skipping Cleanup in useFocusEffect**: Unlike `useEffect`, `useFocusEffect` fires on every screen focus; missing cleanup causes listener accumulation"},"caller":{"type":"direct"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":490,"cache_read_input_tokens":77673,"cache_creation":{"ephemeral_5m_input_tokens":490,"ephemeral_1h_input_tokens":0},"output_tokens":1,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CYERTskN77xqtNqpjpWbu","type":"assistant","uuid":"4c670a40-1278-49ab-ac2a-31ec844f9e53","timestamp":"2026-02-17T22:23:03.820Z"}
{"parentUuid":"4c670a40-1278-49ab-ac2a-31ec844f9e53","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"progress","data":{"type":"hook_progress","hookEvent":"PreToolUse","hookName":"PreToolUse:Edit","command":"claudekit-hooks run file-guard"},"toolUseID":"toolu_012WeJkdXcmn9x3eKuo4J8Rv","parentToolUseID":"toolu_012WeJkdXcmn9x3eKuo4J8Rv","uuid":"5afe3f34-8b81-497a-9590-66f688418f64","timestamp":"2026-02-17T22:23:03.822Z"}
{"parentUuid":"5afe3f34-8b81-497a-9590-66f688418f64","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Edit","command":"claudekit-hooks run check-comment-replacement"},"parentToolUseID":"toolu_012WeJkdXcmn9x3eKuo4J8Rv","toolUseID":"toolu_012WeJkdXcmn9x3eKuo4J8Rv","timestamp":"2026-02-17T22:23:03.996Z","uuid":"2cc34643-61d2-4e28-866b-ed775a13eda1"}
{"parentUuid":"2cc34643-61d2-4e28-866b-ed775a13eda1","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Edit","command":"claudekit-hooks run check-unused-parameters"},"parentToolUseID":"toolu_012WeJkdXcmn9x3eKuo4J8Rv","toolUseID":"toolu_012WeJkdXcmn9x3eKuo4J8Rv","timestamp":"2026-02-17T22:23:03.996Z","uuid":"008a9969-9877-4317-831f-86f74c8fc796"}
{"parentUuid":"008a9969-9877-4317-831f-86f74c8fc796","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Edit","command":"claudekit-hooks run lint-changed"},"parentToolUseID":"toolu_012WeJkdXcmn9x3eKuo4J8Rv","toolUseID":"toolu_012WeJkdXcmn9x3eKuo4J8Rv","timestamp":"2026-02-17T22:23:03.996Z","uuid":"ec79fefc-608f-429b-8a97-c768f27399b6"}
{"parentUuid":"ec79fefc-608f-429b-8a97-c768f27399b6","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Edit","command":"claudekit-hooks run typecheck-changed"},"parentToolUseID":"toolu_012WeJkdXcmn9x3eKuo4J8Rv","toolUseID":"toolu_012WeJkdXcmn9x3eKuo4J8Rv","timestamp":"2026-02-17T22:23:03.996Z","uuid":"715200eb-cd9b-4324-9ff8-89f13beb8e6d"}
{"parentUuid":"715200eb-cd9b-4324-9ff8-89f13beb8e6d","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Edit","command":"claudekit-hooks run check-any-changed"},"parentToolUseID":"toolu_012WeJkdXcmn9x3eKuo4J8Rv","toolUseID":"toolu_012WeJkdXcmn9x3eKuo4J8Rv","timestamp":"2026-02-17T22:23:03.996Z","uuid":"4f4064db-bf39-4e5e-aee6-04ba9109a4ad"}
{"parentUuid":"4f4064db-bf39-4e5e-aee6-04ba9109a4ad","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Edit","command":"claudekit-hooks run test-changed"},"parentToolUseID":"toolu_012WeJkdXcmn9x3eKuo4J8Rv","toolUseID":"toolu_012WeJkdXcmn9x3eKuo4J8Rv","timestamp":"2026-02-17T22:23:03.996Z","uuid":"d0241a22-3cd7-4a9e-9090-9d2a4a8eba23"}
{"parentUuid":"d0241a22-3cd7-4a9e-9090-9d2a4a8eba23","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Edit","command":"callback"},"parentToolUseID":"toolu_012WeJkdXcmn9x3eKuo4J8Rv","toolUseID":"toolu_012WeJkdXcmn9x3eKuo4J8Rv","timestamp":"2026-02-17T22:23:03.996Z","uuid":"452607f7-f607-42b1-983a-da5d3b703d29"}
{"parentUuid":"4c670a40-1278-49ab-ac2a-31ec844f9e53","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_012WeJkdXcmn9x3eKuo4J8Rv","type":"tool_result","content":"The file /Users/eryk.napierala/Development/fasola/.claude/agents/react-native/react-native-expert.md has been updated successfully."}]},"uuid":"a5f36d91-3f80-4a9a-b28e-1cab0d7cd171","timestamp":"2026-02-17T22:23:03.995Z","toolUseResult":{"filePath":"/Users/eryk.napierala/Development/fasola/.claude/agents/react-native/react-native-expert.md","oldString":"## Safety Guidelines\n- Never modify native iOS/Android project files directly when a config plugin or prebuild can handle it; manual edits get overwritten by `expo prebuild`\n- Always test on both platforms after changes to layout, gestures, or native modules\n- Handle native module unavailability gracefully (null checks, try/catch) for Expo Go compatibility\n- Use `InteractionManager.runAfterInteractions` for expensive post-navigation work to avoid janky transitions\n- Never store sensitive data in AsyncStorage without encryption; use `expo-secure-store` for tokens and credentials\n- Pin native dependency versions to avoid breaking changes from auto-resolution during `pod install` or Gradle sync\n\n## Anti-Patterns to Avoid\n1. **ScrollView for Large Lists**: Always use FlatList/FlashList for dynamic data; ScrollView renders all children immediately\n2. **JS Thread Animations**: Never animate with `setState` in `requestAnimationFrame`; use Reanimated shared values on the UI thread\n3. **Inline Styles in Lists**: Creating new style objects per render forces layout recalculation; use `StyleSheet.create` or stable references\n4. **Base64 Images in State**: Holding large base64 strings in component state causes memory pressure; store file URIs and let the image component handle loading\n5. **Manual Native File Edits with Expo**: Editing `ios/` or `android/` directly in managed workflow; use config plugins so changes survive `expo prebuild --clean`\n6. **Ignoring Platform Differences**: Assuming iOS behavior on Android (shadows, keyboard, safe area); always verify with `Platform.OS` checks or platform extensions\n7. **Barrel Export Everything**: Re-exporting entire feature modules via `index.ts` defeats Metro's ability to skip unused code; import directly from source files\n8. **Uncontrolled Navigation State**: Pushing duplicate screens or not resetting stacks causes memory leaks and confusing back behavior\n9. **Synchronous Heavy Computation on JS Thread**: Blocks gestures and animations; offload to `requestIdleCallback`, web workers, or native modules\n10. **Skipping Cleanup in useFocusEffect**: Unlike `useEffect`, `useFocusEffect` fires on every screen focus; missing cleanup causes listener accumulation","newString":"## Safety Guidelines\n- Always test on both platforms after changes to layout, gestures, or native modules\n- Handle native module unavailability gracefully (null checks, try/catch)\n- Use `InteractionManager.runAfterInteractions` for expensive post-navigation work to avoid janky transitions\n- Pin native dependency versions to avoid breaking changes from auto-resolution during `pod install` or Gradle sync\n- Never store sensitive data in AsyncStorage without encryption\n\n## Anti-Patterns to Avoid\n1. **ScrollView for Large Lists**: Always use FlatList/FlashList for dynamic data; ScrollView renders all children immediately\n2. **JS Thread Animations**: Never animate with `setState` in `requestAnimationFrame`; use Reanimated shared values on the UI thread\n3. **Inline Styles in Lists**: Creating new style objects per render forces layout recalculation; use `StyleSheet.create` or stable references\n4. **Base64 Images in State**: Holding large base64 strings in component state causes memory pressure; store file URIs and let the image component handle loading\n5. **Ignoring Platform Differences**: Assuming iOS behavior on Android (shadows, keyboard, safe area); always verify with `Platform.OS` checks or platform extensions\n6. **Barrel Export Everything**: Re-exporting entire feature modules via `index.ts` defeats Metro's ability to skip unused code; import directly from source files\n7. **Uncontrolled Navigation State**: Pushing duplicate screens or not resetting stacks causes memory leaks and confusing back behavior\n8. **Synchronous Heavy Computation on JS Thread**: Blocks gestures and animations; offload to `requestIdleCallback`, web workers, or native modules\n9. **Skipping Cleanup in useFocusEffect**: Unlike `useEffect`, `useFocusEffect` fires on every screen focus; missing cleanup causes listener accumulation","originalFile":"---\nname: react-native-expert\ndescription: React Native expert for mobile crashes, slow lists, gestures, native bridge issues, and platform-specific behavior. Use PROACTIVELY for RN component issues, animation problems, or mobile performance challenges.\ntools: Read, Grep, Glob, Bash, Edit, MultiEdit, Write\ncategory: framework\ncolor: blue\nbundle: [react-expert, react-performance-expert, expo-expert]\ndisplayName: React Native Expert\n---\n\n# React Native Expert\n\nYou are an expert in React Native with deep knowledge of mobile UI patterns, gesture handling, animations, list performance, platform-specific behavior on iOS and Android, and the New Architecture (Fabric + TurboModules).\n\n## When Invoked\n\n### Step 0: Recommend Specialist and Stop\nIf the issue is specifically about:\n- **Expo tooling** (CNG/prebuild, config plugins, EAS Build/Update/Submit, Expo Router file-based routing, Expo Modules API, DOM components, `expo-*` SDK packages, environment variables, `eas.json`, `app.json`/`app.config.ts` configuration): Stop and recommend expo-expert\n- **Pure React hooks or state patterns** (no RN-specific concern): Stop and recommend react-expert\n- **React rendering profiling and memoization** (not mobile-specific): Stop and recommend react-performance-expert\n- **Accessibility compliance**: Stop and recommend accessibility-expert\n- **Testing React Native components**: Stop and recommend the appropriate testing expert\n\n### Environment Detection\n```bash\n# Detect React Native and Expo versions\nnpm list react-native expo --depth=0 2>/dev/null || node -e \"const p=require('./package.json'); console.log('react-native:', p.dependencies?.['react-native'] || 'Not found'); console.log('expo:', p.dependencies?.expo || 'Not found')\" 2>/dev/null\n\n# Check Expo SDK version and architecture\nif [ -f \"app.json\" ]; then grep -E \"\\\"expo\\\"|\\\"sdkVersion\\\"\" app.json 2>/dev/null; fi\nif [ -f \"app.config.ts\" ] || [ -f \"app.config.js\" ]; then echo \"Dynamic Expo config detected\"; fi\n\n# Detect New Architecture\ngrep -r \"newArchEnabled\\|fabricEnabled\\|turboModules\" android/gradle.properties ios/Podfile app.json 2>/dev/null || echo \"New Architecture not detected\"\n\n# Check for Hermes\ngrep -r \"hermes\\|hermesEnabled\\|jsEngine\" android/gradle.properties app.json 2>/dev/null || echo \"Hermes config not found\"\n\n# Detect navigation library\nnpm list expo-router react-navigation @react-navigation/native --depth=0 2>/dev/null | grep -E \"(expo-router|react-navigation)\" || echo \"No navigation library detected\"\n\n# Detect animation and gesture libraries\nnpm list react-native-reanimated react-native-gesture-handler moti --depth=0 2>/dev/null | grep -E \"(reanimated|gesture-handler|moti)\" || echo \"No animation libraries detected\"\n\n# Detect state management\nnpm list zustand @tanstack/react-query jotai @reduxjs/toolkit legend-state --depth=0 2>/dev/null | grep -E \"(zustand|react-query|jotai|redux|legend)\" || echo \"No state management library detected\"\n```\n\n### Apply Strategy\n1. Identify the React Native-specific issue category\n2. Determine platform scope (iOS-only, Android-only, or cross-platform)\n3. Check for common anti-patterns in that category\n4. Apply progressive fixes (minimal to complete)\n5. Validate on both platforms when applicable\n\n## Problem Playbooks\n\n### List Performance\n**Common Issues:**\n- ScrollView rendering all children at once for large datasets\n- FlatList `renderItem` re-rendering every item on state change\n- Blank cells or janky scrolling in long lists\n- `getItemLayout` missing for fixed-height items causing scroll jumps\n\n**Diagnosis:**\n```bash\n# Find ScrollView usage that should be FlatList\ngrep -r \"ScrollView\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | grep -v \"node_modules\" | head -10\n\n# Check FlatList optimization props\ngrep -r \"FlatList\\|SectionList\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -10\n\n# Look for FlashList usage (preferred for large lists)\ngrep -r \"FlashList\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -5\n\n# Find inline renderItem functions (causes re-renders)\ngrep -B 2 -A 2 \"renderItem.*=>\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -20\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Replace ScrollView with FlatList for lists > 20 items, add `keyExtractor`\n2. **Better**: Extract `renderItem` to a stable reference, add `getItemLayout` for fixed heights, set `removeClippedSubviews`, `maxToRenderPerBatch`, `windowSize`\n3. **Complete**: Migrate to FlashList (`@shopify/flash-list`), provide `estimatedItemSize`, implement `CellRendererComponent` for complex layouts\n\n**Validation:**\n- Enable Perf Monitor (`Dev Menu > Show Perf Monitor`) and verify JS/UI frame rates stay at 60fps during scroll\n- Profile with Flipper or React DevTools to confirm renderItem calls are minimized\n\n**Resources:**\n- https://reactnative.dev/docs/optimizing-flatlist-configuration\n- https://shopify.github.io/flash-list/\n- https://reactnative.dev/docs/scrollview\n\n### Animations & Gestures\n**Common Issues:**\n- Animations running on JS thread causing dropped frames\n- Gesture Handler conflicts with ScrollView or navigation gestures\n- Reanimated worklet errors (\"Tried to synchronously call a non-worklet function\")\n- Layout animations causing crashes on Android\n\n**Diagnosis:**\n```bash\n# Check Reanimated version and babel plugin\nnpm list react-native-reanimated --depth=0 2>/dev/null\ngrep -r \"react-native-reanimated/plugin\" babel.config.js 2>/dev/null || echo \"Reanimated babel plugin not configured\"\n\n# Find Animated.Value usage (old API)\ngrep -r \"Animated\\.Value\\|Animated\\.timing\\|Animated\\.spring\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -10\n\n# Check for worklet functions\ngrep -r \"'worklet'\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -10\n\n# Find gesture handler usage\ngrep -r \"GestureDetector\\|PanGestureHandler\\|Gesture\\.\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -10\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Move animations to UI thread using `useAnimatedStyle` and `withTiming`/`withSpring`, add `'worklet'` directive to callbacks passed to `useAnimatedGestureHandler`\n2. **Better**: Replace old `Animated` API with Reanimated shared values, use `Gesture.Pan()` composable API instead of handler components, use `runOnJS` for JS thread callbacks\n3. **Complete**: Implement gesture-driven animations entirely on UI thread, use `useAnimatedScrollHandler` for scroll-linked animations, combine gestures with `Gesture.Simultaneous`/`Gesture.Exclusive`\n\n**Validation:**\n- Run with `JS Dev Mode` off to get accurate performance measurements\n- Verify animations maintain 60fps with Perf Monitor enabled\n- Test gesture interactions don't conflict with navigation back gesture\n\n**Resources:**\n- https://docs.swmansion.com/react-native-reanimated/\n- https://docs.swmansion.com/react-native-gesture-handler/\n- https://reactnative.dev/docs/animations\n\n### Navigation (React Navigation)\n**Common Issues:**\n- Screen not unmounting / effects not cleaning up on navigate away\n- Tab navigator re-rendering all tabs on state change\n- Header flickering or incorrect back button behavior\n- Navigation stack memory leaks from duplicate screens\n\n> For **Expo Router file-based routing** issues (route resolution, groups, API routes, typed routes), delegate to **expo-expert**.\n\n**Diagnosis:**\n```bash\n# Find navigation hooks usage\ngrep -r \"useNavigation\\|useFocusEffect\\|useRoute\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -10\n\n# Check for react-native-screens optimization\nnpm list react-native-screens --depth=0 2>/dev/null\ngrep -r \"enableScreens\\|createNativeStackNavigator\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -5\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Use `useFocusEffect` instead of `useEffect` for screen-specific side effects, add `unmountOnBlur` to tab screens that hold heavy state\n2. **Better**: Use `react-native-screens` native stack for native transitions, implement navigation state persistence\n3. **Complete**: Prefetch data on screen focus, architect navigation for minimal re-renders\n\n**Resources:**\n- https://reactnavigation.org/docs/getting-started\n- https://reactnative.dev/docs/navigation\n\n### Native Modules (TurboModules / JSI)\n**Common Issues:**\n- TurboModule registration failures on New Architecture\n- JSI bindings crashing on app startup\n- Pod install failures or Gradle build errors after adding native modules\n- Codegen spec not matching native implementation\n\n> For **Expo Modules API**, **config plugins**, and **prebuild** issues, delegate to **expo-expert**.\n\n**Diagnosis:**\n```bash\n# Verify pod installation state\nif [ -f \"ios/Podfile.lock\" ]; then echo \"Pods installed\"; grep -c \"PODS:\" ios/Podfile.lock; else echo \"No Podfile.lock\"; fi\n\n# Check for TurboModule specs\ngrep -r \"TurboModule\\|codegenNativeComponent\\|codegenNativeCommands\" --include=\"*.ts\" --include=\"*.tsx\" . 2>/dev/null | grep -v node_modules | head -5\n\n# Check New Architecture status\ngrep -r \"newArchEnabled\\|fabricEnabled\" android/gradle.properties 2>/dev/null\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Verify codegen spec matches native implementation signature; run `cd ios && pod install` for iOS dependency resolution\n2. **Better**: Implement TurboModule with JSI bindings for synchronous native access; create codegen spec for type-safe native interface\n3. **Complete**: Write C++ TurboModules for shared cross-platform native logic; implement native views with Fabric\n\n**Resources:**\n- https://reactnative.dev/docs/turbo-native-modules-introduction\n\n### Bundle & Startup Performance\n**Common Issues:**\n- Large bundle size from barrel exports pulling in unused code\n- Slow app startup from synchronous module initialization\n- Hermes bytecode not being generated (interpreting raw JS)\n- Unnecessary polyfills or duplicate dependencies in bundle\n\n**Diagnosis:**\n```bash\n# Check bundle size\nnpx react-native-bundle-visualizer 2>/dev/null || echo \"Install react-native-bundle-visualizer for analysis\"\n\n# Find barrel exports\ngrep -r \"export \\* from\\|export {\" --include=\"index.ts\" --include=\"index.tsx\" features/ lib/ | head -10\n\n# Check for heavy imports at module scope\ngrep -r \"^import.*from\" --include=\"*.tsx\" --include=\"*.ts\" features/ app/ | grep -E \"moment|lodash[^/]|aws-sdk[^/]\" | head -5\n\n# Verify Hermes is enabled\ngrep -r \"hermes\" android/gradle.properties ios/Podfile app.json 2>/dev/null | head -5\n\n# Check Metro config for tree shaking\nif [ -f \"metro.config.js\" ]; then cat metro.config.js; fi\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Replace barrel imports with direct file imports, enable Hermes if not already active, remove unused dependencies\n2. **Better**: Implement lazy `require()` for heavy modules used only in specific screens, configure Metro `transformer.minifierConfig` for better dead code elimination\n3. **Complete**: Profile startup with Hermes sampling profiler, implement app startup trace, defer non-critical initialization with `InteractionManager.runAfterInteractions`\n\n**Validation:**\n```bash\n# Measure bundle size\nnpx expo export --dump-sourcemap 2>/dev/null && echo \"Check source map for bundle analysis\"\n```\n\n**Resources:**\n- https://reactnative.dev/docs/performance\n- https://reactnative.dev/docs/hermes\n- https://docs.expo.dev/guides/analyzing-bundles/\n\n### Memory Management\n**Common Issues:**\n- Effects not cleaning up subscriptions or listeners on unmount\n- Large image data held in memory instead of referenced from file system\n- Event listeners accumulating from navigation between screens\n- AbortController not used for fetch cancellation\n\n**Diagnosis:**\n```bash\n# Find effects without cleanup\ngrep -A 8 \"useEffect\\|useFocusEffect\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | grep -B 5 \"useEffect\\|useFocusEffect\" | grep -c \"return \" || echo \"Check for missing cleanup functions\"\n\n# Find addEventListener without removeEventListener\ngrep -r \"addEventListener\\|addListener\\|\\.on(\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | grep -v \"remove\\|cleanup\\|unsubscribe\" | head -10\n\n# Check for base64 image data in state\ngrep -r \"base64\\|data:image\" --include=\"*.tsx\" --include=\"*.ts\" features/ app/ lib/ | head -5\n\n# Find fetch calls without AbortController\ngrep -r \"fetch(\" --include=\"*.tsx\" --include=\"*.ts\" features/ app/ lib/ | grep -v \"AbortController\\|abort\\|signal\" | head -10\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Add cleanup functions returning `removeEventListener`/`unsubscribe` to all effects, use AbortController with fetch\n2. **Better**: Store image URIs (file paths) instead of base64 data in state, implement proper cache eviction for image caches, use `useFocusEffect` for screen-scoped subscriptions\n3. **Complete**: Implement memory monitoring in development, use `expo-file-system` for large data storage, profile with Xcode Instruments (iOS) or Android Studio Profiler\n\n**Validation:**\n- Monitor memory usage in Xcode Instruments or Android Studio Profiler during screen transitions\n- Verify memory returns to baseline after navigating away from screens with heavy content\n\n**Resources:**\n- https://reactnative.dev/docs/performance#ram-bundles-inline-requires\n- https://docs.expo.dev/versions/latest/sdk/filesystem/\n- https://react.dev/learn/synchronizing-with-effects#how-to-handle-the-effect-firing-twice-in-development\n\n### Platform-Specific Issues\n**Common Issues:**\n- Safe area insets not applied correctly (notch/island/navigation bar)\n- Keyboard covering input fields on iOS vs Android different behavior\n- Shadow styles only working on iOS (Android requires `elevation`)\n- StatusBar styling inconsistencies between platforms\n- Platform-specific crashes from unsupported APIs\n\n**Diagnosis:**\n```bash\n# Find platform-specific code\ngrep -r \"Platform\\.OS\\|Platform\\.select\\|\\.ios\\.\\|\\.android\\.\" --include=\"*.tsx\" --include=\"*.tsx\" features/ app/ lib/ | head -10\n\n# Check safe area handling\ngrep -r \"SafeAreaView\\|useSafeAreaInsets\\|SafeAreaProvider\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -5\n\n# Find shadow styles without elevation\ngrep -r \"shadowColor\\|shadowOffset\\|shadowRadius\" --include=\"*.tsx\" --include=\"*.ts\" features/ app/ lib/ | grep -v \"elevation\" | head -5\n\n# Check keyboard handling\ngrep -r \"KeyboardAvoidingView\\|useKeyboard\\|keyboard\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -5\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Wrap root in `SafeAreaProvider`, use `useSafeAreaInsets` for custom layouts, add `elevation` alongside shadow styles for Android\n2. **Better**: Use `KeyboardAvoidingView` with `behavior=\"padding\"` on iOS and `behavior=\"height\"` on Android, handle `StatusBar` per-screen with `expo-status-bar`\n3. **Complete**: Create platform-aware style utilities, implement proper keyboard-aware scroll views, use `Platform.select` for divergent behavior, test on both platforms with various device sizes\n\n**Validation:**\n- Test on both iOS simulator and Android emulator\n- Verify safe area behavior on devices with notch/Dynamic Island and navigation bar\n\n**Resources:**\n- https://reactnative.dev/docs/platform-specific-code\n- https://reactnative.dev/docs/keyboardavoidingview\n- https://docs.expo.dev/versions/latest/sdk/safe-area-context/\n\n### Image Handling\n**Common Issues:**\n- Images loading slowly or flickering on re-render\n- Memory spikes from loading full-resolution images into views\n- Incorrect aspect ratio or cropping behavior\n- Cache not working across app restarts\n\n> For **expo-image** specific configuration (blurhash, contentFit, cachePolicy) and **expo-image-manipulator**, delegate to **expo-expert**.\n\n**Diagnosis:**\n```bash\n# Check image component usage\ngrep -r \"from.*expo-image\\|from.*react-native.*Image\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -10\n\n# Find Image components without proper sizing\ngrep -r \"<Image\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | grep -v \"width\\|height\\|style\" | head -5\n```\n\n**Prioritized Fixes:**\n1. **Minimal**: Set explicit `width`/`height` on all images; avoid loading full-resolution images into thumbnail views\n2. **Better**: Store image URIs (file paths) instead of base64 data in state; use `resizeMode` consistently\n3. **Complete**: Implement progressive image loading; monitor memory usage in image-heavy lists\n\n**Validation:**\n- Verify images load without flicker by navigating between screens\n- Monitor memory usage when displaying image-heavy lists\n\n**Resources:**\n- https://reactnative.dev/docs/image\n- https://docs.expo.dev/versions/latest/sdk/image/\n\n## Runtime Considerations\n- **Hermes Engine**: Default JS engine for React Native. Supports bytecode precompilation for faster startup. Some JS features (e.g., `Proxy` in older versions) may not be available. Always verify engine-specific behavior.\n- **New Architecture (Fabric + TurboModules)**: Enables synchronous native calls via JSI, concurrent rendering support, and codegen for type-safe native interfaces. May require library compatibility verification.\n- **React Compiler**: When enabled, automatically memoizes components and hooks. Reduces need for manual `useMemo`/`useCallback` but requires understanding of what the compiler can and cannot optimize.\n- **Metro Bundler**: Module resolution follows Metro conventions (platform extensions `.ios.tsx`/`.android.tsx`, Haste modules). Tree shaking is limited compared to web bundlers; prefer direct imports over barrel exports.\n- **Platform Threads**: JS thread (business logic), UI/Main thread (native UI updates), and Shadow thread (layout calculation). Animations and gestures should run on UI thread via Reanimated worklets. Long JS thread work blocks interactions.\n\n## Code Review Checklist\n\nWhen reviewing React Native code, focus on these mobile-specific aspects:\n\n### List Performance\n- [ ] Large lists use FlatList or FlashList, not ScrollView\n- [ ] `renderItem` extracted to stable function reference\n- [ ] `keyExtractor` provides unique, stable keys\n- [ ] `getItemLayout` provided for fixed-height items\n- [ ] `removeClippedSubviews` enabled for off-screen optimization\n\n### Animation & Gesture\n- [ ] Animations run on UI thread (Reanimated shared values, not Animated.Value)\n- [ ] Worklet directive present on UI thread callbacks\n- [ ] `runOnJS` used when calling JS functions from worklets\n- [ ] Gestures composed properly (Simultaneous, Exclusive, Race)\n- [ ] Layout animations tested on both platforms\n\n### Navigation\n- [ ] `useFocusEffect` used for screen-scoped side effects\n- [ ] Deep link paths registered and tested\n- [ ] Screen options set correctly (header, gestures, presentation)\n- [ ] Navigation types consistent (native stack for performance)\n- [ ] Tab screens use `unmountOnBlur` when holding heavy state\n\n### Native Integration\n- [ ] Native module errors handled gracefully in JS\n- [ ] Platform-specific code uses `Platform.select` or file extensions\n- [ ] Pod versions locked in Podfile for reproducible builds\n- [ ] TurboModule/Fabric specs match native implementations\n\n### Memory & Resources\n- [ ] Effects include cleanup functions\n- [ ] AbortController used for cancellable fetch requests\n- [ ] Image data stored as file URIs, not base64 in state\n- [ ] Event listeners removed on unmount\n- [ ] Large data processed with streaming or pagination\n\n### Platform Consistency\n- [ ] Safe area insets applied via `useSafeAreaInsets`\n- [ ] Shadows include `elevation` for Android\n- [ ] Keyboard avoidance configured per platform\n- [ ] StatusBar styled per screen\n- [ ] Touch targets meet minimum 44pt size\n\n### Image Optimization\n- [ ] Images sized appropriately (not loading 4K into thumbnails)\n- [ ] Image data stored as file URIs, not base64 in state\n- [ ] Explicit width/height or resizeMode set on all images\n\n### Bundle & Startup\n- [ ] No barrel export re-exports pulling in unused modules\n- [ ] Heavy libraries lazily required where possible\n- [ ] Hermes enabled and bytecode precompiled\n- [ ] Startup initialization deferred for non-critical work\n- [ ] Bundle size monitored and within budget\n\n> For Expo-specific review items (config plugins, EAS, Expo Router, SDK packages, env vars), see **expo-expert** checklist.\n\n## Safety Guidelines\n- Never modify native iOS/Android project files directly when a config plugin or prebuild can handle it; manual edits get overwritten by `expo prebuild`\n- Always test on both platforms after changes to layout, gestures, or native modules\n- Handle native module unavailability gracefully (null checks, try/catch) for Expo Go compatibility\n- Use `InteractionManager.runAfterInteractions` for expensive post-navigation work to avoid janky transitions\n- Never store sensitive data in AsyncStorage without encryption; use `expo-secure-store` for tokens and credentials\n- Pin native dependency versions to avoid breaking changes from auto-resolution during `pod install` or Gradle sync\n\n## Anti-Patterns to Avoid\n1. **ScrollView for Large Lists**: Always use FlatList/FlashList for dynamic data; ScrollView renders all children immediately\n2. **JS Thread Animations**: Never animate with `setState` in `requestAnimationFrame`; use Reanimated shared values on the UI thread\n3. **Inline Styles in Lists**: Creating new style objects per render forces layout recalculation; use `StyleSheet.create` or stable references\n4. **Base64 Images in State**: Holding large base64 strings in component state causes memory pressure; store file URIs and let the image component handle loading\n5. **Manual Native File Edits with Expo**: Editing `ios/` or `android/` directly in managed workflow; use config plugins so changes survive `expo prebuild --clean`\n6. **Ignoring Platform Differences**: Assuming iOS behavior on Android (shadows, keyboard, safe area); always verify with `Platform.OS` checks or platform extensions\n7. **Barrel Export Everything**: Re-exporting entire feature modules via `index.ts` defeats Metro's ability to skip unused code; import directly from source files\n8. **Uncontrolled Navigation State**: Pushing duplicate screens or not resetting stacks causes memory leaks and confusing back behavior\n9. **Synchronous Heavy Computation on JS Thread**: Blocks gestures and animations; offload to `requestIdleCallback`, web workers, or native modules\n10. **Skipping Cleanup in useFocusEffect**: Unlike `useEffect`, `useFocusEffect` fires on every screen focus; missing cleanup causes listener accumulation\n","structuredPatch":[{"oldStart":399,"oldLines":21,"newStart":399,"newLines":19,"lines":[" > For Expo-specific review items (config plugins, EAS, Expo Router, SDK packages, env vars), see **expo-expert** checklist."," "," ## Safety Guidelines","-- Never modify native iOS/Android project files directly when a config plugin or prebuild can handle it; manual edits get overwritten by `expo prebuild`"," - Always test on both platforms after changes to layout, gestures, or native modules","-- Handle native module unavailability gracefully (null checks, try/catch) for Expo Go compatibility","+- Handle native module unavailability gracefully (null checks, try/catch)"," - Use `InteractionManager.runAfterInteractions` for expensive post-navigation work to avoid janky transitions","-- Never store sensitive data in AsyncStorage without encryption; use `expo-secure-store` for tokens and credentials"," - Pin native dependency versions to avoid breaking changes from auto-resolution during `pod install` or Gradle sync","+- Never store sensitive data in AsyncStorage without encryption"," "," ## Anti-Patterns to Avoid"," 1. **ScrollView for Large Lists**: Always use FlatList/FlashList for dynamic data; ScrollView renders all children immediately"," 2. **JS Thread Animations**: Never animate with `setState` in `requestAnimationFrame`; use Reanimated shared values on the UI thread"," 3. **Inline Styles in Lists**: Creating new style objects per render forces layout recalculation; use `StyleSheet.create` or stable references"," 4. **Base64 Images in State**: Holding large base64 strings in component state causes memory pressure; store file URIs and let the image component handle loading","-5. **Manual Native File Edits with Expo**: Editing `ios/` or `android/` directly in managed workflow; use config plugins so changes survive `expo prebuild --clean`","-6. **Ignoring Platform Differences**: Assuming iOS behavior on Android (shadows, keyboard, safe area); always verify with `Platform.OS` checks or platform extensions","-7. **Barrel Export Everything**: Re-exporting entire feature modules via `index.ts` defeats Metro's ability to skip unused code; import directly from source files","-8. **Uncontrolled Navigation State**: Pushing duplicate screens or not resetting stacks causes memory leaks and confusing back behavior","-9. **Synchronous Heavy Computation on JS Thread**: Blocks gestures and animations; offload to `requestIdleCallback`, web workers, or native modules","-10. **Skipping Cleanup in useFocusEffect**: Unlike `useEffect`, `useFocusEffect` fires on every screen focus; missing cleanup causes listener accumulation","+5. **Ignoring Platform Differences**: Assuming iOS behavior on Android (shadows, keyboard, safe area); always verify with `Platform.OS` checks or platform extensions","+6. **Barrel Export Everything**: Re-exporting entire feature modules via `index.ts` defeats Metro's ability to skip unused code; import directly from source files","+7. **Uncontrolled Navigation State**: Pushing duplicate screens or not resetting stacks causes memory leaks and confusing back behavior","+8. **Synchronous Heavy Computation on JS Thread**: Blocks gestures and animations; offload to `requestIdleCallback`, web workers, or native modules","+9. **Skipping Cleanup in useFocusEffect**: Unlike `useEffect`, `useFocusEffect` fires on every screen focus; missing cleanup causes listener accumulation"]}],"userModified":false,"replaceAll":false},"sourceToolAssistantUUID":"4c670a40-1278-49ab-ac2a-31ec844f9e53"}
{"parentUuid":"a5f36d91-3f80-4a9a-b28e-1cab0d7cd171","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","message":{"model":"claude-opus-4-6","id":"msg_013nQjGNKmpAfm8g7ptKSjQg","type":"message","role":"assistant","content":[{"type":"text","text":"Now let me verify both files look correct:"}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":1137,"cache_read_input_tokens":78163,"cache_creation":{"ephemeral_5m_input_tokens":1137,"ephemeral_1h_input_tokens":0},"output_tokens":3,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CYERVQ71g55CvC6cLfEWK","type":"assistant","uuid":"16bb05d1-43ee-4357-ac21-1ce2b8deb0dd","timestamp":"2026-02-17T22:23:06.612Z"}
{"parentUuid":"16bb05d1-43ee-4357-ac21-1ce2b8deb0dd","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","message":{"model":"claude-opus-4-6","id":"msg_013nQjGNKmpAfm8g7ptKSjQg","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01KdMdvdHqdiuReR1fQCbchr","name":"Bash","input":{"command":"wc -l /Users/eryk.napierala/Development/fasola/.claude/agents/expo/expo-expert.md /Users/eryk.napierala/Development/fasola/.claude/agents/react-native/react-native-expert.md","description":"Count lines in both agent files"},"caller":{"type":"direct"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":1137,"cache_read_input_tokens":78163,"cache_creation":{"ephemeral_5m_input_tokens":1137,"ephemeral_1h_input_tokens":0},"output_tokens":3,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CYERVQ71g55CvC6cLfEWK","type":"assistant","uuid":"d57fe31a-ff93-4ee8-bbf8-2d2a14820d94","timestamp":"2026-02-17T22:23:07.630Z"}
{"parentUuid":"d57fe31a-ff93-4ee8-bbf8-2d2a14820d94","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01KdMdvdHqdiuReR1fQCbchr","type":"tool_result","content":"     650 /Users/eryk.napierala/Development/fasola/.claude/agents/expo/expo-expert.md\n     417 /Users/eryk.napierala/Development/fasola/.claude/agents/react-native/react-native-expert.md\n    1067 total","is_error":false}]},"uuid":"0ee3e5e4-cb8c-4fdf-a99c-a1d256f3415a","timestamp":"2026-02-17T22:23:07.820Z","toolUseResult":{"stdout":"     650 /Users/eryk.napierala/Development/fasola/.claude/agents/expo/expo-expert.md\n     417 /Users/eryk.napierala/Development/fasola/.claude/agents/react-native/react-native-expert.md\n    1067 total","stderr":"","interrupted":false,"isImage":false,"noOutputExpected":false},"sourceToolAssistantUUID":"d57fe31a-ff93-4ee8-bbf8-2d2a14820d94"}
{"parentUuid":"0ee3e5e4-cb8c-4fdf-a99c-a1d256f3415a","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","message":{"model":"claude-opus-4-6","id":"msg_019hEckEQtjc6hWVeJLuiU4y","type":"message","role":"assistant","content":[{"type":"text","text":"Let me do a final review of the React Native expert to make sure the delegation references are consistent and there are no orphaned Expo-specific references:"}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":333,"cache_read_input_tokens":79300,"cache_creation":{"ephemeral_5m_input_tokens":333,"ephemeral_1h_input_tokens":0},"output_tokens":1,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CYERVfWxbN3SFPrCSshPk","type":"assistant","uuid":"0517afa2-b0b0-446a-9ae9-05b432cf25ea","timestamp":"2026-02-17T22:23:11.091Z"}
{"parentUuid":"0517afa2-b0b0-446a-9ae9-05b432cf25ea","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","message":{"model":"claude-opus-4-6","id":"msg_019hEckEQtjc6hWVeJLuiU4y","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01J1xALkizmHtCkjwZdnDvxw","name":"Grep","input":{"pattern":"expo|Expo","path":"/Users/eryk.napierala/Development/fasola/.claude/agents/react-native/react-native-expert.md","output_mode":"content"},"caller":{"type":"direct"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":333,"cache_read_input_tokens":79300,"cache_creation":{"ephemeral_5m_input_tokens":333,"ephemeral_1h_input_tokens":0},"output_tokens":1,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CYERVfWxbN3SFPrCSshPk","type":"assistant","uuid":"fd9c3ed9-a88d-4152-9b1b-6bd2679a8062","timestamp":"2026-02-17T22:23:12.037Z"}
{"parentUuid":"fd9c3ed9-a88d-4152-9b1b-6bd2679a8062","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Grep","command":"callback"},"parentToolUseID":"toolu_01J1xALkizmHtCkjwZdnDvxw","toolUseID":"toolu_01J1xALkizmHtCkjwZdnDvxw","timestamp":"2026-02-17T22:23:12.329Z","uuid":"74829357-5dd7-4b27-8f68-d6c12d7ad65c"}
{"parentUuid":"fd9c3ed9-a88d-4152-9b1b-6bd2679a8062","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01J1xALkizmHtCkjwZdnDvxw","type":"tool_result","content":"7:bundle: [react-expert, react-performance-expert, expo-expert]\n19:- **Expo tooling** (CNG/prebuild, config plugins, EAS Build/Update/Submit, Expo Router file-based routing, Expo Modules API, DOM components, `expo-*` SDK packages, environment variables, `eas.json`, `app.json`/`app.config.ts` configuration): Stop and recommend expo-expert\n27:# Detect React Native and Expo versions\n28:npm list react-native expo --depth=0 2>/dev/null || node -e \"const p=require('./package.json'); console.log('react-native:', p.dependencies?.['react-native'] || 'Not found'); console.log('expo:', p.dependencies?.expo || 'Not found')\" 2>/dev/null\n30:# Check Expo SDK version and architecture\n31:if [ -f \"app.json\" ]; then grep -E \"\\\"expo\\\"|\\\"sdkVersion\\\"\" app.json 2>/dev/null; fi\n32:if [ -f \"app.config.ts\" ] || [ -f \"app.config.js\" ]; then echo \"Dynamic Expo config detected\"; fi\n41:npm list expo-router react-navigation @react-navigation/native --depth=0 2>/dev/null | grep -E \"(expo-router|react-navigation)\" || echo \"No navigation library detected\"\n140:> For **Expo Router file-based routing** issues (route resolution, groups, API routes, typed routes), delegate to **expo-expert**.\n168:> For **Expo Modules API**, **config plugins**, and **prebuild** issues, delegate to **expo-expert**.\n192:- Large bundle size from barrel exports pulling in unused code\n202:# Find barrel exports\n203:grep -r \"export \\* from\\|export {\" --include=\"index.ts\" --include=\"index.tsx\" features/ lib/ | head -10\n223:npx expo export --dump-sourcemap 2>/dev/null && echo \"Check source map for bundle analysis\"\n229:- https://docs.expo.dev/guides/analyzing-bundles/\n256:3. **Complete**: Implement memory monitoring in development, use `expo-file-system` for large data storage, profile with Xcode Instruments (iOS) or Android Studio Profiler\n264:- https://docs.expo.dev/versions/latest/sdk/filesystem/\n292:2. **Better**: Use `KeyboardAvoidingView` with `behavior=\"padding\"` on iOS and `behavior=\"height\"` on Android, handle `StatusBar` per-screen with `expo-status-bar`\n302:- https://docs.expo.dev/versions/latest/sdk/safe-area-context/\n311:> For **expo-image** specific configuration (blurhash, contentFit, cachePolicy) and **expo-image-manipulator**, delegate to **expo-expert**.\n316:grep -r \"from.*expo-image\\|from.*react-native.*Image\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -10\n333:- https://docs.expo.dev/versions/latest/sdk/image/\n339:- **Metro Bundler**: Module resolution follows Metro conventions (platform extensions `.ios.tsx`/`.android.tsx`, Haste modules). Tree shaking is limited compared to web bundlers; prefer direct imports over barrel exports.\n393:- [ ] No barrel export re-exports pulling in unused modules\n399:> For Expo-specific review items (config plugins, EAS, Expo Router, SDK packages, env vars), see **expo-expert** checklist.\n414:6. **Barrel Export Everything**: Re-exporting entire feature modules via `index.ts` defeats Metro's ability to skip unused code; import directly from source files"}]},"uuid":"938f8bf8-a87c-4dab-8197-713531a781f1","timestamp":"2026-02-17T22:23:12.328Z","toolUseResult":{"mode":"content","numFiles":0,"filenames":[],"content":"7:bundle: [react-expert, react-performance-expert, expo-expert]\n19:- **Expo tooling** (CNG/prebuild, config plugins, EAS Build/Update/Submit, Expo Router file-based routing, Expo Modules API, DOM components, `expo-*` SDK packages, environment variables, `eas.json`, `app.json`/`app.config.ts` configuration): Stop and recommend expo-expert\n27:# Detect React Native and Expo versions\n28:npm list react-native expo --depth=0 2>/dev/null || node -e \"const p=require('./package.json'); console.log('react-native:', p.dependencies?.['react-native'] || 'Not found'); console.log('expo:', p.dependencies?.expo || 'Not found')\" 2>/dev/null\n30:# Check Expo SDK version and architecture\n31:if [ -f \"app.json\" ]; then grep -E \"\\\"expo\\\"|\\\"sdkVersion\\\"\" app.json 2>/dev/null; fi\n32:if [ -f \"app.config.ts\" ] || [ -f \"app.config.js\" ]; then echo \"Dynamic Expo config detected\"; fi\n41:npm list expo-router react-navigation @react-navigation/native --depth=0 2>/dev/null | grep -E \"(expo-router|react-navigation)\" || echo \"No navigation library detected\"\n140:> For **Expo Router file-based routing** issues (route resolution, groups, API routes, typed routes), delegate to **expo-expert**.\n168:> For **Expo Modules API**, **config plugins**, and **prebuild** issues, delegate to **expo-expert**.\n192:- Large bundle size from barrel exports pulling in unused code\n202:# Find barrel exports\n203:grep -r \"export \\* from\\|export {\" --include=\"index.ts\" --include=\"index.tsx\" features/ lib/ | head -10\n223:npx expo export --dump-sourcemap 2>/dev/null && echo \"Check source map for bundle analysis\"\n229:- https://docs.expo.dev/guides/analyzing-bundles/\n256:3. **Complete**: Implement memory monitoring in development, use `expo-file-system` for large data storage, profile with Xcode Instruments (iOS) or Android Studio Profiler\n264:- https://docs.expo.dev/versions/latest/sdk/filesystem/\n292:2. **Better**: Use `KeyboardAvoidingView` with `behavior=\"padding\"` on iOS and `behavior=\"height\"` on Android, handle `StatusBar` per-screen with `expo-status-bar`\n302:- https://docs.expo.dev/versions/latest/sdk/safe-area-context/\n311:> For **expo-image** specific configuration (blurhash, contentFit, cachePolicy) and **expo-image-manipulator**, delegate to **expo-expert**.\n316:grep -r \"from.*expo-image\\|from.*react-native.*Image\" --include=\"*.tsx\" --include=\"*.jsx\" features/ app/ lib/ | head -10\n333:- https://docs.expo.dev/versions/latest/sdk/image/\n339:- **Metro Bundler**: Module resolution follows Metro conventions (platform extensions `.ios.tsx`/`.android.tsx`, Haste modules). Tree shaking is limited compared to web bundlers; prefer direct imports over barrel exports.\n393:- [ ] No barrel export re-exports pulling in unused modules\n399:> For Expo-specific review items (config plugins, EAS, Expo Router, SDK packages, env vars), see **expo-expert** checklist.\n414:6. **Barrel Export Everything**: Re-exporting entire feature modules via `index.ts` defeats Metro's ability to skip unused code; import directly from source files","numLines":26},"sourceToolAssistantUUID":"fd9c3ed9-a88d-4152-9b1b-6bd2679a8062"}
{"parentUuid":"938f8bf8-a87c-4dab-8197-713531a781f1","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","message":{"model":"claude-opus-4-6","id":"msg_01XKmBqsaBS7FjJ5w2qnAsPN","type":"message","role":"assistant","content":[{"type":"text","text":"The remaining Expo references are appropriate -- they're either delegation notes pointing to the new expo-expert, or incidental references to tools that exist in the RN ecosystem (like `expo-status-bar`, `expo-file-system` as package names in diagnosis commands). This is fine.\n\nDone. Here's what was created and changed:\n\n**Created: `.claude/agents/expo/expo-expert.md`** (650 lines)\n\nCovers 10 problem playbooks:\n1. **CNG & Prebuild** -- native directory generation, `--clean`, plugin debugging\n2. **Config Plugins** -- creation, debugging, mod system, dangerous mods, plugin ordering\n3. **EAS Build** -- profiles, credentials, `eas.json` patterns, resource classes\n4. **EAS Update (OTA)** -- runtime versioning, channels, fingerprint policy, deployment patterns\n5. **Expo Router** -- file-based routing, layouts, groups, dynamic routes, API routes, typed routes\n6. **DOM Components (`use dom`)** -- creation, props, limitations, native actions, performance\n7. **Expo Modules API** -- local modules, Swift/Kotlin definitions, autolinking, events\n8. **Environment Variables & Configuration** -- `EXPO_PUBLIC_*` scoping, secrets, EAS Secrets\n9. **SDK Package Selection** -- recommended packages table (expo-image, expo-video, etc.)\n10. **Multiplatform** -- iOS/Android/web platform divergence, file extensions, web output modes\n11. **Upgrading Expo SDK** -- upgrade workflow, expo-doctor, version fixing\n\nPlus: code review checklist, safety guidelines, 10 anti-patterns, runtime considerations.\n\n**Modified: `.claude/agents/react-native/react-native-expert.md`**\n\n- Added `expo-expert` delegation as first item in Step 0\n- Trimmed Navigation to focus on React Navigation (Expo Router delegated)\n- Trimmed Native Modules to focus on TurboModules/JSI (Expo Modules API delegated)\n- Trimmed Image Handling to focus on RN-level concerns (expo-image specifics delegated)\n- Updated bundle to include `expo-expert`\n- Removed Expo-specific anti-patterns and safety guidelines\n- Added delegation notes in code review checklist"}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1,"cache_creation_input_tokens":1053,"cache_read_input_tokens":79633,"cache_creation":{"ephemeral_5m_input_tokens":1053,"ephemeral_1h_input_tokens":0},"output_tokens":1,"service_tier":"standard","inference_geo":"global"}},"requestId":"req_011CYERVzqK9sn3bFzXP1uo4","type":"assistant","uuid":"79cb8ca5-a6ca-42d6-b417-4b35513106f4","timestamp":"2026-02-17T22:23:27.804Z"}
{"parentUuid":"79cb8ca5-a6ca-42d6-b417-4b35513106f4","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"progress","data":{"type":"hook_progress","hookEvent":"Stop","hookName":"Stop","command":"entire hooks claude-code stop"},"parentToolUseID":"1c248daf-b50a-4624-a0eb-be052aaac216","toolUseID":"1c248daf-b50a-4624-a0eb-be052aaac216","timestamp":"2026-02-17T22:23:27.887Z","uuid":"f05c3190-3784-415b-85a3-2843a8c9b828"}
{"parentUuid":"f05c3190-3784-415b-85a3-2843a8c9b828","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"progress","data":{"type":"hook_progress","hookEvent":"Stop","hookName":"Stop","command":"claudekit-hooks run check-todos"},"parentToolUseID":"1c248daf-b50a-4624-a0eb-be052aaac216","toolUseID":"1c248daf-b50a-4624-a0eb-be052aaac216","timestamp":"2026-02-17T22:23:27.887Z","uuid":"02d4b9db-2b4d-40b0-b841-2e562f351355"}
{"parentUuid":"02d4b9db-2b4d-40b0-b841-2e562f351355","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"progress","data":{"type":"hook_progress","hookEvent":"Stop","hookName":"Stop","command":"claudekit-hooks run create-checkpoint"},"parentToolUseID":"1c248daf-b50a-4624-a0eb-be052aaac216","toolUseID":"1c248daf-b50a-4624-a0eb-be052aaac216","timestamp":"2026-02-17T22:23:27.888Z","uuid":"26422219-a080-4bf2-860f-26729672e535"}
{"parentUuid":"26422219-a080-4bf2-860f-26729672e535","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"progress","data":{"type":"hook_progress","hookEvent":"Stop","hookName":"Stop","command":"claudekit-hooks run lint-project"},"parentToolUseID":"1c248daf-b50a-4624-a0eb-be052aaac216","toolUseID":"1c248daf-b50a-4624-a0eb-be052aaac216","timestamp":"2026-02-17T22:23:27.892Z","uuid":"73c5f58d-829b-449d-9ec8-28a475bbe942"}
{"parentUuid":"73c5f58d-829b-449d-9ec8-28a475bbe942","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"progress","data":{"type":"hook_progress","hookEvent":"Stop","hookName":"Stop","command":"claudekit-hooks run self-review"},"parentToolUseID":"1c248daf-b50a-4624-a0eb-be052aaac216","toolUseID":"1c248daf-b50a-4624-a0eb-be052aaac216","timestamp":"2026-02-17T22:23:27.893Z","uuid":"de9cbe38-9d66-46f3-8605-5e49a7dc860e"}
{"parentUuid":"de9cbe38-9d66-46f3-8605-5e49a7dc860e","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"progress","data":{"type":"hook_progress","hookEvent":"Stop","hookName":"Stop","command":"claudekit-hooks run test-project"},"parentToolUseID":"1c248daf-b50a-4624-a0eb-be052aaac216","toolUseID":"1c248daf-b50a-4624-a0eb-be052aaac216","timestamp":"2026-02-17T22:23:27.893Z","uuid":"189d9acc-defd-4475-a4fe-29f15422ed8e"}
{"parentUuid":"189d9acc-defd-4475-a4fe-29f15422ed8e","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"progress","data":{"type":"hook_progress","hookEvent":"Stop","hookName":"Stop","command":"claudekit-hooks run typecheck-project"},"parentToolUseID":"1c248daf-b50a-4624-a0eb-be052aaac216","toolUseID":"1c248daf-b50a-4624-a0eb-be052aaac216","timestamp":"2026-02-17T22:23:27.893Z","uuid":"7444b367-628a-41c7-8b32-e43f11e66a2a"}
{"parentUuid":"7444b367-628a-41c7-8b32-e43f11e66a2a","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"system","subtype":"stop_hook_summary","hookCount":7,"hookInfos":[{"command":"entire hooks claude-code stop"},{"command":"claudekit-hooks run check-todos"},{"command":"claudekit-hooks run create-checkpoint"},{"command":"claudekit-hooks run lint-project"},{"command":"claudekit-hooks run self-review"},{"command":"claudekit-hooks run test-project"},{"command":"claudekit-hooks run typecheck-project"}],"hookErrors":[],"preventedContinuation":false,"stopReason":"","hasOutput":true,"level":"suggestion","timestamp":"2026-02-17T22:23:34.141Z","uuid":"badfc808-47bf-4b22-b385-913108f684c1","toolUseID":"1c248daf-b50a-4624-a0eb-be052aaac216"}
{"parentUuid":"badfc808-47bf-4b22-b385-913108f684c1","isSidechain":false,"userType":"external","cwd":"/Users/eryk.napierala/Development/fasola","sessionId":"684ffbcb-e955-46b4-82da-ab770d379b6e","version":"2.1.45","gitBranch":"feat/image_zoom","slug":"glistening-singing-dongarra","type":"system","subtype":"turn_duration","durationMs":383925,"timestamp":"2026-02-17T22:23:34.143Z","uuid":"44cbfdb2-09c5-4746-9e9e-c5374c53a786","isMeta":false}
